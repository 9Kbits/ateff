namespace = revivalist

# Maghrebi Exile decides to conquer province
province_event = {
	id = revivalist.1
	desc = EVTDESC_bounce
	picture = GFX_evt_moors
	hide_window = yes
	
	trigger = {
		OR = {
			AND = {
				has_game_rule = {
					name = colonisation_invasions
					value = historical
				}
				year = 2740
				total_years_played = 50
			}
			AND = {
				has_game_rule = {
					name = colonisation_invasions
					value = random
				}
				year = 2650
				total_years_played = 50
			}
		}
		NOT = { 
			has_game_rule = {
				name = colonisation_invasions
				value = off
			}
		}
		NOT = { is_title_active = d_revivalist }
		NOT = { has_global_flag = maghrebi_defeated }
		port = yes
		any_province_holding = { holding_type = castle }
		county = {
			NOT = { de_facto_liege = d_revivalist }
			region = world_south_america_caribbean
		}
	}
	
	mean_time_to_happen = {
		years = 1000
		modifier = {
			factor = 0.75
			has_global_flag = maghrebi_victorious
		}
		modifier = {
			factor = 0.95
			num_of_settlements = 4
		}
		modifier = {
			factor = 0.9
			num_of_settlements = 6
		}
		modifier = {
			factor = 1.1
			NOT = { num_of_settlements = 3 }
		}
	}
	
	option = {
		set_government_type = feudal_government
		holder_scope = {
			activate_title = { title = e_revivalist status = yes }
			create_character = {
				random_traits = no
				dynasty = none
				culture = moroccan
				religion = revivalist
				age = 30
			}
			new_character = {
				add_artifact = ate_firearm
				d_revivalist = {
					grant_title = PREV
				}
				random_list = {
					10 = { add_trait = midas_touched }
					10 = { add_trait = brilliant_strategist }
				}
				random_list = {
					25 = { }
					10 = { add_trait = quick }
					10 = { add_trait = strong }
					5 = { add_trait = genius }
				}
				random_list = {
					20 = { add_trait = duelist }
					15 = { add_trait = gardener }
					10 = { add_trait = strategist }
					5 =  { add_trait = impaler }
				}
				add_trait = ambitious
				add_trait = sayyid2
				random = { chance = 80 add_trait = zealous }
				random = { chance = 80 add_trait = diligent }
				random = { chance = 80 add_trait = patient }
				random = { chance = 50 add_trait = just }
				random = { chance = 50 add_trait = scarred }
				random = { chance = 40 add_trait = cruel }
				random = { chance = 40 add_trait = greedy }
				random = { chance = 40 add_trait = wroth }
				random = { chance = 40 add_trait = proud }
				wealth = 5000
				character_event = { id = salvage.140 } # Give random salvage
				character_event = { id = salvage.140 } # Give random salvage
				set_character_flag = revivalistconqueror
				set_defacto_liege = THIS
				#character_event = { id = misc.3 } # Diversity
				narrative_event = { id = col.11 }
			}
		}
	}
}

# Morrocco declares war
narrative_event = {
	id = revivalist.2
	title = EVTTITLE_revivalist2
	desc = EVTDESC_revivalist2
	major = yes
	is_triggered_only = yes
	hide_new = yes
	
	picture = "GFX_evt_moors"
	border = "GFX_event_narrative_frame_war"

	option = {
		name = EVTOPTA_revivalist2
		trigger = { NOT = { has_landed_title = d_revivalist } }
	}
	
	option = {
		name = EVTOPTB_revivalist2
		trigger = { has_landed_title = d_revivalist }
		create_character = {
			random_traits = yes
			dynasty = none
			religion = revivalist
			culture = moroccan
			female = no
			age = 30
		}
		new_character = {
			add_artifact = ate_firearm
			spawn_unit = {
				province = FROM
				troops =
				{
					camel_cavalry = { 500 500 }
					light_infantry = { 400 400 }
					heavy_infantry = { 750 750 }
					pikemen = { 600 600 }
					archers = { 250 250 }
				}
				attrition = 0.25
			}
			character_event = { id = salvage.140 } # Give random salvage
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
		}
		create_character = {
			random_traits = yes
			dynasty = none
			religion = revivalist
			culture = moroccan
			female = no
			age = 35
		}
		new_character = {
			add_artifact = ate_firearm
			spawn_unit = {
				province = FROM
				troops =
				{
					camel_cavalry = { 500 500 }
					light_infantry = { 400 400 }
					heavy_infantry = { 750 750 }
					pikemen = { 600 600 }
					archers = { 250 250 }
				}
				attrition = 0.25
			}
			character_event = { id = salvage.140 } # Give random salvage
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
		}
		create_character = {
			random_traits = yes
			dynasty = none
			religion = revivalist
			culture = moroccan
			female = no
			age = 39
		}
		new_character = {
			add_artifact = ate_firearm
			spawn_unit = {
				province = FROM
				troops =
				{
					camel_cavalry = { 500 500 }
					light_infantry = { 400 400 }
					heavy_infantry = { 750 750 }
					pikemen = { 600 600 }
					archers = { 250 250 }
				}
				attrition = 0.25
			}
			character_event = { id = salvage.140 } # Give random salvage
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
		}
		# Some extra courtiers
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 16
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 18
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 18
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 20
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 25
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 26
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = no
			age = 28
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = yes
			age = 16
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = yes
			age = 17
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = yes
			age = 18
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = yes
			age = 18
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		create_character = {
			random_traits = yes
			dynasty = random
			religion = revivalist
			culture = moroccan
			female = yes
			age = 20
		}
		new_character = {
			character_event = { id = misc.3 } # Diversity
			character_event = { id = misc.4 } # Physique
			character_event = { id = salvage.140 } # Give random salvage
		}
		
		FROM = { # triggering province
			kingdom = {
				ROOT = {
					war = {
						casus_belli = maghrebjihad
						target = PREVPREV # The top liege of the owner
						thirdparty_title = PREV # The de jure duchy
					}
				}
			}
		}
	}
}

# Maghreb victorious
narrative_event = {
	id = revivalist.3
	title = EVTTITLE_revivalist3
	desc = EVTDESC_revivalist3
	major = yes
	is_triggered_only = yes
	
	picture = "GFX_evt_moors"
	border = "GFX_event_narrative_frame_war"
	
	option = {
		name = EVTOPTA_revivalist3
		trigger = { NOT = { has_landed_title = d_revivalist } }
		set_global_flag = maghreb_victorious
	}
	
	option = {
		name = EVTOPTB_revivalist3
		trigger = { has_landed_title = d_moroccan }
		set_global_flag = maghreb_victorious
		military_techpoints = 2000
		economy_techpoints = 2000
		culture_techpoints = 2000
	}
}

# Maghreb defeated
narrative_event = {
	id = revivalist.4
	title = EVTTITLE_revivalist4
	desc = EVTDESC_revivalist4
	major = yes
	is_triggered_only = yes
	
	picture = "GFX_evt_moors"
	border = "GFX_event_narrative_frame_war"
	
	option = {
		name = EVTOPTA_revivalist4
		set_global_flag = maghrebi_defeated
	}
}
