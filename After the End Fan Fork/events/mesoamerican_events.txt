#1-35	pilgrimage events
#200-	ballgame events

namespace = mesoamerica

character_event = {
	id = mesoamerica.1
	desc = EVTDESC_mayan_pilgrimage_type
	picture = GFX_evt_stone_church
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = { # Minor pilgrimage, religion-agnostic
		name = EVTOPTA_mayan_pilgrimage_type
		piety = 10
		scaled_wealth = -0.1
		character_event = { id = mesoamerica.2 }
	}
	
	option = { # Major pilgrimage
		name = EVTOPTB_mayan_pilgrimage_type
		trigger = { NOT = { trait = pilgrim } }
		piety = 20
		scaled_wealth = -0.2
		hidden_tooltip = {
			if = {
				limit = {
					religion = neomayan
				}
				character_event = { id = mesoamerica.11 }
			}
			if = {
				limit = {
					religion = uahomche
				}
				character_event = { id = mesoamerica.18 }
			}
		}
	}
}

#Minor Pilgrimage Start
character_event = {
	id = mesoamerica.2
	desc = EVTDESC_minor_mayan_pilgrimage_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		character_event = { id = mesoamerica.8 days = 30 } #will always take this amount of time
	}
	
	option = {
		name = EVTOPTA_minor_mayan_pilgrimage_start
		custom_tooltip = { text = TXT_minor_mayan_pilgrimage_start }
		hidden_tooltip = {
			add_trait = travelling
			set_character_flag = mayan_minor_pilgrimage
			
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 15 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 15 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 15 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 15 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 15 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

character_event = {
	id = mesoamerica.3
	desc = EVTDESC_mayan_poor_villagers
	picture = GFX_evt_market
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_mayan_poor_villagers
		wealth = -10
		piety = 5
		custom_tooltip = { text = TXT_EVTOPTA_mayan_poor_villagers }
		hidden_tooltip = {
			if = {
				limit = {
					NOT = { trait = greedy }
					NOT = { trait = charitable }
				}
				add_trait_charitable_effect = yes
			}
			if = {
				limit = {
					trait = greedy
				}
				remove_trait = greedy
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 2
				trait = charitable
			}
		}
	}
	
	option = {
		name = EVTOPTB_mayan_poor_villagers
		piety = -10
		custom_tooltip = { text = TXT_EVTOPTB_mayan_poor_villagers }
		hidden_tooltip = {
			if = {
				limit = {
					trait = charitable
				}
				remove_trait = charitable
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = charitable
			}
			modifier = {
				factor = 2
				trait = greedy
			}
		}
	}
}

character_event = {
	id = mesoamerica.4
	desc = EVTDESC_mayan_ponderings
	picture = GFX_evt_carriage
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_mayan_ponderings
		if = {
			limit = {
				NOR = {
					lifestyle_traits = 1
					has_dlc = "Way of Life"
				}
			}
			random_list = {
				10 = {
					add_trait = scholar
				}
				10 = {
					add_trait = mystic
				}
				10 = {
					add_trait = zealous
				}
				10 = {
					piety = 10
				}
				60 = {}
			}
			break = yes
		}
		if = {
			limit = {
				OR = {
					lifestyle_traits = 1
					has_dlc = "Way of Life"
				}
			}
			random_list = {
				25 = {
					add_trait = zealous
				}
				25 = {
					piety = 10
				}
				50 = {}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				NOT = { learning = 5 }
			}
			modifier = {
				factor = 2
				learning = 10
			}
		}
	}
	option = {
		name = EVTOPTB_mayan_ponderings
		if = {
			limit = {
				NOR = {
					lifestyle_traits = 1
					has_dlc = "Way of Life"
				}
			}
			random_list = {
				10 = {
					add_trait = socializer
				}
				10 = {
					add_trait = poet
				}
				10 = {
					add_trait_gregarious_effect = yes
				}
				10 = {
					prestige = 10
				}
				60 = {}
			}
			break = yes
		}
		if = {
			limit = {
				OR = {
					lifestyle_traits = 1
					has_dlc = "Way of Life"
				}
			}
			random_list = {
				20 = {
					add_trait = poet
				}
				20 = {
					add_trait_gregarious_effect = yes
				}
				20 = {
					prestige = 10
				}
				40 = {
				}
			}
			break = yes
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				NOT = { diplomacy = 5 }
			}
			modifier = {
				factor = 2
				diplomacy = 10
			}
		}
	}
}

character_event = {
	id = mesoamerica.5 
	desc = EVTDESC_mayan_encounter_travelers
	picture = GFX_evt_market
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_mayan_encounter_travelers
		custom_tooltip = { text = TXT_EVTOPTA_mayan_encounter_travelers }
		hidden_tooltip = {
			random_list = {
				10 = {
					change_diplomacy = 1
				}
				10 = {
					change_martial = 1
				}
				10 = {
					change_stewardship = 1
				}
				10 = {
					change_intrigue = 1
				}
				10 = {
					change_learning = 1
				}
				50 = {
				}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = gregarious
			}
			modifier = {
				factor = 2
				trait = shy
			}
		}
	}
	
	option = {
		name = EVTOPTB_mayan_encounter_travelers
		custom_tooltip = { text = TXT_EVTOPTB_mayan_encounter_travelers }
		if = {
			limit = {
				NOT = { trait = gregarious }
			}
			prestige = 10
		}
		if = {
			limit = {
				trait = gregarious
			}
			prestige = 20
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = shy
			}
			modifier = {
				factor = 2
				trait = gregarious
			}
		}
	}
}

character_event = {
	id = mesoamerica.6
	desc = EVTDESC_mayan_illness
	picture = GFX_evt_illness
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_mayan_illness # Persevere and have faith
		random = {
			chance = 50
			if = {
				limit = {
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = ill
			}
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				add_symptom_effect = yes
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 2
				trait = zealous
			}
		}
	}
	
	option = {
		name = EVTOPTB_mayan_illness # Take a break
		piety = -15
		random = {
			chance = 20
			if = {
				limit = {
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = ill
			}
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				add_symptom_effect = yes
			}
		}
		if = {
			limit = {
				trait = zealous
			}
			remove_trait = zealous
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = cynical
			}
		}
	}
}

character_event = {
	id = mesoamerica.7
	desc = EVTDESC_mayan_friend
	picture = GFX_evt_market
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_mayan_friend # friend joins court
		custom_tooltip = { text = TXT_EVTOPTA_mayan_friend }
		random_list = {
				50 = {
					create_character = {
						random_traits = no
						dynasty = NONE
						religion = ROOT
						culture = ROOT
						female = no
						age = 20
						random_traits = yes
					}
				}
				50 = {
					create_character = {
						random_traits = no
						dynasty = NONE
						religion = ROOT
						culture = ROOT
						female = yes
						age = 20
						random_traits = yes
					}
				}
			}
			new_character = {
				character_event = { id = misc.3 } # Diversity
				character_event = { id = misc.4 } # Physique
				add_friend = ROOT
				remove_trait = genius
				remove_trait = imbecile
				remove_trait = ugly
				remove_trait = slow
				remove_trait = shy
				add_trait = gregarious
			}
	}
	
	option = {
		name = EVTOPTB_mayan_friend # get gregarious or prestige
		custom_tooltip = { text = TXT_EVTOPTB_mayan_friend }
		hidden_tooltip = {
			if = {
				limit = {
					trait = shy
				}
				remove_trait = shy
				add_trait_gregarious_effect = yes
			}
			if = {
				limit = {
					NOT = { trait = shy }
				}
				add_trait_gregarious_effect = yes
			}
			if = {
				limit = {
					trait = gregarious
				}
				prestige = 25
			}
		}
	}
}

character_event = {
	id = mesoamerica.8
	desc = EVTDESC_mayan_minor_pilgrimage_arrival
	picture = GFX_evt_market_byzantine
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = mayan_minor_pilgrimage
	}
	
	option = {
		name = EVTOPTA_mayan_minor_pilgrimage_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.10 days = 15 } } # end of pilgrimage. minor pilgrimages always go well
	}
}

character_event = {
	id = mesoamerica.10
	desc = EVTDESC_mayan_minor_pilgrimage_end
	picture = GFX_evt_stone_church
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = on_pilgrimage
		clr_character_flag = do_not_disturb
	}
	
	option = {
		name = EVTOPTA_mayan_minor_pilgrimage_end
		piety = 20
		add_character_modifier = {
			name = recent_mayan_pilgrimage
			duration = 1825
		}
		remove_trait = travelling
	}
}

character_event = {
	id = mesoamerica.11
	desc = EVTDESC_mayan_pilgrimage_destination_neomayan
	picture = GFX_evt_kukulkan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_olmeca
		trigger = {
			NOT = { capital_scope = { province_id = 1782 } } # Olmeca
		}
		set_character_flag = pilgrimage_to_olmeca
		hidden_tooltip = {
			character_event = { id = mesoamerica.12 days = 2 } # Set out for the destination
		}
	}

	option = {
		name = EVTOPTB_chichen_itza
		trigger = {
			NOT = { capital_scope = { province_id = 1813 } } # Chichen Itza
		}
		set_character_flag = pilgrimage_to_chichen_itza
		hidden_tooltip = {
			character_event = { id = mesoamerica.13 days = 2 }
		}
	}
	option = {
		name = EVTOPTC_san_salvador
		trigger = {
			NOT = { capital_scope = { province_id = 1848 } } # San Salvador
		}
		set_character_flag = pilgrimage_to_san_salvador
		hidden_tooltip = {
			character_event = { id = mesoamerica.13 days = 2 }
		}
	}
}

# Setting out for Olmeca
character_event = {
	id = mesoamerica.12
	desc = EVTDESC_olmeca_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_olmeca_start
		hidden_tooltip = {
			add_trait = on_pilgrimage
			set_character_flag = good_pilgrimage
			narrative_event = { id = mesoamerica.15 days = 45 } #Arrival in Olmeca
		}
		hidden_tooltip = {
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 30 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 30 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 30 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 30 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 30 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

# Setting out for Chichen Itza
character_event = {
	id = mesoamerica.13
	desc = EVTDESC_chichen_itza_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_chichen_itza_start
		hidden_tooltip = {
			add_trait = on_pilgrimage
			set_character_flag = good_pilgrimage
			narrative_event = { id = mesoamerica.16 days = 45 } #Arrival in Chichen Itza
		}
		hidden_tooltip = {
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 30 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 30 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 30 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 30 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 30 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

# Setting out for San Salvador
character_event = {
	id = mesoamerica.14
	desc = EVTDESC_san_salvador_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_san_salvador_start
		hidden_tooltip = {
			add_trait = on_pilgrimage
			set_character_flag = good_pilgrimage
			narrative_event = { id = mesoamerica.17 days = 45 } #Arrival in Chichen Itza
		}
		hidden_tooltip = {
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 30 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 30 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 30 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 30 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 30 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

# Arrived at Olmeca
narrative_event = {
	id = mesoamerica.15
	title = EVTNAME_olmeca_arrival
	desc = EVTDESC_olmeca_arrival
	picture = GFX_evt_olmec_head
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = pilgrimage_to_olmeca
	}

	option = {
		name = EVTOPTA_olmeca_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.23 days = 5 } }
	}
}

# Arrived at Chichen Itza
narrative_event = {
	id = mesoamerica.16
	title = EVTNAME_chichen_itza_arrival
	desc = EVTDESC_chichen_itza_arrival
	picture = GFX_evt_el_castillo
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = pilgrimage_to_chichen_itza
	}

	option = {
		name = EVTOPTA_chichen_itza_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.23 days = 5 } }
	}
}

# Arrived at San Salvador
narrative_event = {
	id = mesoamerica.17
	title = EVTNAME_san_salvador_arrival
	desc = EVTDESC_san_salvador_arrival
	picture = GFX_evt_market_byzantine
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = pilgrimage_to_san_salvador
	}

	option = {
		name = EVTOPTA_san_salvador_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.23 days = 5 } }
	}
}

character_event = {
	id = mesoamerica.18
	desc = EVTDESC_mayan_pilgrimage_destination_uahomche
	picture = GFX_evt_kukulkan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_sian_kaan
		trigger = {
			NOT = { capital_scope = { province_id = 1810 } } # Sian-Ka'an
		}
		set_character_flag = pilgrimage_to_sian_kaan
		hidden_tooltip = {
			character_event = { id = mesoamerica.19 days = 2 } # Set out for the destination
		}
	}

	option = {
		name = EVTOPTB_nojpeten
		trigger = {
			NOT = { capital_scope = { province_id = 1825 } } # Nojpeten
		}
		set_character_flag = pilgrimage_to_chichen_itza
		hidden_tooltip = {
			character_event = { id = mesoamerica.20 days = 2 }
		}
	}
	option = {
		name = EVTOPTC_esquipulas
		trigger = {
			NOT = { capital_scope = { province_id = 1845 } } # Chiquimula
		}
		set_character_flag = pilgrimage_to_esquipulas
		hidden_tooltip = {
			character_event = { id = mesoamerica.36 days = 2 }
		}
	}
}

# Setting out for Sian-Ka'an
character_event = {
	id = mesoamerica.19
	desc = EVTDESC_sian_kaan_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_sian_kaan_start
		hidden_tooltip = {
			add_trait = on_pilgrimage
			set_character_flag = good_pilgrimage
			narrative_event = { id = mesoamerica.21 days = 45 } #Arrival in Sian Kaan
		}
		hidden_tooltip = {
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 30 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 30 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 30 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 30 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 30 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

# Setting out for Nojpeten
character_event = {
	id = mesoamerica.20
	desc = EVTDESC_nojpeten_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_nojpeten_start
		hidden_tooltip = {
			add_trait = on_pilgrimage
			set_character_flag = good_pilgrimage
			narrative_event = { id = mesoamerica.22 days = 45 } #Arrival in Nojpeten
		}
		hidden_tooltip = {
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 30 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 30 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 30 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 30 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 30 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

# Arrived at Sian-Ka'an
narrative_event = {
	id = mesoamerica.21
	title = EVTNAME_sian_kaan_arrival
	desc = EVTDESC_sian_kaan_arrival
	picture = GFX_evt_market_byzantine
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = pilgrimage_to_sian_kaan
	}

	option = {
		name = EVTOPTA_sian_kaan_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.23 days = 5 } }
	}
}

# Arrived at Nojpeten
narrative_event = {
	id = mesoamerica.22
	title = EVTNAME_nojpeten_arrival
	desc = EVTDESC_nojpeten_arrival
	picture = GFX_evt_nojpeten
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = pilgrimage_to_nojpeten
	}

	option = {
		name = EVTOPTA_nojpeten_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.23 days = 5 } }
	}
}

character_event = {
	id = mesoamerica.23
	
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			10 = {
				if = {
					limit = { NOT = { trait = cynical } }
					character_event = { id = mesoamerica.28 }   # Religious ecstasy
				}
				if = {
					limit = { trait = cynical }
					random_list = {
						20 = { character_event = { id = mesoamerica.24 } }  # Strong religious experience
						10 = { character_event = { id = mesoamerica.25 } }  # Disappointed in the place
						20 = { character_event = { id = mesoamerica.26 } }  # Learns things of the world - cosmopolitan
						20 = { character_event = { id = mesoamerica.27 } }  # Generally impressed
					}
				}
			}
			10 = {
				if = {
					limit = { trait = lustful }
					character_event = { id = mesoamerica.29 }	# Lustful
				}
				if = {
					limit = { NOT = { trait = lustful }	}
					random_list = {
						20 = { character_event = { id = mesoamerica.24 } }  # Strong religious experience
						10 = { character_event = { id = mesoamerica.25 } }  # Disappointed in the place
						20 = { character_event = { id = mesoamerica.26 } }  # Learns things of the world - cosmopolitan
						20 = { character_event = { id = mesoamerica.27 } }  # Generally impressed
					}
				}
			}
			5 = { # Cured of Disease
				if = {
					limit = {
						OR = {
							is_ill = yes
							trait = pneumonic
							trait = syphilitic
							has_disease_trigger = yes
							AND = {
								has_symptom_trigger = yes
								has_character_flag = developing_illness
							}
						}
					}
					narrative_event = { id = mesoamerica.30 }
				}
				if = {
					limit = {
						NOT = {
							OR = {
								is_ill = yes
								trait = pneumonic
								trait = syphilitic
							}
						}
					}
					random_list = {
						20 = { character_event = { id = mesoamerica.24 } }  # Strong religious experience
						10 = { character_event = { id = mesoamerica.25 } }  # Disappointed in the place
						20 = { character_event = { id = mesoamerica.26 } }  # Learns things of the world - cosmopolitan
						20 = { character_event = { id = mesoamerica.27 } }  # Generally impressed
					}
				}
			}
			10 = {
				if = {
					limit = {
						OR = {
							trait = drunkard
							trait = hedonist
						}
					}
					character_event = { id = mesoamerica.31 }  # Drunkard/hedonist event
				}
				if = {
					limit = {
						NOT = {
							OR = {
								trait = drunkard
								trait = hedonist
							}
						}
					}
					random_list = {
						20 = { character_event = { id = mesoamerica.24 } }  # Strong religious experience
						10 = { character_event = { id = mesoamerica.25 } }  # Disappointed in the place
						20 = { character_event = { id = mesoamerica.26 } }  # Learns things of the world - cosmopolitan
						20 = { character_event = { id = mesoamerica.27 } }  # Generally impressed
					}
				}
			}
			10 = {
				if = {
					limit = {
						has_character_flag = pilgrimage_to_san_salvador
					}
					character_event = { id = mesoamerica.32 }  # Develop sympathy for other faiths
				}
				if = {
					limit = {
						NOT = {
							has_character_flag = pilgrimage_to_san_salvador
						}
					}
					random_list = {
						20 = { character_event = { id = mesoamerica.24 } }  # Strong religious experience
						10 = { character_event = { id = mesoamerica.25 } }  # Disappointed in the place
						20 = { character_event = { id = mesoamerica.26 } }  # Learns things of the world - cosmopolitan
						20 = { character_event = { id = mesoamerica.27 } }  # Generally impressed
					}
				}
			}
		}
	}
}

# Become Zealous
character_event = {
	id = mesoamerica.24
	desc = EVTDESC_mayan_become_zealous
	picture = GFX_evt_maya_codex
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_become_zealous
		if = {
			limit = { NOT = { trait = zealous } }
			add_trait = zealous
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
}

# Disappointed in the place
character_event = {
	id = mesoamerica.25
	desc = EVTDESC_mayan_disappointement
	picture = GFX_evt_bad_news
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_disappointement
		if = {
			limit = { NOT = { trait = cynical } }
			add_trait = cynical
		}
		clr_character_flag = good_pilgrimage
		set_character_flag = bad_pilgrimage
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
		}
}

# Makes friends
character_event = {
	id = mesoamerica.26
	desc = EVTDESC_mayan_learn_from_pilgrims
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_learn_from_pilgrims
		random_list = {
			30 = { change_learning = 1 }
			70 = {}
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } }
	}
	option = {
		name = EVTOPTB_mayan_learn_from_pilgrims
		if = {
			limit = { NOT = { trait = gregarious } }
			random = {
				chance = 50
				add_trait_gregarious_effect = yes
			}
		}
		if = {
			limit = { trait = gregarious }
			random = {
				chance = 20
				change_diplomacy = 1
			}
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } }
	}
}

# Generally impressed
character_event = {
	id = mesoamerica.27
	desc = EVTDESC_mayan_impressed
	picture = GFX_evt_market_byzantine
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_impressed
		piety = 20
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
}

# Stimulated to religious ecstasy
character_event = {
	id = mesoamerica.28
	desc = EVTDESC_mayan_ecstasy
	picture = GFX_evt_maya_codex
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_ecstasy
		if = {
			limit = { NOT = { lifestyle_traits = 1 } }
			add_trait = mystic
		}
		if = {
			limit = { NOT = { trait = zealous } }
			random = {
				chance = 20
				add_trait_zealous_effect = yes
			}
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
	option = {
		name = EVTOPTB_mayan_ecstasy
		piety = 30
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
}


# Lustful character enjoys freedom far from home
character_event = {
	id = mesoamerica.29
	desc = EVTDESC_mayan_lust
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_lust
		if = {
			limit = {
				is_female = yes
				NOT = { trait = homosexual }
			}
			random = {
				chance = 50
				custom_tooltip = {
					text = becomes_pregnant_no_father
					hidden_tooltip = { impregnate = 0 }
				}
				clr_character_flag = good_pilgrimage
				set_character_flag = bad_pilgrimage
			}
		}
		if = {
			limit = { NOT = { trait = syphilitic } }
			random = {
				chance = 5
				add_trait = syphilitic
				clr_character_flag = good_pilgrimage
				set_character_flag = bad_pilgrimage
			}
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
	option = {
		name = EVTOPTB_mayan_lust  # Control yourself
		piety = 10
		if = {
			limit = { NOT = { trait = chaste } }
			random = {
				chance = 40
				add_trait_chaste_effect = yes
			}
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
}

# Curing pilgrim of disease - pilgrim attributes it to divine influence
character_event = {
	id = mesoamerica.30
	desc = EVTDESC_mayan_cured_illness
	picture = GFX_evt_illness
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_cured_illness
		ai_chance = {
			factor = 70
		}
		if = {
			limit = { has_disease_trigger = no }
			set_character_flag = pilgrim_blessing
			add_character_modifier = {
				name = blessing_of_health
				duration = -1
			}
		}
		if = {
			limit = { trait = wounded }
			remove_trait = wounded
			add_scarred_tiered_effect = yes
		}
		if = {
			limit = { has_disease_trigger = yes }
			remove_disease_trait_effect = yes
		}
		if = {
			limit = { NOT = { trait = zealous } }
			add_trait = zealous
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
	option = {
		name = EVTOPTB_mayan_cured_illness
		ai_chance = {
			factor = 20
		}
		if = {
			limit = { has_disease_trigger = no }
			set_character_flag = pilgrim_blessing
			add_character_modifier = {
				name = blessing_of_health
				duration = -1
			}
		}
		if = {
			limit = { trait = wounded }
			remove_trait = wounded
			add_scarred_tiered_effect = yes
		}
		if = {
			limit = { has_disease_trigger = yes }
			remove_disease_trait_effect = yes
		}
		if = {
			limit = { NOT = { trait = cynical } }
			add_trait = cynical
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
	option = {
		name = EVTOPTC_mayan_cured_illness
		trigger = {
			NOT = { lifestyle_traits = 1 }
			NOT = { has_dlc = "Way of Life" }
		}
		ai_chance = {
			factor = 10
		}
		if = {
			limit = { has_disease_trigger = no }
			set_character_flag = pilgrim_blessing
			add_character_modifier = {
				name = blessing_of_health
				duration = -1
			}
		}
		if = {
			limit = { trait = wounded }
			remove_trait = wounded
			add_scarred_tiered_effect = yes
		}
		if = {
			limit = { has_disease_trigger = yes }
			remove_disease_trait_effect = yes
		}
		add_trait = mystic
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
}

# Drunkard/hedonist
character_event = {
	id = mesoamerica.31
	desc = EVTDESC_mayan_drunkard
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_drunkard
		ai_chance = {
			factor = 80
		}
		if = {
			limit = {
				NOT = { lifestyle_traits = 1 }
				NOT = { has_dlc = "Way of Life" }
			}
			random = {
				chance = 30
				add_trait = hedonist
			}
		}
		if = {
			limit = { NOT = { trait = drunkard } }
			random = {
				chance = 30
				add_trait = drunkard
				hidden_tooltip = {
					character_event = {
						id = 38286 #Notify Drunkard
					}
				}
			}
		}
		add_character_modifier = {
			name = good_times
			days = 730
		}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
	option = {
		name = EVTOPTB_mayan_drunkard
		ai_chance = {
			factor = 20
		}
		piety = 10
			if = {
				limit = { NOT = { trait = stressed } }
				random = {
					chance = 30
					add_trait = stressed
					hidden_tooltip = {
						character_event = {
							id = 38282 #Notify Stressed
						}
					}
				}
			}
			if = {
				limit = { trait = drunkard }
				random = {
					chance = 20
					remove_trait = drunkard
				}
			}
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 20 } } # Stay a little longer then go home
	}
}

# Impressed by CoS/Christian (San Salvador only)
character_event = {
	id = mesoamerica.32
	desc = EVTDESC_mayan_sympathy
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_sympathy
		trigger = { NOT = { trait = sympathy_christendom } }
		if = {
			limit = { trait = zealous }
			remove_trait = zealous
		}
		add_trait = sympathy_christendom
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 10 } } # Stay a little longer then go home
	}
	option = {
		name = EVTOPTB_mayan_sympathy
		trigger = { NOT = { trait = sympathy_cult_of_saints } }
		if = {
			limit = { trait = zealous }
			remove_trait = zealous
		}
		add_trait = sympathy_cult_of_saints
		hidden_tooltip = { character_event = { id = mesoamerica.33 days = 10 } } # Stay a little longer then go home
	}
}


#Homecoming
character_event = {
	id = mesoamerica.33

	hide_window = yes
	
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { has_character_flag = good_pilgrimage }
			character_event = { id = mesoamerica.34 }
		}
		if = {
			limit = { has_character_flag = bad_pilgrimage }
			character_event = { id = mesoamerica.35 }
		}
		
		
	}
}

# Good pilgrimage
character_event = {
	id = mesoamerica.34
	desc = EVTDESC_mayan_good_pilgrimage
	picture = GFX_evt_stone_church
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_mayan_good_pilgrimage
		clr_character_flag = pilgrimage_to_chichen_itza
		clr_character_flag = pilgrimage_to_nojpeten
		clr_character_flag = pilgrimage_to_olmeca
		clr_character_flag = pilgrimage_to_san_salvador
		clr_character_flag = pilgrimage_to_sian_kaan
		clr_character_flag = pilgrimage_to_esquipulas
		clr_character_flag = good_pilgrimage
		clr_character_flag = do_not_disturb
		add_trait = pilgrim
		add_character_modifier = {
			name = recent_mayan_pilgrimage
			duration = 1825
		}
		hidden_tooltip = { remove_trait = on_pilgrimage }
		piety = 30
	}
}

# Disappointing pilgrimage
character_event = {
	id = mesoamerica.35
	desc = EVTDESC_mayan_bad_pilgrimage
	picture = GFX_evt_stone_church
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_mayan_bad_pilgrimage
		clr_character_flag = pilgrimage_to_chichen_itza
		clr_character_flag = pilgrimage_to_nojpeten
		clr_character_flag = pilgrimage_to_olmeca
		clr_character_flag = pilgrimage_to_san_salvador
		clr_character_flag = pilgrimage_to_sian_kaan
		clr_character_flag = pilgrimage_to_esquipulas
		clr_character_flag = bad_pilgrimage
		clr_character_flag = do_not_disturb
		add_trait = pilgrim
		add_character_modifier = {
			name = recent_mayan_pilgrimage
			duration = 1825
		}
		hidden_tooltip = { remove_trait = on_pilgrimage }
		piety = -10
		if = {
			limit = { NOT = { trait = cynical } }
			random = {
				chance = 20
				add_trait = cynical
				hidden_tooltip = {
					character_event = {
						id = 38258 #Notify Cynical
					}
				}
			}
		}
	}
}

# Setting out for Esquipulas
character_event = {
	id = mesoamerica.36
	desc = EVTDESC_esquipulas_start
	picture = GFX_evt_pilgrims_epic_journey_jungle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_esquipulas_start
		hidden_tooltip = {
			add_trait = on_pilgrimage
			set_character_flag = good_pilgrimage
			narrative_event = { id = mesoamerica.37 days = 45 } #Arrival in Esquipulas
		}
		hidden_tooltip = {
			random_list = {
				20 = {  character_event = { id = mesoamerica.3 days = 30 random = 7 } } #Help poor villagers
				20 = {  character_event = { id = mesoamerica.4 days = 30 random = 7 } } #Reflect on journey
				20 = {  character_event = { id = mesoamerica.5 days = 30 random = 7 } } #Encounter other pilgrims
				20 = {  character_event = { id = mesoamerica.6 days = 30 random = 7 } } #Sickness
				20 = {  character_event = { id = mesoamerica.7 days = 30 random = 7 } } #Make friends with one fellow pilgrim
			}
		}
	}
}

# Arrived at Esquipulas
narrative_event = {
	id = mesoamerica.37
	title = EVTNAME_esquipulas_arrival
	desc = EVTDESC_esquipulas_arrival
	picture = GFX_evt_market_byzantine
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = pilgrimage_to_esquipulas
	}

	option = {
		name = EVTOPTA_esquipulas_arrival
		hidden_tooltip = { character_event = { id = mesoamerica.23 days = 5 } }
	}
}



##Ballgame Events##

character_event = {
	id = mesoamerica.200
	desc = EVTDESC_ulama_game_start
	picture = GFX_evt_ulama
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = ulama_in_progress
	}
	
	option = {
		name = EVTOPTA_ulama_game_start # watch from the stands, cheer on selected team
		prestige = 25
		custom_tooltip = { text = TXT_EVTOPTA_ulama_game_start }
		hidden_tooltip = {
			random_list = {
				50 = {
					character_event = { id = mesoamerica.201 days = 1 } # your team wins! hooray!
				}
				50 = {
					character_event = { id = mesoamerica.202 days = 1 } # your team loses. whoops.
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ulama_game_start # join the game. you better win...
		prestige = 50
		trigger = { # have to be in good physical condition
			character_disease_trigger = no
			has_symptom_trigger = no
			NOT = {	trait = infirm }
			NOT = {	trait = blinded }
			NOT = {	trait = mangled }
			NOT = {	trait = maimed }
			NOT = {	trait = one_handed }
			NOT = {	trait = one_legged }
			NOT = {	trait = severely_injured }
			NOT = { age = 40 }
		}
		custom_tooltip = { text = TXT_EVTOPTB_ulama_game_start }
		hidden_tooltip = {
			random_list = {
				50 = { # you win
					modifier = { # more likely if you're physically strong
						factor = 1.5
						OR = {
							trait = strong
							trait = robust
							trait = sturdy
							trait = giant
						}
					}
					modifier = { # far more likely if you play smart
						factor = 2
						OR = {
							trait = shrewd
							trait = quick
							trait = genius
							trait = gamer
							trait = strategist
						}
					}
					modifier = { # less likely if you're physically weak or disabled
						factor = 0.75
						OR = {
							trait = weak
							trait = feeble
							trait = hunchback
							trait = dwarf
							trait = clubfooted
							trait = inbred
						}
					}
					modifier = { # far more likely if you can't play smart
						factor = 0.5
						OR = {
							trait = dull
							trait = slow
							trait = imbecile
						}
					}	
					character_event = { id = mesoamerica.103 days = 1 }
				}
				50 = { # you lose
					modifier = { # more likely if you're physically weak or disabled
						factor = 1.5
						OR = {
							trait = weak
							trait = feeble
							trait = hunchback
							trait = dwarf
							trait = clubfooted
							trait = inbred
						}
					}
					modifier = { # way more likely if you can't play smart
						factor = 2
						OR = {
							trait = dull
							trait = slow
							trait = imbecile
						}
					}	
					modifier = { # less likely if you're physically strong
						factor = 0.75
						OR = {
							trait = strong
							trait = robust
							trait = sturdy
							trait = giant
						}
					}
					modifier = { # far less likely if you play smart
						factor = 0.5
						OR = {
							trait = shrewd
							trait = quick
							trait = genius
							trait = gamer
							trait = strategist
						}
					}
					character_event = { id = mesoamerica.204 days = 1 }
				}
			}
		}
	}
}

character_event = {
	id = mesoamerica.201
	desc = EVTDESC_ulama_game_win
	picture = GFX_evt_ulama
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = ulama_in_progress
	}
	
	immediate = {
		set_character_flag = ulama_winning_team
	}
	
	option = {
		name = EVTOPTA_ulama_game_win
		prestige = 50
		if = {
			limit = {
				NOT = { religion = neomayan }
			}
			character_event = { id = mesoamerica.205 days = 1 } # other captain executed
		}
		if = {
			limit = {
				religion = neomayan
			}
			character_event = { id = mesoamerica.206 days = 1 } # end of game
		}
	}
}

character_event = {
	id = mesoamerica.202
	desc = EVTDESC_ulama_game_lose
	picture = GFX_evt_bad_news
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = ulama_in_progress
	}
	
	immediate = {
		set_character_flag = ulama_losing_team
	}
	
	option = {
		name = EVTOPTA_ulama_game_lose
		prestige = -50
		if = {
			limit = {
				NOT = { religion = neomayan }
			}
			character_event = { id = mesoamerica.205 days = 1 } # your captain executed
		}
		if = {
			limit = {
				religion = neomayan
			}
			character_event = { id = mesoamerica.206 days = 1 } # end of game
		}
	}
}

character_event = {
	id = mesoamerica.203
	desc = EVTDESC_ulama_game_personal_win
	picture = GFX_evt_ulama
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = ulama_in_progress
	}
	
	immediate = {
		set_character_flag = ulama_winning_team
	}
	
	option = {
		name = EVTOPTA_ulama_game_personal_win
		prestige = 250
		if = {
			limit = {
				NOT = { religion = neomayan }
			}
			character_event = { id = mesoamerica.205 days = 1 } # other captain executed
		}
		if = {
			limit = {
				religion = neomayan
			}
			character_event = { id = mesoamerica.206 days = 1 } # end of game
		}
	}
}

character_event = {
	id = mesoamerica.204
	desc = EVTDESC_ulama_game_personal_lose
	picture = GFX_evt_bad_news
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = ulama_in_progress
	}
	
	immediate = {
		set_character_flag = ulama_losing_team
	}
	
	option = {
		name = EVTOPTA_ulama_game_personal_lose
		prestige = -250
		add_trait = wounded
		if = {
			limit = {
				NOT = { religion = neomayan }
			}
			character_event = { id = mesoamerica.205 days = 1 } # other captain executed
		}
		if = {
			limit = {
				religion = neomayan
			}
			character_event = { id = mesoamerica.206 days = 1 } # end of game
		}
	}
}

character_event = { # Execution of losing team's captain. Neomayans excluded.
	id = mesoamerica.205
	desc = {
		trigger = { has_character_flag = ulama_winning_team }
		text = EVTDESCA_ulama_captain_sacrifice
	}
	desc = {
		trigger = { has_character_flag = ulama_losing_team }
		text = EVTDESCB_ulama_captain_sacrifice
	}
	picture = GFX_evt_mictlantec_sacrifice
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = ulama_in_progress
	}
	
	option = {
		name = EVTOPTA_ulama_game_captain_sacrifice
		trigger = {
			has_character_flag = ulama_winning_team
		}
		piety = 100
		character_event = { id = mesoamerica.206 days = 1 } # end of game
	}
	
	option = {
		name = EVTOPTB_ulama_game_captain_sacrifice
		trigger = {
			has_character_flag = ulama_losing_team
		}
		piety = 50
		character_event = { id = mesoamerica.206 days = 1 } # end of game
	}
}

character_event = {
	id = mesoamerica.206
	desc = EVTDESC_ulama_game_conclusion
	picture = GFX_evt_ulama
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = ulama_in_progress
	}
	
	immediate = {
		clr_character_flag = do_not_disturb
		clr_character_flag = ulama_in_progress
		clr_character_flag = ulama_winning_team
		clr_character_flag = ulama_losing_team
	}
	
	option = {
		name = EVTOPTA_ulama_game_conclusion
		if = {
			limit = {
				religion = neomayan
			}
			piety = 100
		}
		add_character_modifier = {
			name = recent_ritual_ballgame
			duration = 1825
		}
	}
}