namespace = halloween

#Happy Halloween!

#Outfit Selection
character_event = {
	id = halloween.1
	desc = EVTDESC_halloween_1
	picture = GFX_evt_market_hf
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_1
		custom_tooltip = { text = TXT_lazy_costume }
		hidden_tooltip = {
			set_character_flag = lazy_costume
		}
		ai_chance = {
			factor = 25
		}
	}
	
	option = {
		name = EVTOPTB_halloween_1
		custom_tooltip = { text = TXT_decent_costume }
		wealth = -5
		hidden_tooltip = {
			set_character_flag = decent_costume
		}
		ai_chance = {
			factor = 50
			modifier = {
				NOT = { wealth = 15 }
				factor = 0
			}
		}
	}
	
	option = {
		name = EVTOPTC_halloween_1
		trigger = {
			OR = {
				religion = occultist
				religion = occultist_reformed
			}
		}
		custom_tooltip = { text = TXT_amazing_costume }
		wealth = -15
		hidden_tooltip = {
			set_character_flag = amazing_costume
		}
		ai_chance = {
			factor = 50
			modifier = {
				NOT = { wealth = 45 }
				factor = 0
			}
		}
	}
	
	option = {
		name = EVTOPTD_halloween_1
		trigger = {
			OR = {
				religion = celtic_pagan
				religion = celtic_pagan_reformed
			}
		}
		custom_tooltip = { text = TXT_amazing_costume }
		wealth = -15
		hidden_tooltip = {
			set_character_flag = amazing_costume
		}
		ai_chance = {
			factor = 50
			modifier = {
				NOT = { wealth = 45 }
				factor = 0
			}
		}
	}
	
	option = {
		name = EVTOPTE_halloween_1
		trigger = {
			OR = {
				religion = thelemic
				religion = thelemic_reformed
			}
		}
		custom_tooltip = { text = TXT_amazing_costume }
		wealth = -15
		hidden_tooltip = {
			set_character_flag = amazing_costume
		}
		ai_chance = {
			factor = 50
			modifier = {
				NOT = { wealth = 45 }
				factor = 0
			}
		}
	}
	
	option = {
		name = EVTOPTF_halloween_1
		trigger = {
			religion = gaian
		}
		custom_tooltip = { text = TXT_amazing_costume }
		wealth = -15
		hidden_tooltip = {
			set_character_flag = amazing_costume
		}
		ai_chance = {
			factor = 50
			modifier = {
				NOT = { wealth = 45 }
				factor = 0
			}
		}
	}
	
	after = {
		character_event = { id = halloween.2 }
	}
}

#Scare outcome
character_event = {
	id = halloween.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		random_list = {
			50 = { #Lame scare
				modifier = {
					trait = craven
					factor = 2
				}
				modifier = {
					trait = shy
					factor = 2
				}
				modifier = {
					trait = honest
					factor = 2
				}
				modifier = {
					trait = fair
					factor = 2
				}
				modifier = {
					trait = dwarf
					factor = 2
				}
				modifier = {
					has_character_flag = lazy_costume
					factor = 2
				}
				modifier = {
					has_character_flag = amazing_costume
					factor = 0
				}
				character_event = { id = halloween.3 days = 1 }
			}
			50 = { #Alright scare
				modifier = {
					trait = gregarious
					factor = 2
				}
				modifier = {
					trait = diligent
					factor = 1.5
				}
				modifier = {
					trait = scarred
					factor = 2
				}
				modifier = {
					has_character_flag = decent_costume
					factor = 1.5
				}
				character_event = { id = halloween.4 days = 1 }
			}
			50 = { #Masterful scare
				modifier = {
					trait = cruel
					factor = 2
				}
				modifier = {
					trait = wroth
					factor = 2
				}
				modifier = {
					trait = deceitful
					factor = 2
				}
				modifier = {
					trait = scarred
					factor = 1.25
				}
				modifier = {
					trait = scarred_mid
					factor = 1.5
				}
				modifier = {
					trait = scarred_high
					factor = 2
				}
				modifier = {
					trait = disfigured
					factor = 2
				}
				modifier = {
					trait = ugly
					factor = 2
				}
				modifier = {
					trait = giant
					factor = 2
				}
				modifier = {
					trait = hunchback
					factor = 2
				}
				modifier = {
					has_character_flag = amazing_costume
					factor = 2
				}
				modifier = {
					has_character_flag = lazy_costume
					factor = 0
				}
				character_event = { id = halloween.5 days = 1 }
			}
		}
	}
}

character_event = {
	id = halloween.3
	desc = EVTDESC_halloween_3
	picture = GFX_evt_sleeping_town_hf
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_3
		prestige = -30
		wealth = 10
		custom_tooltip = { text = TXT_halloween_walk_home }
		hidden_tooltip = { set_character_flag = bad_halloween }
	}
	
	after = {
		character_event = { id = halloween.6 } #the real meat of this event chain
	}
}

character_event = {
	id = halloween.4
	desc = EVTDESC_halloween_4
	picture = GFX_evt_sleeping_town_hf
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_4
		prestige = 15
		wealth = 15
		custom_tooltip = { text = TXT_halloween_walk_home }
		hidden_tooltip = { set_character_flag = ok_halloween }
	}
	
	after = {
		character_event = { id = halloween.6 }
	}
}

character_event = {
	id = halloween.5
	desc = EVTDESC_halloween_5
	picture = GFX_evt_sleeping_town_hf
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_5
		prestige = 45
		wealth = 30
		custom_tooltip = { text = TXT_halloween_walk_home }
		hidden_tooltip = { set_character_flag = good_halloween }
	}
	
	after = {
		character_event = { id = halloween.6 }
	}
}

#The real scare...
character_event = {
	id = halloween.6
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		random_list = {
			50 = { #Starving child
				character_event = { id = halloween.7 days = 1 }
			}
			50 = { #Scared by a costume
				modifier = {
					trait = craven
					factor = 2
				}
				modifier = {
					trait = shy
					factor = 2
				}
				character_event = { id = halloween.8 days = 1 }
			}
			50 = { #You scare a passerby
				modifier = {
					trait = scarred
					factor = 1.25
				}
				modifier = {
					trait = scarred_mid
					factor = 1.5
				}
				modifier = {
					trait = scarred_high
					factor = 2
				}
				modifier = {
					trait = disfigured
					factor = 2
				}
				modifier = {
					trait = ugly
					factor = 2
				}
				modifier = {
					trait = giant
					factor = 2
				}
				modifier = {
					trait = hunchback
					factor = 2
				}
				modifier = {
					has_character_flag = amazing_costume
					factor = 2
				}
				modifier = {
					has_character_flag = lazy_costume
					factor = 0
				}
				character_event = { id = halloween.9 days = 1 }
			}
			25 = { #Witch Coven
				character_event = { id = halloween.10 days = 1 }
			}
			25 = { #Masked killer
				character_event = { id = halloween.14 days = 1 }
			}
			25 = { #Ghost Girl
				modifier = {
					AND = {
						OR = {
							ai = no
							has_game_rule = {
								name = supernatural_events
								value = unrestricted
							}
						}
						NOR = {
							has_game_rule = {
								name = supernatural_events
								value = off
							}
							has_character_flag = eternal_life_events
						}
					}
					factor = 0
				}
				character_event = { id = halloween.19 days = 1 }
			}
			25 = { #Karmic Curse
				modifier = {
					AND = {
						OR = {
							ai = no
							has_game_rule = {
								name = supernatural_events
								value = unrestricted
							}
						}
						NOR = {
							has_game_rule = {
								name = supernatural_events
								value = off
							}
							has_character_flag = eternal_life_events
						}
					}
					factor = 0
				}
				modifier = {
					trait = is_fat
					factor = 2
				}
				modifier = {
					trait = ugly
					factor = 2
				}
				modifier = {
					trait = hunchback
					factor = 2
				}
				modifier = {
					trait = harelip
					factor = 2
				}
				character_event = { id halloween.25 = days = 1 }
			}
		}
	}
}


character_event = { #Starving child
	id = halloween.7
	desc = EVTDESC_halloween_7
	picture = GFX_evt_child_bully
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_7
		trigger = {
			NOR = {
				trait = greedy
				trait = cruel
			}
		}
		wealth = -10
		piety = 15
		if = {
			limit = {
				NOT = {
					trait = charitable
					trait = kind
				}
			}
			random_list = {
				33 = {
					add_trait = charitable
				}
				33 = {
					add_trait = kind
				}
				34 = {
				}
			}
		}
		custom_tooltip = { text = TXT_halloween_make_it_home }
		ai_chance = {
			factor = 50
			modifier = {
				trait = charitable
				factor = 2
			}
			modifier = {
				trait = kind
				factor = 2
			}
		}
	}
	
	option = {
		name = EVTOPTB_halloween_7
		trigger = {
			NOR = {
				trait = charitable
				trait = kind
			}
		}
		piety = -10
		if = {
			limit = {
				NOT = {
					trait = greedy
					trait = cruel
				}
			}
			random_list = {
				33 = {
					add_trait = greedy
				}
				33 = {
					add_trait = cruel
				}
				34 = {
				}
			}
		}
		custom_tooltip = { text = TXT_halloween_make_it_home }
		ai_chance = {
			factor = 50
			modifier = {
				trait = greedy
				factor = 2
			}
			modifier = {
				trait = cruel
				factor = 2
			}
		}
	}
	
	after = {
		character_event = { id = halloween.30 days = 1 }
	}
}

character_event = { #Scared by costume
	id = halloween.8
	desc = EVTDESC_halloween_8
	picture = GFX_evt_hooded_figure_hf
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_8
		prestige = -10
		if = {
			limit = {
				NOT = { trait = craven }
			}
			random_list = {
				90 = { }
				10 = { add_trait = craven }
			}
		}
		custom_tooltip = { text = TXT_halloween_make_it_home }
	}
	
	after = {
		character_event = { id = halloween.30 days = 1 }
	}
}

character_event = { #Scared by costume
	id = halloween.9
	desc = EVTDESC_halloween_9
	picture = GFX_evt_torture
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_9
		prestige = 15
		if = {
			limit = {
				NOT = { trait = proud }
			}
			random_list = {
				80 = { }
				20 = { add_trait = proud }
			}
		}
		custom_tooltip = { text = TXT_halloween_make_it_home }
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Encounter witch coven
	id = halloween.10
	desc = EVTDESC_halloween_10
	picture = GFX_evt_mysterious_forest
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_10
		custom_tooltip = { text = TXT_drink_potion_consent }
		hidden_tooltip = { set_character_flag = drank_potion_willingly }
		hidden_tooltip = {
			random_list = {
				75 = { character_event = { id = halloween.12 } } #Good potion
				25 = { character_event = { id = halloween.13 } } #Bad potion
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				trait = trusting
				factor = 2
			}
			modifier = {
				trait = paranoid
				factor = 0.5
			}
		}
	}
	
	option = {
		name = EVTOPTB_halloween_10
		custom_tooltip = { text = TXT_try_to_leave_witch }
		hidden_tooltip = { set_character_flag = drank_potion_unwillingly }
		hidden_tooltip = { character_event = { id = halloween.11 } }
		ai_chance = {
			factor = 50
			modifier = {
				trait = paranoid
				factor = 2
			}
			modifier = {
				trait = trusting
				factor = 0.5
			}
		}
	}
}

character_event = { #Try to escape witch coven
	id = halloween.11
	desc = EVTDESC_halloween_11
	picture = GFX_evt_bandits
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_11
		random_list = {
			50 = {
				modifier = {
					trait = strong
					factor = 3
				}
				modifier = {
					trait = robust
					factor = 2
				}
				modifier = {
					trait = duelist
					factor = 2
				}
				modifier = {
					combat_rating = 5
					factor = 1.25
				}
				modifier = {
					combat_rating = 10
					factor = 1.5
				}
				modifier = {
					combat_rating = 15
					factor = 2
				}
				modifier = {
					trait = weak
					factor = 0.25
				}
				modifier = {
					trait = feeble
					factor = 0.5
				}
				modifier = {
					trait = craven
					factor = 0.5
				}
				custom_tooltip = { text = TXT_witch_escape }
				hidden_tooltip = { character_event = { id = halloween.30 days = 1 } #Ending event
			}
			50 = {
				modifier = {
					trait = weak
					factor = 3
				}
				modifier = {
					trait = feeble
					factor = 2
				}
				modifier = {
					trait = craven
					factor = 2
				}
				modifier = {
					combat_rating = 5
					factor = 0.75
				}
				modifier = {
					combat_rating = 10
					factor = 0.5
				}
				modifier = {
					combat_rating = 15
					factor = 0.25
				}
				modifier = {
					trait = strong
					factor = 0.25
				}
				modifier = {
					trait = robust
					factor = 0.5
				}
				modifier = {
					trait = duelist
					factor = 0.5
				}
				custom_tooltip = { text = TXT_witch_captured }
				hidden_tooltip = {
					random_list = {
						25 = {
							character_event = { id = halloween.12 } #Good potion
						}
						75 = {
							character_event = { id = halloween.13 } #Bad potion
						}
					}
				}
			}
		}
	}
}

character_event = { #Good potion
	id = halloween.12
	desc = {
		text = EVTDESCA_halloween_12
		trigger = {
			has_character_flag = drank_potion_willingly
		}
	}
	desc = {
		text = EVTDESCB_halloween_12
		trigger = {
			has_character_flag = drank_potion_inwillingly
		}
	}
	picture = GFX_evt_doctor_crazy_treatment
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_12
		custom_tooltip = { text = TXT_halloween_good_potion }
		hidden_tooltip = {
			random_list = {
				20 = {
					if = {
						limit = {
							NOT = { trait = shrewd }
						}
						add_trait = shrewd
					}
					else_if = {
						limit = {
							trait = shrewd 
						}
						health = 1
					}
				}
				20 = {
					if = {
						limit = {
							NOT = { trait = robust }
						}
						add_trait = robust
					}
					else_if = {
						limit = {
							trait = robust 
						}
						health = 1
					}
				}
				20 = {
					if = {
						limit = {
							NOT = { trait = groomed }
						}
						add_trait = groomed
					}
					else_if = {
						limit = {
							trait = groomed 
						}
						health = 1
					}
				}
				40 = {
					health = 1
				}
			}
		}
		clr_character_flag = bad_halloween
		clr_character_flag = ok_halloween
		set_character_flag = good_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Bad potion
	id = halloween.13
	desc = {
		text = EVTDESCA_halloween_13
		trigger = {
			has_character_flag = drank_potion_willingly
		}
	}
	desc = {
		text = EVTDESCB_halloween_13
		trigger = {
			has_character_flag = drank_potion_unwillingly
		}
	}
	picture = GFX_evt_doctor_crazy_treatment
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_13
		custom_tooltip = { text = TXT_halloween_bad_potion }
		hidden_tooltip = {
			random_list = {
				20 = {
					if = {
						limit = {
							NOT = { trait = dull }
						}
						add_trait = dull
					}
					else_if = {
						limit = {
							trait = dull 
						}
						health = -1
					}
				}
				20 = {
					if = {
						limit = {
							NOT = { trait = feeble }
						}
						add_trait = feeble
					}
					else_if = {
						limit = {
							trait = feeble 
						}
						health = -1
					}
				}
				20 = {
					if = {
						limit = {
							NOT = { trait = uncouth }
						}
						add_trait = uncouth
					}
					else_if = {
						limit = {
							trait = uncouth 
						}
						health = -1
					}
				}
				40 = {
					health = -1
				}
			}
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = {
	id = halloween.14
	desc = EVTDESC_halloween_14
	picture = GFX_evt_hooded_figure_hf
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = { # Run away!
		name = EVTOPTA_halloween_14
		custom_tooltip = { text = TXT_halloween_killer_flee }
		hidden_tooltip = {
			random_list = {
				75 = { #You successfully flee, may get paranoid.
					character_event = { id = halloween.15 }
				}
				25 = { #You are severely wounded.
					character_event = { id = halloween.16 }
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				trait = craven
				factor = 2
			}
			modifier = {
				trait = brave
				factor = 0.5
			}
		}
	}
	
	option = { # Fight back!
		name = EVTOPTB_halloween_14
		custom_tooltip = { text = TXT_halloween_killer_fight }
		hidden_tooltip = {
			random_list = {
				50 = { # win, get wounded
					modifier = {
						trait = strong
						factor = 3
					}
					modifier = {
						trait = robust
						factor = 2
					}
					modifier = {
						trait = duelist
						factor = 2
					}
					modifier = {
						combat_rating = 5
						factor = 1.25
					}
					modifier = {
						combat_rating = 10
						factor = 1.5
					}
					modifier = {
						combat_rating = 15
						factor = 2
					}
					modifier = {
						trait = weak
						factor = 0.25
					}
					modifier = {
						trait = feeble
						factor = 0.5
					}
					modifier = {
						trait = craven
						factor = 0.5
					}
					character_event = { id = halloween.17 }
				}
				50 = { # die
					modifier = {
						trait = weak
						factor = 3
					}
					modifier = {
						trait = feeble
						factor = 2
					}
					modifier = {
						trait = craven
						factor = 2
					}
					modifier = {
						combat_rating = 5
						factor = 0.75
					}
					modifier = {
						combat_rating = 10
						factor = 0.5
					}
					modifier = {
						combat_rating = 15
						factor = 0.25
					}
					modifier = {
						trait = strong
						factor = 0.25
					}
					modifier = {
						trait = robust
						factor = 0.5
					}
					modifier = {
						trait = duelist
						factor = 0.5
					}
					character_event = { id = halloween.18 }
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				trait = craven
				factor = 2
			}
			modifier = {
				trait = brave
				factor = 0.5
			}
		}
	}
}

character_event = { #Escape successfully
	id = halloween.15
	desc = EVTDESC_halloween_15
	picture = GFX_evt_house_arrest_escape
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = { # May gain paranoid
		name = EVTOPTA_halloween_15
		custom_tooltip = { text = TXT_halloween_killer_ran_away }
		prestige = -15
		random_list = {
			50 = {
				if = {
					limit = {
						NOT = { trait = paranoid }
					}
					add_trait = paranoid
				}
				else_if = {
					limit = {
						trait = paranoid
					}
					prestige = -10
				}
			}
			50 = {
				if = {
					limit = {
						NOT = { trait = craven }
					}
					add_trait = craven
				}
				else_if = {
					limit = {
						trait = craven
					}
					prestige = -10
				}
			}
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Get severely injured
	id = halloween.16
	desc = EVTDESC_halloween_16
	picture = GFX_evt_bloody_man
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = { # Ouch
		name = EVTOPTA_halloween_16
		custom_tooltip = { text = TXT_halloween_killer_severely_injured }
		hidden_tooltip = { add_maimed_trait_effect = yes }
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Fought back, wounded
	id = halloween.17
	desc = EVTDESC_halloween_17
	picture = GFX_evt_cornered_duel_hf
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = { # Ouch
		name = EVTOPTA_halloween_17
		custom_tooltip = { text = TXT_halloween_killer_wounded }
		prestige = 20
		add_trait = wounded
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Fought back, dead
	id = halloween.18
	desc = EVTDESC_halloween_18
	picture = GFX_evt_slit_throat_hf
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = { # RIP
		name = EVTOPTA_halloween_18
		custom_tooltip = { text = TXT_halloween_killer_death }
		hidden_tooltip = {
			death = { death_reason = death_murder }
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	#after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Scary ghost girl ping event
	id = halloween.19
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		random_list = {
			50 = {
				set_character_flag = nice_ghost_girl
			}
			50 = {
				set_character_flag = evil_ghost_girl
			}
		}
		character_event = { id = halloween.20 }
	}
}

character_event = { #Encounter the ghost girl
	id = halloween.20
	desc = {
		text = EVTDESCA_halloween_20
		trigger = {
			has_character_flag = nice_ghost_girl
		}
	}
	desc = {
		text = EVTDESCB_halloween_20
		trigger = {
			has_character_flag = evil_ghost_girl
		}
	}
	picture = GFX_evt_meeting_hf
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_20
		custom_tooltip = { text = TXT_treat_ghost_nicely }
		hidden_tooltip = {
			if = {
				limit = {
					has_character_flag = nice_ghost_girl
				}
				character_event = { id = halloween.21 }
			}
			else_if = {
				limit = {
					has_character_flag = evil_ghost_girl
				}
				character_event = { id = halloween.23 }
			}
		}
	}
	
	option = {
		name = EVTOPTB_halloween_20
		custom_tooltip = { text = TXT_treat_ghost_forcefully }
		hidden_tooltip = {
			if = {
				limit = {
					has_character_flag = nice_ghost_girl
				}
				character_event = { id = halloween.22 }
			}
			else_if = {
				limit = {
					has_character_flag = evil_ghost_girl
				}
				character_event = { id = halloween.24 }
			}
		}
	}
}

character_event = { #Nice ghost girl good end
	id = halloween.21
	desc = EVTDESC_halloween_21
	picture = GFX_evt_death
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
		has_character_flag = nice_ghost_girl
	}
	
	option = {
		name = EVTOPTA_halloween_21
		piety = 20
		custom_tooltip = { text = TXT_good_end_ghost }
		random_list = {
			33 = {
				if = {
					limit = {
						NOT = { trait = charitable }
					}
					add_trait = charitable
				}
				else_if = {
					limit = {
						trait = charitable
					}
					prestige = 20
				}
			}
			33 = {
				if = {
					limit = {
						NOT = { trait = patient }
					}
					add_trait = patient
				}
				else_if = {
					limit = {
						trait = patient
					}
					prestige = 20
				}
			}
			34 = {
				if = {
					limit = {
						NOT = { trait = kind }
					}
					add_trait = kind
				}
				else_if = {
					limit = {
						trait = kind
					}
					prestige = 20
				}
			}
		}
		clr_character_flag = bad_halloween
		clr_character_flag = ok_halloween
		set_character_flag = good_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Nice ghost girl bad end
	id = halloween.22
	desc = EVTDESC_halloween_22
	picture = GFX_evt_bloody_man
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
		has_character_flag = nice_ghost_girl
	}
	
	option = {
		name = EVTOPTA_halloween_22
		piety = -15
		custom_tooltip = { text = TXT_bad_end_ghost }
		random_list = {
			70 = {
				if = {
					limit = {
						NOT = { trait = paranoid }
					}
					add_trait = paranoid
				}
				else_if = {
					limit = {
						trait = paranoid
					}
					prestige = -20
				}
			}
			25 = {
				if = {
					limit = {
						NOT = { trait = possessed }
					}
					add_trait = possessed
				}
				else_if = {
					limit = {
						trait = possessed
					}
					prestige = -20
				}
			}
			25 = {
				if = {
					limit = {
						NOT = { trait = lunatic }
					}
					add_trait = lunatic
				}
				else_if = {
					limit = {
						trait = lunatic
					}
					prestige = -20
				}
			}
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Evil ghost girl bad end
	id = halloween.23
	desc = EVTDESC_halloween_23
	picture = GFX_evt_lunatic
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
		has_character_flag = evil_ghost_girl
	}
	
	option = {
		name = EVTOPTA_halloween_23
		piety = -25
		custom_tooltip = { text = TXT_bad_end_ghost }
		random_list = {
			33 = {
				if = {
					limit = {
						NOT = { trait = possessed }
					}
					add_trait = possessed
				}
				else_if = {
					limit = {
						trait = possessed
					}
					prestige = -20
				}
			}
			33 = {
				if = {
					limit = {
						NOT = { trait = lunatic }
					}
					add_trait = lunatic
				}
				else_if = {
					limit = {
						trait = lunatic
					}
					prestige = -20
				}
			}
			34 = {
				if = {
					limit = {
						NOT = { trait = paranoid }
					}
					add_trait = paranoid
				}
				else_if = {
					limit = {
						trait = paranoid
					}
					prestige = -20
				}
			}
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Evil ghost girl good end
	id = halloween.24
	desc = EVTDESC_halloween_24
	picture = GFX_evt_judged_by_ruler
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
		has_character_flag = evil_ghost_girl
	}
	
	option = {
		name = EVTOPTA_halloween_24
		piety = 30
		custom_tooltip = { text = TXT_good_end_ghost }
		random_list = {
			33 = {
				if = {
					limit = {
						NOT = { trait = brave }
					}
					add_trait = brave
				}
				else_if = {
					limit = {
						trait = brave
					}
					prestige = 25
				}
			}
			33 = {
				if = {
					limit = {
						NOT = { trait = proud }
					}
					add_trait = proud
				}
				else_if = {
					limit = {
						trait = proud
					}
					prestige = 25
				}
			}
			34 = {
				if = {
					limit = {
						NOT = { trait = zealous }
					}
					add_trait = zealous
				}
				else_if = {
					limit = {
						trait = zealous
					}
					prestige = 25
				}
			}
		}
		clr_character_flag = bad_halloween
		clr_character_flag = ok_halloween
		set_character_flag = good_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } } #Ending event
}

character_event = { #Bump into old woman on the street
	id = halloween.25
	desc = EVTDESC_halloween_25
	picture = GFX_evt_wise_woman
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = { # Apologize and move on
		name = EVTOPTA_halloween_25
		prestige = -10
		custom_tooltip = { text = TXT_halloween_make_it_home }
		hidden_tooltip = { character_event = { id = halloween.30 days = 1 } #Ending event }
	}
	
	option = { # Berate old woman
		name = EVTOPTB_halloween_25
		prestige = 10
		custom_tooltip = { text = TXT_halloween_make_it_home }
		hidden_tooltip = {
			random_list = {
				25 = { #Become fat
					character_event = { id = halloween.26 days = 1 }
				}
				25 = { #Become ugly
					character_event = { id = halloween.27 days = 1 }
				}
				25 = { #Become hunchback
					character_event = { id = halloween.28 days = 1 }
				}
				25 = { #Get harelip
					character_event = { id = halloween.29 days = 1 }
				}
			}
		}
	}
}

character_event = { #Wake up and realize that you are fat
	id = halloween.26
	desc = EVTDESC_halloween_26
	picture = GFX_evt_bad_news
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		gain_weight_large_effect = yes
		gain_weight_large_effect = yes
	}
	
	option = { #Uh-oh
		name = EVTOPTA_halloween_26
		if = {
			limit = {
				NOT = { trait = stressed }
			}
			add_trait = stressed
		}
		if = {
			limit = {
				trait = stressed 
				NOT = { trait = depressed }
			}
			add_trait = depressed
		}
		if = {
			limit = {
				trait = depressed 
				trait = stressed
			}
			prestige = -50
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } }
}

character_event = { #Wake up and realize that you are ugly
	id = halloween.27
	desc = EVTDESC_halloween_27
	picture = GFX_evt_bad_news
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		remove_trait = fair
		remove_trait = groomed
		add_trait = ugly
	}
	
	option = { #Uh-oh
		name = EVTOPTA_halloween_27
		if = {
			limit = {
				NOT = { trait = stressed }
			}
			add_trait = stressed
		}
		if = {
			limit = {
				trait = stressed 
				NOT = { trait = depressed }
			}
			add_trait = depressed
		}
		if = {
			limit = {
				trait = depressed 
				trait = stressed
			}
			prestige = -50
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } }
}

character_event = { #Wake up and realize that you are hunchbacked
	id = halloween.28
	desc = EVTDESC_halloween_28
	picture = GFX_evt_bad_news
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		remove_trait = fair
		remove_trait = groomed
		add_trait = hunchback
	}
	
	option = { #Uh-oh
		name = EVTOPTA_halloween_28
		if = {
			limit = {
				NOT = { trait = stressed }
			}
			add_trait = stressed
		}
		if = {
			limit = {
				trait = stressed 
				NOT = { trait = depressed }
			}
			add_trait = depressed
		}
		if = {
			limit = {
				trait = depressed 
				trait = stressed
			}
			prestige = -50
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } }
}

character_event = { #Wake up and realize that you are harelipped
	id = halloween.29
	desc = EVTDESC_halloween_29
	picture = GFX_evt_bad_news
	border = GFX_event_frame_normal_intrigue
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		remove_trait = fair
		remove_trait = groomed
		add_trait = harelip
	}
	
	option = { #Uh-oh
		name = EVTOPTA_halloween_26
		if = {
			limit = {
				NOT = { trait = stressed }
			}
			add_trait = stressed
		}
		if = {
			limit = {
				trait = stressed 
				NOT = { trait = depressed }
			}
			add_trait = depressed
		}
		if = {
			limit = {
				trait = depressed 
				trait = stressed
			}
			prestige = -50
		}
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		set_character_flag = bad_halloween
	}
	
	after = { character_event = { id = halloween.30 days = 1 } }
}

character_event = {
	id = halloween.30
	desc = {
		text = EVTDESCA_halloween_30
		trigger = {
			has_character_flag = bad_halloween
		}
	}
	desc = {
		text = EVTDESCB_halloween_30
		trigger = {
			has_character_flag = ok_halloween
		}
	}
	desc = {
		text = EVTDESCC_halloween_30
		trigger = {
			has_character_flag = good_halloween
		}
	}
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_frame_normal_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	option = {
		name = EVTOPTA_halloween_30
		trigger = { has_character_flag = good_halloween }
		custom_tooltip = { text = TXT_halloween_end }
		prestige = 35
	}
	
	option = {
		name = EVTOPTB_halloween_30
		trigger = { has_character_flag = ok_halloween }
		custom_tooltip = { text = TXT_halloween_end }
		prestige = 15
	}
	
	option = {
		name = EVTOPTC_halloween_30
		trigger = { has_character_flag = bad_halloween }
		custom_tooltip = { text = TXT_halloween_end }
		prestige = -10
	}
	
	after = {
		clr_character_flag = celebrating_halloween
		clr_character_flag = lazy_costume
		clr_character_flag = decent_costume
		clr_character_flag = amazing_costume
		clr_character_flag = drank_potion_willingly
		clr_character_flag = drank_potion_unwillingly
		clr_character_flag = nice_ghost_girl
		clr_character_flag = evil_ghost_girl
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		clr_character_flag = bad_halloween
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
		character_event = { id = halloween.31 days = 5 } #safety catch
	}
}

character_event = {
	id = halloween.31
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_character_flag = celebrating_halloween
	}
	
	immediate = {
		clr_character_flag = celebrating_halloween
		clr_character_flag = lazy_costume
		clr_character_flag = decent_costume
		clr_character_flag = amazing_costume
		clr_character_flag = drank_potion_willingly
		clr_character_flag = drank_potion_unwillingly
		clr_character_flag = nice_ghost_girl
		clr_character_flag = evil_ghost_girl
		clr_character_flag = good_halloween
		clr_character_flag = ok_halloween
		clr_character_flag = bad_halloween
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
	}
}