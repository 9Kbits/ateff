###########################################
#										 #
# M&M Secret religious cults			  #
#										 #
# ID MNM.3000-MNM.3999					  #
#										 #
###########################################

#IDs:
#3100-3199 David
#3200-3399 Milla
#3400-3599 Mathilda
#3600-3799 Drikus
#3800-3948 Joel
#3949-3997 Jakob

#Useful triggers
#is_secret_religious_society_member_trigger
#is_christian_secret_religious_society_member_trigger
#is_muslim_secret_religious_society_member_trigger
#is_indian_secret_religious_society_member_trigger
#is_openly_of_prevs_secret_religion_trigger
#has_sympathy_for_true_religion_of_prev_trigger
#true_religion_X_trigger
#true_religion_group_X_trigger
#is_in_prevs_interesting_society_trigger
#shares_prevs_secret_religion_trigger

#Useful effects 
#add_trait_for_prevs_secret_religion_society_effect 
#add_prevs_secret_religion_trait_effect 
#add_sympathy_for_prevs_true_religion_effect


namespace = MNM


#JOINING

#Sat in house of worship, approached by someone sat next to me
character_event = {
	id = MNM.3420
	desc = EVTDESC_MNM_3420
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes 

	hide_from = yes
	
	immediate = {
		#The inductor
		if = {
			limit = { NOT = { event_target:secret_religion_recruiter = { always = yes } } }
			random_society_member = { #backup
				limit = { 
					is_in_prevs_interesting_society_trigger = yes 
					ai = yes
				}
				save_event_target_as = secret_religion_recruiter 
			}
			random_society_member = { #diplo range
				limit = { 
					is_in_prevs_interesting_society_trigger = yes 
					is_within_diplo_range = ROOT
					ai = yes
				}
				save_event_target_as = secret_religion_recruiter 
			}
			random_society_member = { #same realm
				limit = { 
					is_in_prevs_interesting_society_trigger = yes 
					same_realm = ROOT
					ai = yes
				}
				save_event_target_as = secret_religion_recruiter 
			}
			any_courtier = { #a courtier
				limit = { 
					is_in_prevs_interesting_society_trigger = yes 
					ai = yes
				}
				save_event_target_as = secret_religion_recruiter 
			}
		}
		save_event_target_as = secret_religion_recruitee
		#For loc 
		random_realm_character = {
			limit = { is_female = no }
			save_event_target_as = spiritual_gender
		}
		random_courtier_or_vassal = {
			limit = { is_priest = yes }
			save_event_target_as = spiritual_gender
		}
	}

	#Follow them
	option = { 
		name = EVTOPTA_MNM_3420
		custom_tooltip = { text = EVTOPTA_MNM_3420_TT }

		hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3425 days = 3 } } }

		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = brave 
			}
			modifier = {
				factor = 5
				trait = just 
			}
			modifier = {
				factor = 5
				trait = trusting 
			}
		}
	}

	#Remain seated
	option = {
		name = EVTOPTB_MNM_3420
		custom_tooltip = { text = EVTOPTB_MNM_3420_TT }

		hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3423 days = 1 } } } #notification of failure
		#set_interested_society = none

		ai_chance = {
			factor = 10
			modifier = {
				trait = craven
				factor = 15
			}
			modifier = {
				trait = paranoid
				factor = 5
			}
			modifier = {
				trait = arbitrary
				factor = 5
			}
			modifier = {
				trait = content
				factor = 5
			}		
		}
	}
}

#Ping event
character_event = {
	id = MNM.3425
	hide_window = yes

	is_triggered_only = yes
	
	option = { 
		event_target:secret_religion_recruitee = { character_event = { id = MNM.3421 } }
	}
}

#Came with them, they offered me to join
character_event = {
	id = MNM.3421
	picture = GFX_evt_shady_meeting
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { event_target:secret_religion_recruiter = { ROOT = { character_knows_prev_trigger = yes } } }
		text = EVTDESC_MNM_3421_A
	}
	 desc = {
		trigger = { event_target:secret_religion_recruiter = { ROOT = { character_knows_prev_trigger = no } } }
		text = EVTDESC_MNM_3421_B
	}

	is_triggered_only = yes

	immediate = {
		event_target:secret_religion_recruiter = { save_event_target_as = secret_religion_recruiter }
	}

	#Yes
	option = { 
		name = EVTOPTA_MNM_3421
		custom_tooltip = { text = EVTOPTA_MNM_3421_TT }
		hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3422 days = 1 } } }
		ai_chance = { 
			factor = 80 
			modifier = { is_in_society = yes factor = 0 } #Cannot join a new society when they're already in a society
		}
	}

	#No
	option = {
		name = EVTOPTB_MNM_3421
		custom_tooltip = { text = EVTOPTB_MNM_3421_TT }

		hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3423 days = 1 } } } #notification of failure
		#set_interested_society = none

		ai_chance = { factor = 20 }
	}
}

#The interested party accepted
character_event = {
	id = MNM.3422
	desc = EVTDESC_MNM_3422
	picture = GFX_evt_shady_meeting
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	immediate = {
		society = { save_event_target_as = recruiter_society }
	}
	
	option = { 
		name = EVTOPTA_MNM_3422
		
		tooltip = { event_target:secret_religion_recruitee = { join_society = event_target:recruiter_society } }

		hidden_effect = { event_target:secret_religion_recruitee = { character_event = { id = MNM.3424 days = 2 } } }
	}
}

#The interested party rejected
character_event = {
	id = MNM.3423
	desc = EVTDESC_MNM_3423
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3423
	}
}

#Confirmation for joiner on joining
character_event = {
	id = MNM.3424
	desc = EVTDESC_MNM_3424
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3424

		join_society = event_target:recruiter_society
	}
}

#MISSIONS

#Mission tombola
character_event = {
	id = MNM.3000
	hide_window = yes

	is_triggered_only = yes
	capable_only = yes
	
	trigger = {
		society_member_of = secret_religious_cult
		is_society_grandmaster = no
		has_any_quest = no
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_modifier = quest_cooldown_timer }
	}

	immediate = {
		if = { # If the society has no Grandmaster, disband it
			limit = {
				NOT = {
					society = {
						any_society_member = {
							is_society_grandmaster = yes
						}
					}
				}
			}
			any_society_member = {
				limit = {
					same_society_as = ROOT
				}
				leave_society = yes
			}
			leave_society = yes
		}
	
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = society_leader
		}

		random_list = {
			10 = { #Induct a ruler
				modifier = {
					factor = 0
					ai = yes
				}
				modifier = {
					factor = 0
					society_rank < 2
				}
				modifier = {
					factor = 0
					NOT = {
						top_liege = { 
							any_realm_lord = { 
								ok_sr_induction_mission_target_trigger = yes
							} 
						}
					}
				}
				event_target:society_leader	= { character_event = { id = MNM.3400 } }
			}
			10 = { #Make ruler sympathetic
				modifier = {
					factor = 0
					ai = yes
				}
				modifier = {
					factor = 0
					NOT = {
						top_liege = { 
							any_realm_lord = { 
								ok_sr_sympathy_mission_target_trigger = yes
							} 
						}
					}
				}
				trigger = {
					society_rank > 1
				}
				event_target:society_leader	= { character_event = { id = MNM.3402 } }
			}
			10 = { # Prepare Grounds
				modifier = {
					factor = 0
					society_rank < 3
				}
				modifier = {
					factor = 0
					NOT = {
						any_demesne_province = {
							OR = {
								AND = {
									ROOT = { secret_religion = rastafarian }
									NOR = {
										religion = rastafarian
										has_province_modifier = secret_rastafarian_community
									}
								}
								AND = {
									ROOT = { secret_religion = voodoo }
									NOR = {
										religion = voodoo
										has_province_modifier = secret_voodoo_community
									}
								}
								AND = {
									ROOT = { secret_religion = santeria }
									NOR = {
										religion = santeria
										has_province_modifier = secret_santeria_community
									}
								}
								AND = {
									ROOT = { secret_religion = candomble }
									NOR = {
										religion = candomble
										has_province_modifier = secret_candomble_community
									}
								}
								AND = {
									ROOT = { secret_religion = espiritista }
									NOR = {
										religion = espiritista
										has_province_modifier = secret_espiritista_community
									}
								}
								AND = {
									ROOT = { secret_religion = espiritista_reformed }
									NOR = {
										religion = espiritista_reformed
										has_province_modifier = secret_espiritista_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = peyotist }
									NOR = {
										religion = peyotist
										has_province_modifier = secret_peyotist_community
									}
								}
								AND = {
									ROOT = { secret_religion = midewiwin }
									NOR = {
										religion = midewiwin
										has_province_modifier = secret_midewiwin_community
									}
								}
								AND = {
									ROOT = { secret_religion = midewiwin_reformed }
									NOR = {
										religion = midewiwin_reformed
										has_province_modifier = secret_midewiwin_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = raven_tales }
									NOR = {
										religion = raven_tales
										has_province_modifier = secret_raven_tales_community
									}
								}
								AND = {
									ROOT = { secret_religion = raven_tales_reformed }
									NOR = {
										religion = raven_tales_reformed
										has_province_modifier = secret_raven_tales_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = catholic }
									NOR = {
										religion = catholic
										has_province_modifier = secret_catholic_community
									}
								}
								AND = {
									ROOT = { secret_religion = neognostic }
									NOR = {
										religion = neognostic
										has_province_modifier = secret_neognostic_community
									}
								}
								AND = {
									ROOT = { secret_religion = sedevacantist }
									NOR = {
										religion = sedevacantist
										has_province_modifier = secret_sedevacantist_community
									}
								}
								AND = {
									ROOT = { secret_religion = nestorian }
									NOR = {
										religion = nestorian
										has_province_modifier = secret_nestorian_community
									}
								}
								AND = {
									ROOT = { secret_religion = ursuline }
									NOR = {
										religion = ursuline
										has_province_modifier = secret_ursuline_community
									}
								}
								AND = {
									ROOT = { secret_religion = angeline }
									NOR = {
										religion = angeline
										has_province_modifier = secret_angeline_community
									}
								}
								AND = {
									ROOT = { secret_religion = confederated }
									NOR = {
										religion = confederated
										has_province_modifier = secret_confederated_community
									}
								}
								AND = {
									ROOT = { secret_religion = anabaptist }
									NOR = {
										religion = anabaptist
										has_province_modifier = secret_anabaptist_community
									}
								}
								AND = {
									ROOT = { secret_religion = batenburger }
									NOR = {
										religion = batenburger
										has_province_modifier = secret_batenburger_community
									}
								}
								AND = {
									ROOT = { secret_religion = evangelical }
									NOR = {
										religion = evangelical
										has_province_modifier = secret_evangelical_community
									}
								}
								AND = {
									ROOT = { secret_religion = antinomian }
									NOR = {
										religion = antinomian
										has_province_modifier = secret_antinomian_community
									}
								}
								AND = {
									ROOT = { secret_religion = charismatic }
									NOR = {
										religion = charismatic
										has_province_modifier = secret_charismatic_community
									}
								}
								AND = {
									ROOT = { secret_religion = postadventist }
									NOR = {
										religion = postadventist
										has_province_modifier = secret_postadventist_community
									}
								}
								AND = {
									ROOT = { secret_religion = falling_star }
									NOR = {
										religion = falling_star
										has_province_modifier = secret_falling_star_community
									}
								}
								AND = {
									ROOT = { secret_religion = moravian }
									NOR = {
										religion = moravian
										has_province_modifier = secret_moravian_community
									}
								}
								AND = {
									ROOT = { secret_religion = high_church }
									NOR = {
										religion = high_church
										has_province_modifier = secret_high_church_community
									}
								}
								AND = {
									ROOT = { secret_religion = nonconformist }
									NOR = {
										religion = nonconformist
										has_province_modifier = secret_nonconformist_community
									}
								}
								AND = {
									ROOT = { secret_religion = apostolic }
									NOR = {
										religion = apostolic
										has_province_modifier = secret_apostolic_community
									}
								}
								AND = {
									ROOT = { secret_religion = sacred_heart }
									NOR = {
										religion = sacred_heart
										has_province_modifier = secret_sacred_heart_community
									}
								}
								AND = {
									ROOT = { secret_religion = gracia_divina }
									NOR = {
										religion = gracia_divina
										has_province_modifier = secret_gracia_divina_community
									}
								}
								AND = {
									ROOT = { secret_religion = cetic }
									NOR = {
										religion = cetic
										has_province_modifier = secret_cetic_community
									}
								}
								AND = {
									ROOT = { secret_religion = gaian }
									NOR = {
										religion = gaian
										has_province_modifier = secret_gaian_community
									}
								}
								AND = {
									ROOT = { secret_religion = shinto }
									NOR = {
										religion = shinto
										has_province_modifier = secret_shinto_community
									}
								}
								AND = {
									ROOT = { secret_religion = nousthreskeia }
									NOR = {
										religion = nousthreskeia
										has_province_modifier = secret_nousthreskeia_community
									}
								}
								AND = {
									ROOT = { secret_religion = mormon }
									NOR = {
										religion = mormon
										has_province_modifier = secret_mormon_community
									}
								}
								AND = {
									ROOT = { secret_religion = bickertonite }
									NOR = {
										religion = bickertonite
										has_province_modifier = secret_bickertonite_community
									}
								}
								AND = {
									ROOT = { secret_religion = woolleyite }
									NOR = {
										religion = woolleyite
										has_province_modifier = secret_woolleyite_community
									}
								}
								AND = {
									ROOT = { secret_religion = strangite }
									NOR = {
										religion = strangite
										has_province_modifier = secret_strangite_community
									}
								}
								AND = {
									ROOT = { secret_religion = sol_invicta }
									NOR = {
										religion = sol_invicta
										has_province_modifier = secret_sol_invicta_community
									}
								}
								AND = {
									ROOT = { secret_religion = mictlantec }
									NOR = {
										religion = mictlantec
										has_province_modifier = secret_mictlantec_community
									}
								}
								AND = {
									ROOT = { secret_religion = uahomche }
									NOR = {
										religion = uahomche
										has_province_modifier = secret_uahomche_community
									}
								}
								AND = {
									ROOT = { secret_religion = neomayan }
									NOR = {
										religion = neomayan
										has_province_modifier = secret_neomayan_community
									}
								}
								AND = {
									ROOT = { secret_religion = americanist }
									NOR = {
										religion = americanist
										has_province_modifier = secret_americanist_community
									}
								}
								AND = {
									ROOT = { secret_religion = hamiltonian }
									NOR = {
										religion = hamiltonian
										has_province_modifier = secret_hamiltonian_community
									}
								}
								AND = {
									ROOT = { secret_religion = jeffersonian }
									NOR = {
										religion = jeffersonian
										has_province_modifier = secret_jeffersonian_community
									}
								}
								AND = {
									ROOT = { secret_religion = libertarian }
									NOR = {
										religion = libertarian
										has_province_modifier = secret_libertarian_community
									}
								}
								AND = {
									ROOT = { secret_religion = consumerist }
									NOR = {
										religion = consumerist
										has_province_modifier = secret_consumerist_community
									}
								}
								AND = {
									ROOT = { secret_religion = monetarist }
									NOR = {
										religion = monetarist
										has_province_modifier = secret_monetarist_community
									}
								}
								AND = {
									ROOT = { secret_religion = monetarist }
									NOR = {
										religion = monetarist
										has_province_modifier = secret_monetarist_community
									}
								}
								AND = {
									ROOT = { secret_religion = atomicist }
									NOR = {
										religion = atomicist
										has_province_modifier = secret_atomicist_community
									}
								}
								AND = {
									ROOT = { secret_religion = aphite }
									NOR = {
										religion = aphite
										has_province_modifier = secret_aphite_community
									}
								}
								AND = {
									ROOT = { secret_religion = pagan }
									NOR = {
										religion = pagan
										has_province_modifier = secret_pagan_community
									}
								}
								AND = {
									ROOT = { secret_religion = revelationist_reformed }
									NOR = {
										religion = revelationist_reformed
										has_province_modifier = secret_revelationist_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = revelationist }
									NOR = {
										religion = revelationist
										has_province_modifier = secret_revelationist_community
									}
								}
								AND = {
									ROOT = { secret_religion = rust_cultist }
									NOR = {
										religion = rust_cultist
										has_province_modifier = secret_rust_cultist_community
									}
								}
								AND = {
									ROOT = { secret_religion = chrome_cultist }
									NOR = {
										religion = chrome_cultist
										has_province_modifier = secret_chrome_cultist_community
									}
								}
								AND = {
									ROOT = { secret_religion = occultist_reformed }
									NOR = {
										religion = occultist_reformed
										has_province_modifier = secret_occultist_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = occultist }
									NOR = {
										religion = occultist
										has_province_modifier = secret_occultist_community
									}
								}
								AND = {
									ROOT = { secret_religion = thelemic_reformed }
									NOR = {
										religion = thelemic_reformed
										has_province_modifier = secret_thelemic_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = thelemic }
									NOR = {
										religion = thelemic
										has_province_modifier = secret_thelemic_community
									}
								}
								AND = {
									ROOT = { secret_religion = norse_pagan_reformed }
									NOR = {
										religion = norse_pagan_reformed
										has_province_modifier = secret_norse_pagan_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = norse_pagan }
									NOR = {
										religion = norse_pagan
										has_province_modifier = secret_norse_pagan_community
									}
								}
								AND = {
									ROOT = { secret_religion = celtic_pagan_reformed }
									NOR = {
										religion = celtic_pagan_reformed
										has_province_modifier = secret_celtic_pagan_reformed_community
									}
								}
								AND = {
									ROOT = { secret_religion = celtic_pagan }
									NOR = {
										religion = celtic_pagan
										has_province_modifier = secret_celtic_pagan_community
									}
								}
								AND = {
									ROOT = { secret_religion = brethren }
									NOR = {
										religion = brethren
										has_province_modifier = secret_brethren_community
									}
								}
								AND = {
									ROOT = { secret_religion = jewish }
									NOR = {
										religion = jewish
										has_province_modifier = secret_jewish_community
									}
								}
								AND = {
									ROOT = { secret_religion = reform }
									NOR = {
										religion = reform
										has_province_modifier = secret_reform_community
									}
								}
								AND = {
									ROOT = { secret_religion = meshichist }
									NOR = {
										religion = meshichist
										has_province_modifier = secret_meshichist_community
									}
								}
								AND = {
									ROOT = { secret_religion = hindu }
									NOR = {
										religion = hindu
										has_province_modifier = secret_hindu_community
									}
								}
								AND = { 
									ROOT = { secret_religion = celtic_pagan }
									NOR = {
										religion = celtic_pagan
										has_province_modifier = secret_celtic_pagan_community
									}
								}
								AND = { 
									ROOT = { secret_religion = celtic_pagan_reformed }
									NOR = {
										religion = celtic_pagan_reformed
										has_province_modifier = secret_celtic_pagan_reformed_community
									}
								}
								AND = { 
									ROOT = { secret_religion = traditionalist }
									NOR = {
										religion = traditionalist
										has_province_modifier = secret_traditionalist_community
									}
								}
								AND = { 
									ROOT = { secret_religion = revivalist }
									NOR = {
										religion = revivalist
										has_province_modifier = secret_revivalist_community
									}
								}
								AND = { 
									ROOT = { secret_religion = imamite }
									NOR = {
										religion = imamite
										has_province_modifier = secret_imamite_community
									}
								}
								AND = { 
									ROOT = { secret_religion = qingzheng }
									NOR = {
										religion = qingzheng
										has_province_modifier = secret_qingzheng_community
									}
								}
								AND = { 
									ROOT = { secret_religion = alawiyya }
									NOR = {
										religion = alawiyya
										has_province_modifier = secret_alawiyya_community
									}
								}
								AND = { 
									ROOT = { secret_religion = orientalist }
									NOR = {
										religion = orientalist
										has_province_modifier = secret_orientalist_community
									}
								}
								AND = { 
									ROOT = { secret_religion = misrist }
									NOR = {
										religion = misrist
										has_province_modifier = secret_misrist_community
									}
								}
								AND = { 
									ROOT = { secret_religion = trailwalker }
									NOR = {
										religion = trailwalker
										has_province_modifier = secret_trailwalker_community
									}
								}
								AND = { 
									ROOT = { secret_religion = trailwalker_reformed }
									NOR = {
										religion = trailwalker_reformed
										has_province_modifier = secret_trailwalker_reformed_community
									}
								}
								AND = { 
									ROOT = { secret_religion = orthodox }
									NOR = {
										religion = orthodox
										has_province_modifier = secret_orthodox_community
									}
								}
								AND = { 
									ROOT = { secret_religion = exovedate }
									NOR = {
										religion = exovedate
										has_province_modifier = secret_exovedate_community
									}
								}
								AND = { 
									ROOT = { secret_religion = pelagic }
									NOR = {
										religion = pelagic
										has_province_modifier = secret_pelagic_community
									}
								}
							}
						}
					}
				}
				event_target:society_leader = { character_event = { id = MNM.3900 } }
			}
			10 = { #Blend In
				trigger  = {
					any_courtier = {
						religion = ROOT
						shares_prevs_secret_religion_trigger = no
						NOT = { same_society_as = ROOT }   
						is_adult = yes
					}
				}
				modifier = {
					factor = 1.5
					check_variable = { which = visibility_value value = 10 }
				}
				modifier = {
					factor = 2
					check_variable = { which = visibility_value value = 20 }
				}
				event_target:society_leader = { character_event = { id = MNM.3397 } }
			}
			10 = { #Conduct Secret Ceremony
				trigger = {
					any_society_member = {
						same_society_as = ROOT
						ai = yes
						NOT = { character = ROOT }
						is_incapable = no
						prisoner = no
						in_command = no
						is_inaccessible_trigger = no
						is_within_diplo_range = ROOT
					}
				}
				event_target:society_leader = { character_event = { id = MNM.3233 } }
			}
			120 = { # AI bypasses missions at times
				modifier = {
					factor = 0
					ai = no
				}
				random_list = {
					70 = {
						modifier = {
							factor = 0.9
							society_influence >= 30
						}
						modifier = {
							factor = 0.9
							society_influence >= 40
						}
						modifier = {
							factor = 0.8
							society_influence >= 50
						}
						modifier = {
							factor = 0.7
							society_influence >= 70
						}
						modifier = {
							factor = 0.6
							society_influence >= 80
						}
						modifier = {
							factor = 0.5
							society_influence >= 90
						}
						add_mission_succeed_influence_effect = yes
						if = { # AI Members of Secret Religious Cults level up more often
							limit = {
								society_rank < 3
								society_can_rank_up = yes
							}
							random_list = {
								50 = {}
								50 = {
									society_rank_up = 1
								}
							}
						}
					}
					30 = {
						add_mission_fail_influence_effect = yes
					}
				}
			}
		}
	}
}


#Mission ping to leader
character_event = {
	id = MNM.3397
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3398 days = 7 random = 7 } } }
}


#QUEST: Blending In
society_quest_event = {
	id = MNM.3398
	border = GFX_event_letter_frame_religion

	desc = {
		trigger = { society_member_of = secret_religious_cult }
		text = EVTDESC_3398_BLEND_IN
	}

	is_triggered_only = yes
	
	trigger = {
		is_in_society = yes
	}

	option = {
		name = ACCEPT

		set_quest = quest_secret_religions_societies_blend_in
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#Blending In-mission start
character_event = {
	id = MNM.3399
	picture = GFX_evt_dark_prayer
	desc = EVTDESC_3399
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = {
			trigger = {
				society_member_of = secret_religious_cult
			}
			text = EVTOPTA_MNM_3399
		}

		hidden_effect = {
			set_variable = { which = blending_in_points value = 0 }
			set_character_flag = blending_in_timer
			character_event = { id = MNM.3200 days = 40 random = 30 } #Sends the tombola
		}
	}
}

# Mission: Blend in - outcome evaluator for blending in
character_event = {
	id = MNM.3200
	hide_window = yes

	is_triggered_only = yes

	trigger = { has_quest = quest_secret_religions_societies_blend_in }

	immediate = {
		if = {
			limit = { 
				has_character_modifier = attempting_to_blend_in
			}
			if = {
				limit = { 
					NOR = {
						check_variable = { which = blending_in_points value = 4 } 
						NOT = { check_variable = { which = blending_in_points value = -2 } }
					}
				}

				random_list = { # Next opportunity...
					10 = { # Convince a particular character (that doesn't exactly love you)
						modifier = {
							factor = 0
							NOT = {
								any_courtier = {
									host = { character = ROOT }
									religion = ROOT
									is_adult = yes
									prisoner = no
									NOT = {
										same_society_as = ROOT
									}
									opinion = { who = ROOT value = -50 }
									NOT = { opinion = { who = ROOT value = 10 } }
								}
							}
						}
						modifier = {
							factor = 0
							has_character_flag = attempting_to_convince_stubborn_courtier
						}
						random_courtier = {
							limit = {
								host = { character = ROOT }
								religion = ROOT
								is_adult = yes
								prisoner = no
								NOT = {
									same_society_as = ROOT
								}
								opinion = { who = ROOT value = -50 }
								NOT = { opinion = { who = ROOT value = 10 } }
							}
							save_event_target_as = stubborn_courtier
						}
						random_courtier = {
							limit = {
								host = { character = ROOT }
								religion = ROOT
								is_adult = yes
								prisoner = no
								NOT = {
									same_society_as = ROOT
								}
								opinion = { who = ROOT value = -50 }
								NOT = { opinion = { who = ROOT value = 10 } }
								has_pious_trait_trigger = yes
							}
							save_event_target_as = stubborn_courtier
						}
						set_character_flag = attempting_to_convince_stubborn_courtier
						event_target:stubborn_courtier = { character_event = { id = MNM.3201 } }
					}

					10 = { # Convince a particular character (that does care about you)
						modifier = {
							factor = 0
							NOT = {
								any_courtier = {
									host = { character = ROOT }
									religion = ROOT
									is_adult = yes
									prisoner = no
									NOT = {
										same_society_as = ROOT
									}
									opinion = { who = ROOT value = 50 }
								}
							}
						}
						modifier = {
							factor = 0
							has_character_flag = attempting_to_convince_concerned_friend
						}
						random_courtier = {
							limit = {
								host = { character = ROOT }
								religion = ROOT
								is_adult = yes
								prisoner = no
								NOT = {
									same_society_as = ROOT
								}
								opinion = { who = ROOT value = 50 }
							}
							save_event_target_as = concerned_friend
						}
						random_courtier = {
							limit = {
								host = { character = ROOT }
								religion = ROOT
								is_adult = yes
								prisoner = no
								OR = {
									is_friend = ROOT
									is_lover = ROOT
								}
								NOT = { same_society_as = ROOT }
								is_friend = ROOT
								opinion = { who = ROOT value = 100 }
							}
							save_event_target_as = concerned_friend
						}
						set_character_flag = attempting_to_convince_concerned_friend
						event_target:concerned_friend = { character_event = { id = MNM.3208 } }
					}
					30 = { # struggle with trait
						modifier = { 
							factor = 0 
							AND = {
								trait = paranoid
								trait = gregarious
								trait = deceitful
							}
						}
						modifier = {
							factor = 0
							NOT = {
								any_courtier = {
									religion = ROOT
									shares_prevs_secret_religion_trigger = no
									NOT = { same_society_as = ROOT }   
									is_adult = yes
									opinion = { who = ROOT value = 0 }
								}
							}
						}
						modifier = {
							factor = 0
							has_character_flag = blend_in_struggled_with_trait
						}

						random_courtier = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								is_adult = yes
								opinion = { who = ROOT value = 0 }
							}
							save_event_target_as = trusted_friend
						}
						random_courtier = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								is_adult = yes
								opinion = { who = ROOT value = 25 }
							}
							save_event_target_as = trusted_friend
						}
						random_courtier = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								is_adult = yes
								opinion = { who = ROOT value = 45 }
							}
							save_event_target_as = trusted_friend
						}
						random_courtier = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								is_adult = yes
								opinion = { who = ROOT value = 75 }
							}
							save_event_target_as = trusted_friend
						}
						random_spouse = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								is_adult = yes
								opinion = { who = ROOT value = 45 }
							}
							save_event_target_as = trusted_friend
						}
						random_lover = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								opinion = { who = ROOT value = 20 }
								is_adult = yes
							}
							save_event_target_as = trusted_friend
						}
						random_friend = {
							limit = {
								religion = ROOT
								shares_prevs_secret_religion_trigger = no
								NOT = { same_society_as = ROOT }
								is_adult = yes
							}
							save_event_target_as = trusted_friend
						}


						set_character_flag = blend_in_struggled_with_trait
						random_list = {
							10 = {
								modifier = { factor = 0 trait = paranoid }
								set_character_flag = blend_in_trusting
							}
							10 = { 
								modifier = { factor = 0 trait = gregarious }
								set_character_flag = blend_in_shy
							}
							10 = { 
								modifier = { factor = 0 trait = deceitful }
								set_character_flag = blend_in_honest
							}
						}

						character_event = { id = MNM.3220 } 
					}
					10 = { # Attend [Root.HouseOfWorship]
						
						modifier = {
							factor = 0
							has_character_flag = blend_in_attended_house_of_worship
						}
						set_character_flag = blend_in_attended_house_of_worship
						character_event = { id = MNM.3225 }
					}
					5 = { #General progress
						modifier = {
							intrigue = 15
							factor = 1.2
						}
						modifier = {
							trait = deceitful
							factor = 1.2
						}
						modifier = {
							is_learned_trigger = yes
							factor = 1.1
						}
						modifier = {
							is_dumb_trigger = yes
							factor = 0.1
						}
						modifier = {
							is_smart_trigger = yes
							factor = 1.2
						}
						set_character_flag = blend_in_general_progress
						character_event = { id = MNM.3230 }
					}

					10 = { #If all missions have been done already....
						modifier = {
							factor = 0 #Don't reset if the following is true
							OR = {
								#Don't reset if one of these flags are missing
								OR = {
									NOT = { has_character_flag = attempting_to_convince_stubborn_courtier }
									NOT = { has_character_flag = attempting_to_convince_concerned_friend }
									NOT = { has_character_flag = blend_in_attended_house_of_worship }
									NOT = { has_character_flag = blend_in_general_progress }
								}
								#We have the other flags, but need this special one and can get it
								AND = {
									NOT = { has_character_flag = blend_in_struggled_with_trait }
									NAND = {
										trait = paranoid
										trait = gregarious
										trait = deceitful
									}
									any_courtier = {
										religion = ROOT
										shares_prevs_secret_religion_trigger = no
										NOT = { same_society_as = ROOT }   
										is_adult = yes
										opinion = { who = ROOT value = 0 }
									}
								}

								#We have the other flags, but need this special one and can get it
								AND = {
									NOT = { has_character_flag = attempting_to_convince_stubborn_courtier } #other
									any_courtier = {
										host = { character = ROOT }
										religion = ROOT
										is_adult = yes
										prisoner = no
										NOT = {
											same_society_as = ROOT
										}
										opinion = { who = ROOT value = -50 }
										NOT = { opinion = { who = ROOT value = 10 } }
									}
								}

								#We have the other flags, but need this special one and can get it
								AND = {
									NOT = { has_character_flag = attempting_to_convince_concerned_friend } #other
									NOT = {
										any_courtier = {
											host = { character = ROOT }
											religion = ROOT
											is_adult = yes
											prisoner = no
											NOT = {
												same_society_as = ROOT
											}
											opinion = { who = ROOT value = 50 }
										}
									}
								}
							}
						}

						clr_character_flag = attempting_to_convince_stubborn_courtier
						clr_character_flag = attempting_to_convince_concerned_friend
						clr_character_flag = blend_in_struggled_with_trait
						clr_character_flag = blend_in_attended_house_of_worship
						clr_character_flag = blend_in_general_progress
					}
				}
				character_event = { id = MNM.3200 days = 40 random = 30 } #Sends the tombola again
			}
			if = {
				limit = { 
					OR = {
						check_variable = { which = blending_in_points value = 4 } 
						NOT = { check_variable = { which = blending_in_points value = -2 } }
					}
				} 

				random_society_member = {
					limit = {
						is_society_grandmaster = yes
						same_society_as = ROOT
					}
					character_event = { id = MNM.3250 } #Mission success/fail
				}
			}
		}
	}
}

## Opportunity 01 - The Stubborn Courtier
character_event = { # PING for stubborn courtier
	id = MNM.3201
	hide_window = yes
	is_triggered_only = yes
	immediate = { FROM = { character_event = { id = MNM.3202 } } }
}

character_event = { # Your stubborn courtier confronts you about your faith
	id = MNM.3202
	desc = EVTDESC_MNM_3202
	picture = GFX_evt_shady_meeting
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	#Quote their Holy Book at them - smaller chance to succeed, bigger pay-off, small penalty
	option = {
		name = EVTOPTA_MNM_3202

		random_list = {
			50 = {
				modifier = {
					factor = 1.5
					is_smart_trigger = yes
				}
				modifier = {
					factor = 1.5
					event_target:stubborn_courtier = {
						OR = {
							trait = trusting
							NOT = { trait = zealous }
						}
					}
				}
				modifier = {
					factor = 1.1
					learning = 15
				}
				custom_tooltip = { text = EVTOPTA_MNM_3202_TOOLTIP_SUCCESS }
				event_target:stubborn_courtier = { 
					set_character_flag = quoted_scripture_correctly
					hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
				}
			}
			50 = {
				modifier = {
					factor = 1.5
					event_target:stubborn_courtier = { is_dumb_trigger = yes }
				}
				modifier = {
					factor = 1.5
					event_target:stubborn_courtier = { trait = cynical }
				}
				custom_tooltip = { text = EVTOPTA_MNM_3202_TOOLTIP_FAILURE }
				event_target:stubborn_courtier = { 
					set_character_flag = quoted_scripture_poorly
					hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
				}
			}
		}
	}

	#Intimidate them - bigger chance to succeed, smaller pay-off, big penalty
	option = {
		name = EVTOPTB_MNM_3202

		random_list = {
			65 = {
				modifier = {
					is_benevolent_trigger = yes
					factor = 1.5
				}
				modifier = {
					has_pleasant_personality_trigger = yes
					factor = 1.5
				}
				custom_tooltip = { text = EVTOPTB_MNM_3202_TOOLTIP_SUCCESS }
				event_target:stubborn_courtier = { 
					set_character_flag = successful_intimidation
					hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
				}
			}
			35 = {
				modifier = {
					is_evil_trigger = yes
					factor = 1.5
				}
				modifier = {
					has_unpleasant_personality_trigger = yes
					factor = 1.5
				}
				custom_tooltip = { text = EVTOPTB_MNM_3202_TOOLTIP_FAILURE }
				event_target:stubborn_courtier = { 
					set_character_flag = failed_intimidation
					hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
				}
			}
		}
	}

	#Bribe
	option = {
		name = EVTOPTC_MNM_3202
		custom_tooltip = { text = EVTOPTC_MNM_3202_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

		wealth = -20

		random_list = {
			80 = { # They will not mention this again
				modifier = {
					factor = 1.5
					trait = greedy
				}
				reverse_opinion = {
					who = event_target:stubborn_courtier
					modifier = opinion_grateful
					years = 5
				}
			}
			20 = { # They are insulted
				modifier = {
					factor = 1.5
					trait = honest
				}
				modifier = {
					factor = 1.5
					is_pious_trigger = yes
				}
				reverse_opinion = {
					who = event_target:stubborn_courtier
					modifier = insulted
					years = 5
				}
			}
		}
	}
}

#Stubborn courtier ping event
character_event = {
	id = MNM.3203
	hide_window = yes
	is_triggered_only = yes
	immediate = { 
		trigger_switch = {
			on_trigger = has_character_flag 
			quoted_scripture_correctly   = { FROM = { long_character_event = { id = MNM.3204 } } clr_character_flag = quoted_scripture_correctly }
			quoted_scripture_poorly	  = { FROM = { long_character_event = { id = MNM.3205 } } clr_character_flag = quoted_scripture_poorly }
			successful_intimidation	  = { FROM = { long_character_event = { id = MNM.3206 } } clr_character_flag = successful_intimidation }
			failed_intimidation		  = { FROM = { long_character_event = { id = MNM.3207 } } clr_character_flag = failed_intimidation }
		}
	}
}

# You quoted scripture correctly
long_character_event = {
	id = MNM.3204
	desc = EVTDESC_MNM_3204
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_long_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3204
		custom_tooltip = { text = EVTOPTA_MNM_3204_TOOLTIP_SUCCESS }
		hidden_effect = { change_variable = { which = blending_in_points value = 2 } }

		event_target:stubborn_courtier = {
			add_trait_silently_humble_effect = yes
			remove_trait_proud_effect = yes
		}
		
		reverse_opinion = {
			who = event_target:stubborn_courtier
			modifier = opinion_impressed
			years = 10
		}
	}
}

# You quoted scripture poorly
long_character_event = {
	id = MNM.3205
	desc = EVTDESC_MNM_3205
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_long_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3205
		custom_tooltip = { text = EVTOPTA_MNM_3205_TOOLTIP_FAILURE }
		hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

		event_target:stubborn_courtier = {
			if = {
				limit = { NOT = { trait = zealous } }
				random = {
					chance = 15
					add_trait_zealous_effect = yes
				}
			}
		}
	}
}   

# Successful intimidation of stubborn courtier
long_character_event = {
	id = MNM.3206
	desc = EVTDESC_MNM_3206
	picture = "GFX_evt_secret_ceremony"
   border = GFX_event_long_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3206
		custom_tooltip = { text = EVTOPTC_MNM_3206_TOOLTIP_SUCCESS }
		hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
	}
}

# Failed intimidation of stubborn courtier
long_character_event = {
	id = MNM.3207
	desc = EVTDESC_MNM_3207
	picture = GFX_evt_secret_ceremony
	border = GFX_event_long_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3207
		custom_tooltip = { text = EVTOPTC_MNM_3207_TOOLTIP_FAILURE }
		hidden_effect = { change_variable = { which = blending_in_points value = -2 } }

		add_character_modifier = {
			name = embarrassed_believer
			years = 3
		}
		reverse_opinion = {
			who = event_target:stubborn_courtier
			modifier = opinion_unimpressed
			years = 5
		}
	}
}

## Opportunity 02 - The Concerned Friend
character_event = { # PING for concerned friend
	id = MNM.3208
	hide_window = yes
	is_triggered_only = yes
	immediate = { FROM = { character_event = { id = MNM.3209 } } }
}

character_event = { # Your concerned friend needs reassurance of your devoutness
	id = MNM.3209
	desc = EVTDESC_MNM_3209
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	#Tell them of bad dreams - smaller chance to succeed, bigger pay-off, small penalty
	option = {
		name = EVTOPTA_MNM_3209

		random_list = {
			50 = {
				modifier = {
					factor = 1.5
					is_smart_trigger = yes
				}
				modifier = {
					factor = 1.5
					event_target:concerned_friend = {
						OR = {
							trait = trusting
							NOT = { trait = zealous }
						}
					}
				}
				modifier = {
					factor = 1.1
					learning = 15
				}
				custom_tooltip = { text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS }
				event_target:concerned_friend = {
					set_character_flag = quoted_scripture_correctly
					hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
				}
			}
			50 = {
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { is_dumb_trigger = yes }
				}
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { trait = cynical }
				}
				custom_tooltip = { text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE }
				event_target:concerned_friend = { 
					set_character_flag = quoted_scripture_poorly
					hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
				}
			}
		}
	}

	#Say all is well - bigger chance to succeed, smaller pay-off, big penalty
	option = {
		name = EVTOPTB_MNM_3209

		random_list = {
			65 = {
				modifier = {
					is_benevolent_trigger = yes
					factor = 1.5
				}
				modifier = {
					has_pleasant_personality_trigger = yes
					factor = 1.5
				}
				custom_tooltip = { text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS }
				event_target:concerned_friend = { 
					set_character_flag = successful_intimidation
					hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
				}
			}
			35 = {
				modifier = {
					is_evil_trigger = yes
					factor = 1.5
				}
				modifier = {
					has_unpleasant_personality_trigger = yes
					factor = 1.5
				}
				custom_tooltip = { text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE }
				event_target:concerned_friend = { 
					set_character_flag = failed_intimidation
					hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
				}
			}
		}
	}

	#Distract them
	option = {
		name = EVTOPTC_MNM_3209
		custom_tooltip = { text = EVTOPTC_MNM_3209_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

		random_list = {
			50 = { # They are happily distracted
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { trait = trusting }
				}
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { trait = arbitrary }
				}
				reverse_opinion = {
					who = event_target:concerned_friend
					modifier = opinion_approves
					years = 5
				}
			}
			50 = { # They are confused
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { trait = cynical }
				}
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { is_lover = ROOT }
				}
				modifier = {
					factor = 1.5
					event_target:concerned_friend = { is_friend = ROOT }
				}
				reverse_opinion = {
					who = event_target:concerned_friend
					modifier = opinion_confused
					years = 5
				}
			}
		}
	}
}

#concerned friend ping event
character_event = {
	id = MNM.3210
	hide_window = yes
	is_triggered_only = yes
	immediate = { 
		trigger_switch = {
			on_trigger = has_character_flag 
			quoted_scripture_correctly   = { FROM = { character_event = { id = MNM.3211 } } clr_character_flag = quoted_scripture_correctly }
			quoted_scripture_poorly	  = { FROM = { character_event = { id = MNM.3212 } } clr_character_flag = quoted_scripture_poorly }
			successful_intimidation	  = { FROM = { character_event = { id = MNM.3213 } } clr_character_flag = successful_intimidation }
			failed_intimidation		  = { FROM = { character_event = { id = MNM.3214 } } clr_character_flag = failed_intimidation }
		}
	}
}

# You convinced them you have bad dreams
character_event = {
	id = MNM.3211
	desc = EVTDESC_MNM_3211
	picture = "GFX_evt_dark_prayer"
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3211 #They are a good friend
		custom_tooltip = { text = EVTOPTA_MNM_3211_TOOLTIP_SUCCESS }
		hidden_effect = { change_variable = { which = blending_in_points value = 2 } }

		if = {
			limit = {
				event_target:concerned_friend = {
					NOT = { is_friend = ROOT }
				}
			}
			add_friend = event_target:concerned_friend
		}
		reverse_opinion = {
			who = event_target:concerned_friend
			modifier = opinion_approves
			years = 5
		}
	}
}

# You spill your guts?
character_event = {
	id = MNM.3212
	desc = EVTDESC_MNM_3212
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3212
		custom_tooltip = { text = EVTOPTA_MNM_3212_TOOLTIP_FAILURE }
		hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

		reverse_opinion = {
			who = event_target:concerned_friend
			modifier = opinion_worried
			years = 5
		}
	}
}   

# Successfully dismissed concerned friend
character_event = {
	id = MNM.3213
	desc = EVTDESC_MNM_3213
	picture = "GFX_evt_state_diplomacy"
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3213
		custom_tooltip = { text = EVTOPTA_MNM_3213_TOOLTIP_SUCCESS }
		hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
	}
}

# Failed dismissing concerned friend
character_event = {
	id = MNM.3214
	desc = EVTDESC_MNM_3214
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3214
		custom_tooltip = { text = EVTOPTA_MNM_3214_TOOLTIP_FAILURE }
		hidden_effect = { change_variable = { which = blending_in_points value = -2 } }

		random = {
			chance = 20 
			add_trait_paranoid_effect = yes
		}

		reverse_opinion = {
			who = event_target:concerned_friend
			modifier = opinion_disappointed
			years = 5
		}
	}
}

## Opportunity 3
#Blend In: Dealing with trait
character_event = {
	id = MNM.3220
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_normal_frame_religion

	hide_from = yes

	desc = {
		trigger = { has_character_flag = blend_in_trusting }
		text = EVTDESC_3220_TRUSTING
	}
	desc = {
		trigger = { has_character_flag = blend_in_shy }
		text = EVTDESC_3220_SHY
	}
	desc = {
		trigger = { has_character_flag = blend_in_honest }
		text = EVTDESC_3220_HONEST
	}

	is_triggered_only = yes

	immediate = {

	}

	#Indulge (trusting or honest)
	option = {
		name = {
			trigger = { has_character_flag = blend_in_trusting }
			text = EVTOPTA_3220_TRUSTING
		}
		name = {
			trigger = { has_character_flag = blend_in_honest }
			text = EVTOPTA_3220_HONEST
		}

		random_list = {
			65 = { 
				custom_tooltip = { 
					text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS
					character_event = { id = MNM.3221 days = 3 }
				}
			}
			35 = {
				custom_tooltip = { 
					text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE
					character_event = { id = MNM.3222 days = 3 }
				}
			}
		}
		#To show portrait in option
		if = { limit = { has_character_flag = blend_in_trusting }
			event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
		}
		if = { limit = { has_character_flag = blend_in_honest } 
			event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
		}
		trigger = {
			OR = {
				has_character_flag = blend_in_trusting
				has_character_flag = blend_in_honest
			}
		}
	}

	#Indulge (shy)
	option = {
		name = EVTOPTA_3220_SHY

		random_list = {
			65 = { 
				custom_tooltip = { 
					text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS
					character_event = { id = MNM.3221 days = 3 }
				}
			}
			35 = {
				custom_tooltip = { 
					text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE
					character_event = { id = MNM.3222 days = 3 }
				}
			}
		}
		trigger = { has_character_flag = blend_in_shy }
	}


	#Fight it (trusting or honest)
	option = {
		name = {
			trigger = { has_character_flag = blend_in_trusting }
			text = EVTOPTB_3220_TRUSTING
		}
		name = {
			trigger = { has_character_flag = blend_in_honest }
			text = EVTOPTB_3220_HONEST
		}

		random_list = {
			40 = { 
				custom_tooltip = { 
					text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS
					character_event = { id = MNM.3223 days = 14 }
				}
			}
			60 = {
				custom_tooltip = { 
					text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE
					character_event = { id = MNM.3224 days = 14 }
				}
			}
		}
		#To show portrait in option
		if = { limit = { has_character_flag = blend_in_trusting }
			event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
		}
		if = { limit = { has_character_flag = blend_in_honest }
			event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
		}

		trigger = {
			OR = {
				has_character_flag = blend_in_trusting
				has_character_flag = blend_in_honest
			}
		}
	}
	
	#Fight it (shy)
	option = {
		name = EVTOPTB_3220_SHY

		random_list = {
			40 = { 
				custom_tooltip = { 
					text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS
					character_event = { id = MNM.3223 days = 14 }
				}
			}
			60 = {
				custom_tooltip = { 
					text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE
					character_event = { id = MNM.3224 days = 14 }
				}
			}
		}

		trigger = {
			has_character_flag = blend_in_shy
		}
	}

	after = {
		if = { limit = { event_target:trusted_friend = { has_character_flag = tooltip_flag_1 } } 
			event_target:trusted_friend = { clr_character_flag = tooltip_flag_1 }
		}
	}
}

#Trait outcome - small success
character_event = {
	id = MNM.3221
	picture = "GFX_evt_state_diplomacy"
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { has_character_flag = blend_in_trusting }
		text = EVTDESC_3221_TRUSTING
	}
	desc = {
		trigger = { has_character_flag = blend_in_shy }
		text = EVTDESC_3221_SHY
	}
	desc = {
		trigger = { has_character_flag = blend_in_honest }
		text = EVTDESC_3221_HONEST
	}

	is_triggered_only = yes
	hide_from = yes

	option = {
		name = {
			trigger = { has_character_flag = blend_in_trusting }
			text = EVTOPTA_3221_TRUSTING
		}
		name = {
			trigger = { has_character_flag = blend_in_shy }
			text = EVTOPTA_3221_SHY
		}
		name = {
			trigger = { has_character_flag = blend_in_honest }
			text = EVTOPTA_3221_HONEST
		}

		custom_tooltip = { 
			text = EVTOPTA_3221_TOOLTIP 
		}

		hidden_effect = { change_variable = { which = blending_in_points value = 1 } }

		hidden_effect = {
			clr_character_flag = blend_in_trusting
			clr_character_flag = blend_in_shy
			clr_character_flag = blend_in_honest
		}
	}
}

# Trait outcome - small failure
character_event = {
	id = MNM.3222
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { has_character_flag = blend_in_trusting }
		text = EVTDESC_3222_TRUSTING
	}
	desc = {
		trigger = { has_character_flag = blend_in_shy }
		text = EVTDESC_3222_SHY
	}
	desc = {
		trigger = { has_character_flag = blend_in_honest }
		text = EVTDESC_3222_HONEST
	}

	is_triggered_only = yes
	hide_from = yes

	immediate = {

	}

	option = {
		name = {
			trigger = { has_character_flag = blend_in_trusting }
			text = EVTOPTA_3222_TRUSTING
		}
		name = {
			trigger = { has_character_flag = blend_in_shy }
			text = EVTOPTA_3222_SHY
		}
		name = {
			trigger = { has_character_flag = blend_in_honest }
			text = EVTOPTA_3222_HONEST
		}

		custom_tooltip = { 
			text = EVTOPTA_3222_TOOLTIP 
		}

		hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

		hidden_effect = {
			clr_character_flag = blend_in_trusting
			clr_character_flag = blend_in_shy
			clr_character_flag = blend_in_honest
		}
	}
}

# Trait outcome big success
character_event = {
	id = MNM.3223
	picture = "GFX_evt_state_diplomacy"
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { has_character_flag = blend_in_trusting }
		text = EVTDESC_3223_TRUSTING
	}
	desc = {
		trigger = { has_character_flag = blend_in_shy }
		text = EVTDESC_3223_SHY
	}
	desc = {
		trigger = { has_character_flag = blend_in_honest }
		text = EVTDESC_3223_HONEST
	}

	is_triggered_only = yes
	#hide_from = yes

	option = {
		name = {
			trigger = { has_character_flag = blend_in_trusting }
			text = EVTOPTA_3223_TRUSTING
		}
		name = {
			trigger = { has_character_flag = blend_in_shy }
			text = EVTOPTA_3223_SHY
		}
		name = {
			trigger = { has_character_flag = blend_in_honest }
			text = EVTOPTA_3223_HONEST
		}

		custom_tooltip = { 
			text = EVTOPTA_3223_TOOLTIP 
		}

		hidden_effect = { change_variable = { which = blending_in_points value = 2 } }
		
		if = {
			limit = { has_character_flag = blend_in_trusting }
			if = {
				limit = { trait = trusting }
				random = {
					chance = 50
					remove_trait_trusting_effect = yes
				}
			}
		}

		if = {
			limit = { has_character_flag = blend_in_shy }
			if = {
				limit = { NOT = { trait = shy } }
				random = {
					chance = 50
					add_trait_gregarious_effect = yes
				}
			}
			if = {
				limit = { trait = shy }
				random = {
					chance = 50
					remove_trait_shy_effect = yes
				}
			}
		}
		if = {
			limit = { has_character_flag = blend_in_honest }

			if = {
				limit = { NOT = { trait = honest } }
				random = {
					chance = 50
					add_trait_deceitful_effect = yes
				}
			}
			if = {
				limit = { trait = honest }
				random = {
					chance = 50
					remove_trait_honest_effect = yes
				}
			}
		}
		add_character_modifier = {
			name = great_believer
			years = 3
		}

		hidden_effect = {
			clr_character_flag = blend_in_trusting
			clr_character_flag = blend_in_shy
			clr_character_flag = blend_in_honest
		}
	}
}

# Trait outcome - big failure
character_event = {
	id = MNM.3224
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { has_character_flag = blend_in_trusting }
		text = EVTDESC_3224_TRUSTING
		picture = GFX_evt_brothel
	}
	desc = {
		trigger = { has_character_flag = blend_in_shy }
		text = EVTDESC_3224_SHY
	}
	desc = {
		trigger = { has_character_flag = blend_in_honest }
		text = EVTDESC_3224_HONEST
	}

	is_triggered_only = yes
	#hide_from = yes

	option = {
		name = {
			trigger = { has_character_flag = blend_in_trusting }
			text = EVTOPTA_3224_TRUSTING
		}
		name = {
			trigger = { has_character_flag = blend_in_shy }
			text = EVTOPTA_3224_SHY
		}
		name = {
			trigger = { has_character_flag = blend_in_honest }
			text = EVTOPTA_3224_HONEST
		}

		custom_tooltip = { 
			text = EVTOPTA_3224_TOOLTIP
		}

		hidden_effect = { change_variable = { which = blending_in_points value = -5 } }
		
		if = {
			limit = { has_character_flag = blend_in_trusting }
			if = {
				limit = { NOT = { trait = trusting } }
				random = {
					chance = 30
					add_trait_trusting_effect = yes
				}
			}
		}

		if = {
			limit = { has_character_flag = blend_in_shy }
			if = {
				limit = { NOT = { trait = shy } }
				random = {
					chance = 30
					add_trait_shy_effect = yes
				}
			}
		}

		if = {
			limit = { has_character_flag = blend_in_honest }
			if = {
				limit = { NOT = { trait = honest } }
				random = {
					chance = 30
					add_trait_honest_effect = yes
				}
			}
		}

		add_character_modifier = {
			name = awkward_believer
			years = 3
		}

		hidden_effect = {
			clr_character_flag = blend_in_trusting
			clr_character_flag = blend_in_shy
			clr_character_flag = blend_in_honest
		}
	}
}

# Religion specific visiting of house of worship
character_event = {
	id = MNM.3225
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	hide_from = yes

	desc = {
		trigger = {
			OR = {
				religion_group = christian
				religion_group = cult_of_saints			 
				religion_group = latter_day_saints
				religion_group = amero_syncretic
			}
		}
		text = EVTDESC_MNM_3225_A
	}
	desc = {
		trigger = { religion_group = jewish_group }
		text = EVTDESC_MNM_3225_A
	}
	desc = {
		trigger = { religion_group = oldworld }
		text = EVTDESC_MNM_3225_E
	}
	desc = {
		trigger = { religion = hindu }
		text = EVTDESC_MNM_3225_G
	}
	desc = {
		trigger = { religion_group = pacific }
		text = EVTDESC_MNM_3225_H
	}
	desc = {
		trigger = {
			OR = {
				religion = norse_pagan_reformed
				religion = norse_pagan
			}
		}
		text = EVTDESC_MNM_3225_J
	}
	desc = {
		trigger = {
			OR = {
				religion = revelationist_reformed
				religion = revelationist
			}
		}
		text = EVTDESC_MNM_3225_J
	}
	desc = {
		trigger = {
			OR = {
				religion = chrome_cultist
				religion = rust_cultist
			}
		}
		text = EVTDESC_MNM_3225_X
	}
	desc = {
		trigger = {
			OR = {
				religion = occultist_reformed
				religion = occultist
			}
		}
		text = EVTDESC_MNM_3225_J
	}
	desc = {
		trigger = {
			OR = {
				religion = thelemic_reformed
				religion = thelemic
			}
		}
		text = EVTDESC_MNM_3225_J
	}
	desc = {
		trigger = {
			religion_group = american_native
		}
		text = EVTDESC_MNM_3225_N
	}
	desc = {
		trigger = {
			religion_group = afro_syncretic
		}
		text = EVTDESC_MNM_3225_O
	}
	desc = {
		trigger = {
			OR = {
				religion_group = mesoamerican_gods
				religion_group = pirate
				religion = pagan
			}
		}
		text = EVTDESC_MNM_3225_P
	}
	desc = {
		trigger = {
			religion_openly_in_celtic_subgroup_trigger = yes
		}
		text = mnm.3225.ancrel
	}

	option = {	  
		name = EVTOPTB_MNM_3225
		random_list = {
			50 = { #good outcome (big)
				modifier = {
					factor = 0
					trait = imbecile
				}
				modifier = {
					factor = 1.1
					diplomacy = 15
				}
				modifier = {
					factor = 1.1
					diplomacy = 16
				}
				modifier = {
					factor = 1.1
					diplomacy = 17
				}
				modifier = {
					factor = 1.1
					diplomacy = 18
				}
				modifier = {
					factor = 1.1
					diplomacy = 19
				}
				modifier = {
					factor = 1.1
					diplomacy = 20
				}
				modifier = {
					factor = 1.1
					diplomacy = 21
				}
				modifier = {
					factor = 1.1
					diplomacy = 22
				}
				modifier = {
					factor = 1.1
					trait = deceitful
				}
				modifier = {
					factor = 1.1
					trait = gregarious
				}
				modifier = {
					factor = 1.1
					trait = zealous
				}
				modifier = {
					factor = 1.1
					trait = cynical
				}
				custom_tooltip = {
					text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS
					long_character_event = { id = MNM.3228 } 
				}
			}
			50 = { #bad outcome (big)
				modifier = {
					factor = 0
					trait = genius
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 10 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 9 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 8 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 7 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 6 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 5 }
				}
				modifier = {
					factor = 1.2
					NOT = { diplomacy = 4 }
				}
				modifier = {
					factor = 1.3
					NOT = { diplomacy = 3 }
				}
				modifier = {
					factor = 1.4
					NOT = { diplomacy = 2 }
				}
				modifier = {
					factor = 1.5
					NOT = { diplomacy = 1 }
				}
				modifier = {
					factor = 1.1
					trait = shy
				}
				modifier = {
					factor = 1.1
					trait = content
				}
				custom_tooltip = {
					text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE
					long_character_event = { id = MNM.3229 } 
				}
			}
		}
	}
	option = {	  
		name = EVTOPTA_MNM_3225

		#add negative effect, trait or loss of something

		random_list = {
			70 = { #good outcome (small)
				modifier = {
					factor = 0
					trait = imbecile
				}
				modifier = {
					factor = 1.1
					diplomacy = 15
				}
				modifier = {
					factor = 1.1
					diplomacy = 16
				}
				modifier = {
					factor = 1.1
					diplomacy = 17
				}
				modifier = {
					factor = 1.1
					diplomacy = 18
				}
				modifier = {
					factor = 1.1
					diplomacy = 19
				}
				modifier = {
					factor = 1.1
					diplomacy = 20
				}
				modifier = {
					factor = 1.1
					diplomacy = 21
				}
				modifier = {
					factor = 1.1
					diplomacy = 22
				}
				modifier = {
					factor = 1.1
					trait = deceitful
				}
				modifier = {
					factor = 1.1
					trait = gregarious
				}
				modifier = {
					factor = 1.1
					trait = zealous
				}
				modifier = {
					factor = 1.1
					trait = cynical
				}
				custom_tooltip = {
					text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS
					long_character_event = { id = MNM.3226 }
				}
			}
			30 = { #bad outcome (small)
				modifier = {
					factor = 0
					trait = genius
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 10 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 9 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 8 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 7 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 6 }
				}
				modifier = {
					factor = 1.1
					NOT = { diplomacy = 5 }
				}
				modifier = {
					factor = 1.2
					NOT = { diplomacy = 4 }
				}
				modifier = {
					factor = 1.3
					NOT = { diplomacy = 3 }
				}
				modifier = {
					factor = 1.4
					NOT = { diplomacy = 2 }
				}
				modifier = {
					factor = 1.5
					NOT = { diplomacy = 1 }
				}
				modifier = {
					factor = 1.1
					trait = shy
				}
				modifier = {
					factor = 1.1
					trait = content
				}
				custom_tooltip = {
					text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE
					long_character_event = { id = MNM.3227 } 
				}
			}
		}
	}
}

long_character_event = { #Outcome 1 (small gain)
	id = MNM.3226
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_long_frame_religion
	is_triggered_only = yes

	desc = {
		trigger = {
			OR = {
				religion_group = christian
				religion_group = cult_of_saints
				religion_group = latter_day_saints
				religion_group = amero_syncretic
				religion = pagan
			}
		}
		text = EVTDESC_MNM_3226_A
	}
	desc = {
		trigger = { religion_group = jewish_group }
		text = EVTDESC_MNM_3226_A
	}
	desc = {
		trigger = { religion_group = oldworld }
		text = EVTDESC_MNM_3226_E
	}
	desc = {
		trigger = { religion = hindu }
		text = EVTDESC_MNM_3226_G
	}
	desc = {
		trigger = { religion_group = pacific }
		text = EVTDESC_MNM_3226_H
	}
	desc = {
		trigger = {
			OR = {
				religion = norse_pagan_reformed
				religion = norse_pagan
			}
		}
		text = EVTDESC_MNM_3226_J
	}
	desc = {
		trigger = {
			OR = {
				religion = revelationist_reformed
				religion = revelationist
			}
		}
		text = EVTDESC_MNM_3226_G
	}
	desc = {
		trigger = {
			OR = {
				religion = rust_cultist
				religion = chrome_cultist
			}
		}
		text = EVTDESC_MNM_3226_X
	}
	desc = {
		trigger = {
			OR = {
				religion = occultist_reformed
				religion = occultist
			}
		}
		text = EVTDESC_MNM_3226_G
	}
	desc = {
		trigger = {
			religion_group = american_native
		}
		text = EVTDESC_MNM_3226_N
	}
	desc = {
		trigger = {
			religion_group = afro_syncretic
		}
		text = EVTDESC_MNM_3226_O
	}
	desc = {
		trigger = {
			OR = {
				religion_group = mesoamerican_gods
				religion_group = pirate
			}
		}
		text = EVTDESC_MNM_3226_P
	}
	desc = {
		trigger = {
			religion_openly_in_celtic_subgroup_trigger = yes
		}
		text = mnm.3226.ancrel
	}

	hide_from = yes

	option = {	  
		name = EVTOPTA_MNM_3226
		custom_tooltip = { text = EVTOPTA_3221_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
	}
}

long_character_event = { #Outcome 2 (small loss)
	id = MNM.3227
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_long_frame_religion
	is_triggered_only = yes

	desc = {
		trigger = {
			OR = {
				religion_group = christian
				religion_group = cult_of_saints
				religion_group = latter_day_saints
				religion_group = amero_syncretic
			}
		}
		text = EVTDESC_MNM_3227_A
	}
	desc = {
		trigger = { religion_group = jewish_group }
		text = EVTDESC_MNM_3227_A
	}
	desc = {
		trigger = { religion_group = oldworld }
		text = EVTDESC_MNM_3227_E
	}
	desc = {
		trigger = { religion = hindu }
		text = EVTDESC_MNM_3227_G
	}
	desc = {
		trigger = { religion_group = pacific }
		text = EVTDESC_MNM_3227_G
	}
	desc = {
		trigger = {
			OR = {
				religion = norse_pagan_reformed
				religion = norse_pagan
			}
		}
		text = EVTDESC_MNM_3227_J
	}
	desc = {
		trigger = {
			OR = {
				religion = rust_cultist
				religion = chrome_cultist
			}
		}
		text = EVTDESC_MNM_3227_X
	}
	desc = {
		trigger = {
			OR = {
				religion = revelationist_reformed
				religion = revelationist
			}
		}
		text = EVTDESC_MNM_3227_J
	}
	desc = {
		trigger = {
			OR = {
				religion = occultist_reformed
				religion = occultist
			}
		}
		text = EVTDESC_MNM_3227_J
	}
	desc = {
		trigger = {
			OR = {
				religion = thelemic_reformed
				religion = thelemic
			}
		}
		text = EVTDESC_MNM_3227_J
	}
	desc = {
		trigger = {
			religion_group = american_native
		}
		text = EVTDESC_MNM_3227_N
	}
	desc = {
		trigger = {
			religion_group = afro_syncretic
		}
		text = EVTDESC_MNM_3227_O
	}
	desc = {
		trigger = {
			OR = {
				religion_group = mesoamerican_gods
				religion_group = pirate
				religion = pagan
			}
		}
		text = EVTDESC_MNM_3227_P
	}
	desc = {
		trigger = {
			religion_openly_in_celtic_subgroup_trigger = yes
		}
		text = mnm.ancrel.3227
	}


	hide_from = yes

	option = {
		name = EVTOPTA_MNM_3227
		custom_tooltip = { text = EVTOPTA_3222_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = -1 } }
	}
}


long_character_event = { #Outcome 3 (big gain)
	id = MNM.3228
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_long_frame_religion
	is_triggered_only = yes

	desc = {
		trigger = {
			OR = {
				religion_group = christian
				religion_group = cult_of_saints			 
				religion_group = latter_day_saints
				religion_group = amero_syncretic
			}
		}
		text = EVTDESC_MNM_3228_A
	}
	desc = {
		trigger = { religion_group = jewish_group }
		text = EVTDESC_MNM_3228_A
	}
	desc = {
		trigger = { religion_group = oldworld }
		text = EVTDESC_MNM_3228_A
	}
	desc = {
		trigger = { religion = hindu }
		text = EVTDESC_MNM_3228_G
	}
	desc = {
		trigger = { religion_group = pacific }
		text = EVTDESC_MNM_3228_H
	}
	desc = {
		trigger = {
			OR = {
				religion = norse_pagan_reformed
				religion = norse_pagan
			}
		}
		text = EVTDESC_MNM_3228_H
	}
	desc = {
		trigger = {
			OR = {
				religion = revelationist_reformed
				religion = revelationist
			}
		}
		text = EVTDESC_MNM_3228_H
	}
	desc = {
		trigger = {
			OR = {
				religion = rust_cultist
				religion = chrome_cultist
			}
		}
		text = EVTDESC_MNM_3228_X
	}
	desc = {
		trigger = {
			OR = {
				religion = occultist_reformed
				religion = occultist
			}
		}
		text = EVTDESC_MNM_3228_H
	}
	desc = {
		trigger = {
			OR = {
				religion = thelemic_reformed
				religion = thelemic
			}
		}
		text = EVTDESC_MNM_3228_H
	}
	desc = {
		trigger = {
			religion_group = american_native
		}
		text = EVTDESC_MNM_3228_H
	}
	desc = {
		trigger = {
			religion_group = afro_syncretic
		}
		text = EVTDESC_MNM_3228_O
	}
	desc = {
		trigger = {
			OR = {
				religion_group = mesoamerican_gods
				religion_group = pirate
				religion = pagan
			}
		}
		text = EVTDESC_MNM_3228_O
	}
	desc = {
		trigger = {
			OR = {
				religion_openly_in_celtic_subgroup_trigger = yes
			}
		}
		text = mnm.3228.ancrel
	}


	hide_from = yes

	option = {	  
		name = EVTOPTA_MNM_3228
		custom_tooltip = { text = EVTOPTA_3223_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = 2 } }
	}
}

long_character_event = { #Outcome 4 (big loss)
	id = MNM.3229
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_long_frame_religion
	is_triggered_only = yes

	desc = {
		trigger = {
			OR = {
				religion_group = christian
				religion_group = cult_of_saints			 
				religion_group = latter_day_saints
				religion_group = amero_syncretic
			}
		}
		text = EVTDESC_MNM_3229_A
	}
	desc = {
		trigger = { religion_group = jewish_group }
		text = EVTDESC_MNM_3229_C
	}
	desc = {
		trigger = { religion_group = oldworld }
		text = EVTDESC_MNM_3229_D
	}
	desc = {
		trigger = { religion = hindu }
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = { religion_group = pacific }
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			OR = {
				religion = norse_pagan_reformed
				religion = norse_pagan
			}
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			OR = {
				religion = revelationist_reformed
				religion = revelationist
			}
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			OR = {
				religion = rust_cultist
				religion = chrome_cultist
			}
		}
		text = EVTDESC_MNM_3229_X
	}
	desc = {
		trigger = {
			OR = {
				religion = occultist_reformed
				religion = occultist
			}
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			OR = {
				religion = thelemic_reformed
				religion = thelemic
			}
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			religion_group = american_native
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			religion_group = afro_syncretic
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			OR = {
				religion = mesoamerican_gods
				religion = pirate
				religion = pagan
			}
		}
		text = EVTDESC_MNM_3229_G
	}
	desc = {
		trigger = {
			religion_openly_in_celtic_subgroup_trigger = yes
		}
		text = mnm.3229.ancrel
	}


	hide_from = yes

	option = {	  
		name = EVTOPTA_MNM_3229
		custom_tooltip = { text = EVTOPTA_3224_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = -2 } }
	}
}


character_event = { #Generic progress (small)
	id = MNM.3230
	picture = "GFX_evt_dark_prayer"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	desc = {
		trigger = { has_character_flag = desc_flag_A }
		text = EVTDESC_MNM_3230_A
	}
	desc = {
		trigger = { has_character_flag = desc_flag_B }
		text = EVTDESC_MNM_3230_B
	}
	desc = {
		trigger = { has_character_flag = desc_flag_C }
		text = EVTDESC_MNM_3230_C
	}
	desc = {
		trigger = { has_character_flag = desc_flag_D }
		text = EVTDESC_MNM_3230_D
	}
	desc = {
		trigger = { has_character_flag = desc_flag_E }
		text = EVTDESC_MNM_3230_E
	}
	desc = {
		trigger = { has_character_flag = desc_flag_F }
		text = EVTDESC_MNM_3230_F
	}

	immediate = {
		random_list = {
			10 = {
				modifier = {
					factor = 0
					has_character_flag = desc_flag_A
				}
				modifier = {
					factor = 0
					NOT = {
						any_courtier = {
							has_job_title = job_spiritual
						}
					}
				}
				set_character_flag = desc_flag_A
			}
			10 = {
				modifier = {
					factor = 0
					has_character_flag = desc_flag_B
				}
				modifier = {
					factor = 0
					NOT = {
						any_courtier = {
							has_job_title = job_spiritual
						}
					}
				}
				set_character_flag = desc_flag_B
			}
			10 = {
				modifier = {
					factor = 0
					has_character_flag = desc_flag_C
				}
				set_character_flag = desc_flag_C
			}
			10 = {
				modifier = {
					factor = 0
					has_character_flag = desc_flag_D
				}
				set_character_flag = desc_flag_D
			}
			10 = {
				modifier = {
					factor = 0
					has_character_flag = desc_flag_E
				}
				set_character_flag = desc_flag_E
			}
			10 = {
				modifier = {
					factor = 0
					has_character_flag = desc_flag_F
				}
				set_character_flag = desc_flag_F
			}
		}
	}

	hide_from = yes

	option = {	  
		name = {
			trigger = { has_character_flag = desc_flag_C }
			text = EVTOPTA_MNM_3230_C
		}
		name = {
			trigger = { has_character_flag = desc_flag_D }
			text = EVTOPTA_MNM_3230_D
		}
		name = {
			trigger = { has_character_flag = desc_flag_E }
			text = EVTOPTA_MNM_3230_E
		}
		name = {
			trigger = { has_character_flag = desc_flag_F }
			text = EVTOPTA_MNM_3230_F
		}
		
		trigger = {
			NOR = {
				has_character_flag = desc_flag_A
				has_character_flag = desc_flag_B
			}
		}
	}

	option = { #gives opinion boost with court chaplain (desc A + B only)
		name = {
			trigger = { has_character_flag = desc_flag_A }
			text = EVTOPTA_MNM_3230_A
		}

		name = {
			trigger = { has_character_flag = desc_flag_B }
			text = EVTOPTA_MNM_3230_B
		}

		if = {
			limit = {
				OR = {
					has_character_flag = desc_flag_B
					has_character_flag = desc_flag_A
				}
			}
			random_courtier = {
				limit = { has_job_title = job_spiritual }
				save_event_target_as = court_spiritual
			}

			reverse_opinion =  {
				who = event_target:court_spiritual
				modifier = opinion_approves
				years = 5
			}
		}

		trigger = {
			OR = {
				has_character_flag = desc_flag_B
				has_character_flag = desc_flag_A
			}
		}
	}

	after = {
		custom_tooltip = { text = EVTOPTA_3221_TOOLTIP }
		hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
		clr_character_flag = desc_flag_A
		clr_character_flag = desc_flag_B
		clr_character_flag = desc_flag_C
		clr_character_flag = desc_flag_D
		clr_character_flag = desc_flag_E
		clr_character_flag = desc_flag_F
	}
}

#Fail/success evaluation for Blend In-mission
character_event = {
	id = MNM.3250
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { FROM = { check_variable = { which = blending_in_points value = 4 } } }
			FROM = { letter_event = { id = MNM.3251 } } # successful mission
		}
		if = {
			limit = { FROM = { NOT = { check_variable = { which = blending_in_points value = -2 } } } }
			FROM = { letter_event = { id = MNM.3252 } } # mission failed
		}
		clr_character_flag = attempting_to_convince_stubborn_courtier
		clr_character_flag = attempting_to_convince_concerned_friend
		clr_character_flag = blend_in_struggled_with_trait
	}
}

#Blend In-mission success
letter_event = {
	id = MNM.3251
	border = GFX_event_letter_frame_religion
	desc = EVTDESC_MNM_3251

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3251

		if = {
			limit = { has_quest = quest_secret_religions_societies_blend_in }
			clr_quest = quest_secret_religions_societies_blend_in
			sound_effect = secret_cults_blend_in
			remove_character_modifier = attempting_to_blend_in
			clr_character_flag = blending_in_timer
		}
		add_society_currency_medium_effect = yes
		decrease_visibility_effect = yes
	}
}

#Blend In-mission failure
letter_event = {
	id = MNM.3252
	border = GFX_event_letter_frame_religion
	desc = EVTDESC_MNM_3252

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3252

		if = {
			limit = { has_quest = quest_secret_religions_societies_blend_in }
			clr_quest = { id = quest_secret_religions_societies_blend_in failure = yes }
			remove_character_modifier = attempting_to_blend_in
			clr_character_flag = blending_in_timer
		}
	}
}

###Mission ping to leader (Secret Ceremony)###
character_event = {
	id = MNM.3233
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3234 days = 7 random = 7 } } }
}

#QUEST: Conduct Secret Ceremony
society_quest_event = {
	id = MNM.3234
	border = GFX_event_letter_frame_religion

	desc = {
		trigger = { society_member_of = secret_religious_cult }
		text = EVTDESC_3398_CONDUCT_SECRET_CEREMONY
	}

	is_triggered_only = yes
	
	trigger = {
		is_in_society = yes
	}

	option = {
		name = ACCEPT
		set_quest = quest_secret_religions_conduct_secret_ceremony
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

### MISSION: Conduct Secret Ceremony to your Secret God(s)
# -- Hidden Start --
character_event = {
	id = MNM.3235
	hide_window = yes
	
	is_triggered_only = yes
	   
	immediate = {
		# First look for someone at court
		society = {
			random_society_member = {
				limit = {
					ai = yes
					is_incapable = no
					prisoner = no
					in_command = no
					is_inaccessible_trigger = no
					NOT = { character = ROOT }
					host = { character = ROOT }
				}
				character_event = { id = MNM.3236 }
				break = yes
			}
			
			# Then look for someone in the same realm
			random_society_member = {
				limit = {
					ai = yes
					is_incapable = no
					prisoner = no
					in_command = no
					is_inaccessible_trigger = no
					NOT = { character = ROOT }
					same_realm = ROOT
				}
				character_event = { id = MNM.3236 }
				break = yes
			}
			
			# Then look abroad...
			random_society_member = {
				limit = {
					ai = yes
					is_incapable = no
					prisoner = no
					in_command = no
					is_inaccessible_trigger = no
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
				}
				character_event = { id = MNM.3236 }
				break = yes
			}
		}
	}
}

# Ping for other member
character_event = {
	id = MNM.3236
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = fellow_member

		set_quest_target = {
			id = quest_secret_religions_conduct_secret_ceremony
			holder = FROM
		}

		FROM = { character_event = { id = MNM.3237 } }
	}
}

# Conduct secret ceremony - Fellow member approaches you
character_event = {
	id = MNM.3237
	picture = GFX_evt_dark_prayer
	border = GFX_event_normal_frame_diplomacy
	
	desc = {
		text = EVTDESC_MNM_3237
		trigger = {
			FROM = {
				NOT = { host = { character = ROOT } }
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_3237_COURT
		trigger = {
			FROM = {
				host = { character = ROOT }
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_3237 # Can't wait
		custom_tooltip = {
			text = EVTOPTA_MNM_3237_TT
		}
		hidden_effect = { FROM = { character_event = { id = MNM.3238 days = 15 random = 10 } } }
	}

	option = {
		name = EVTOPTB_MNM_3237 # I changed my mind
		ai_chance = { factor = 0 }
		
		detract_society_currency_minor_effect = yes
		reverse_opinion = { who = FROM modifier = opinion_unimpressed years = 5 }
	}
}

# PING/GATING for other char
character_event = { #what is with these triggers?
	id = MNM.3238
	hide_window = yes
	
	trigger = {
		FROM = {
			has_quest = quest_secret_religions_conduct_secret_ceremony
		}
	}

	is_triggered_only = yes

	trigger = {
		is_alive = yes
	}
	
	immediate = {
		FROM = { character_event = { id = MNM.3239 } }
	}
}

# The Secret Ceremony - Result
character_event = {
	id = MNM.3239
	picture = "GFX_evt_secret_ceremony"
	border = GFX_event_normal_frame_diplomacy
	
	trigger = { has_quest = quest_secret_religions_conduct_secret_ceremony }

	is_triggered_only = yes
	
	immediate = {
		random_list = {
			5 = { # Random courtier accidentally discovers you and fellow member kills them (by accident?)
				modifier = {
					factor = 0
					# zero chance of happening if there is no potential threath within your court...
					NOT = {
						any_courtier = {
							NOR = {
								character = ROOT
								character = FROM
								is_married = ROOT
								is_close_relative = ROOT
							}
							is_adult = yes
							prisoner = no
							is_ruler = no
							shares_prevs_secret_religion_trigger = no
							NOT = { same_society_as = ROOT }	
						}
					}
				}
				hidden_effect = {
					random_courtier = { #find a potential threath, who stumbles in on your ceremony...
						limit = {
							NOR = {
								character = ROOT
								character = FROM
								is_married = ROOT
								is_close_relative = ROOT
							}
							is_adult = yes
							prisoner = no
							is_ruler = no
							shares_prevs_secret_religion_trigger = no
							NOT = { same_society_as = ROOT }
						}
						save_event_target_as = unfortunate_interrupter
						death = { death_reason = death_murder_unknown killer = ROOT }
					}
				}
				set_character_flag = feel_different_negative
				set_character_flag = secret_ceremony_tragic_failure
			}
			10 = { # You feel stressed out by the ordeal...
				set_character_flag = feel_different_negative
				set_character_flag = secret_ceremony_small_failure
			}

			10 = { # You are satisfied, you guess...
				set_character_flag = secret_ceremony_neutral_outcome
			}

			30 = { # The ceremony leaves you at peace...
				random = {
					chance = 25
					set_character_flag = feel_different_positive
				}
				if = {
					limit = { 
						FROM = { root_attraction_trigger = yes }
						NOT = { is_lover = FROM }
					}
					random = {
						chance = 50
						set_character_flag = secret_ceremony_romance
					}
				}
				if = {
					limit = {
						NOT = { is_friend = FROM }
						FROM = { root_attraction_trigger = no }
					}
					random = {
						chance = 50
						set_character_flag = secret_ceremony_friendship
					}
				}
				set_character_flag = secret_ceremony_small_success
			}

			30 = { #The ceremony reinvigorates you completely...!
				if = {
					limit = { 
						FROM = { root_attraction_trigger = yes }
						NOT = { is_lover = FROM }
					}
					random = {
						chance = 50
						set_character_flag = secret_ceremony_romance
					}
				}
				if = {
					limit = {
						NOT = { is_friend = FROM }
						FROM = { root_attraction_trigger = no }
					}
					random = {
						chance = 50
						set_character_flag = secret_ceremony_friendship
					}
				}
				set_character_flag = feel_different_positive
				set_character_flag = secret_ceremony_big_success
			}
		}

		if = { # if you just gained this flag, you gain a random trait! (unless you already have all the traits)
			limit = { has_character_flag = feel_different_positive }
			random_list = {
				10 = {
					modifier = {
						factor = 0
						trait = gregarious
					}
					modifier = {
						factor = 2
						has_education_diplomacy_trigger = yes
					}
					set_character_flag = gregarious_flag
				}
				10 = {
					modifier = {
						factor = 0
						trait = brave
					}
					modifier = {
						factor = 2
						has_education_martial_trigger = yes
					}
					set_character_flag = brave_flag
				}
				10 = {
					modifier = {
						factor = 0
						trait = diligent
					}
					modifier = {
						factor = 2
						has_education_stewardship_trigger = yes
					}
					set_character_flag = diligent_flag
				}
				10 = {
					modifier = {
						factor = 0
						trait = patient
					}
					modifier = {
						factor = 2
						has_education_intrigue_trigger = yes
					}
					set_character_flag = patient_flag
				}
				10 = {
					modifier = {
						factor = 0
						NOT = {
							trait = gregarious
							trait = brave
							trait = diligent
							trait = patient
						}
					}
					clr_character_flag = feel_different_positive
				}
			}
		}
	}
	
	desc = { 
		text = EVTDESC_MNM_3239_TRAGIC_FAIL
		picture = GFX_evt_secluded_in_prayer
		trigger = { has_character_flag = secret_ceremony_tragic_failure }
	}
	desc = { 
		text = EVTDESC_MNM_3239_SMALL_FAIL
		picture = GFX_evt_secluded_in_prayer
		trigger = { has_character_flag = secret_ceremony_small_failure }
	}
	desc = { 
		text = EVTDESC_MNM_3239_NEUTRAL_OUTCOME
		picture = GFX_evt_secluded_in_prayer
		trigger = { has_character_flag = secret_ceremony_neutral_outcome }
	}
	desc = { 
		text = EVTDESC_MNM_3239_SMALL_SUCCESS
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_small_success
			NOT = { has_character_flag = secret_ceremony_romance }
			NOT = { has_character_flag = secret_ceremony_friendship }
		}
	}
	desc = { 
		text = EVTDESC_MNM_3239_SMALL_SUCCESS_N_FRIENDSHIP
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_small_success
			has_character_flag = secret_ceremony_friendship
		}
	}
	desc = { 
		text = EVTDESC_MNM_3239_SMALL_SUCCESS_N_ROMANCE
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_small_success
			has_character_flag = secret_ceremony_romance
			NOT = { is_rival = FROM }
		}
	}
	desc = { 
		text = EVTDESC_MNM_3239_SMALL_SUCCESS_N_RIVAL_ROMANCE
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_small_success
			has_character_flag = secret_ceremony_romance
			is_rival = FROM
		}
	}
	desc = {
		text = EVTDESC_MNM_3239_BIG_SUCCESS
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_big_success
			NOT = { has_character_flag = secret_ceremony_romance }
			NOT = { has_character_flag = secret_ceremony_friendship }
		}
	}
	desc = { 
		text = EVTDESC_MNM_3239_BIG_SUCCESS_N_FRIENDSHIP
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_big_success
			has_character_flag = secret_ceremony_friendship
		}
	}
	desc = { 
		text = EVTDESC_MNM_3239_BIG_SUCCESS_N_ROMANCE
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_big_success
			has_character_flag = secret_ceremony_romance
			NOT = { is_rival = FROM }
		}
	}
	desc = { 
		text = EVTDESC_MNM_3239_BIG_SUCCESS_N_RIVAL_ROMANCE
		picture = GFX_evt_secluded_in_prayer
		trigger = {
			has_character_flag = secret_ceremony_big_success
			has_character_flag = secret_ceremony_romance
			is_rival = FROM
		}
	}

	option = {
		name = {
			text = EVTOPTA_MNM_3239_TRAGIC_FAIL
			trigger = { has_character_flag = secret_ceremony_tragic_failure }
		}
		name = {
			text = EVTOPTA_MNM_3239_SMALL_FAIL
			trigger = { has_character_flag = secret_ceremony_small_failure }
		}
		name = {
			text = EVTOPTA_MNM_3239_NEUTRAL_OUTCOME
			trigger = { has_character_flag = secret_ceremony_neutral_outcome }
		}
		name = {
			text = EVTOPTA_MNM_3239_SMALL_SUCCESS
			trigger = { has_character_flag = secret_ceremony_small_success }
		}
		name = {
			text = EVTOPTA_MNM_3239_BIG_SUCCESS
			trigger = { has_character_flag = secret_ceremony_big_success }
		}

		if = { limit = { has_character_flag = secret_ceremony_tragic_failure } 
			custom_tooltip = { text = EVTOPTA_MNM_3239_TRAGIC_FAIL_TT }
		}
		if = { limit = { has_character_flag = secret_ceremony_small_failure } 
			custom_tooltip = { text = EVTOPTA_MNM_3239_SMALL_FAIL_TT }
		}
		if = { limit = { has_character_flag = secret_ceremony_neutral_outcome } 
			custom_tooltip = { text = EVTOPTA_MNM_3239_NEUTRAL_OUTCOME_TT }
		}
		if = {
			limit = {
				has_character_flag = secret_ceremony_small_success
				NOT = { has_character_flag = secret_ceremony_romance }
			} 
			custom_tooltip = { text = EVTOPTA_MNM_3239_SMALL_SUCCESS_TT_1 }
		}
		if = {
			limit = {
				has_character_flag = secret_ceremony_small_success
				has_character_flag = secret_ceremony_romance
			}
			custom_tooltip = { text = EVTOPTA_MNM_3239_SMALL_SUCCESS_TT_2 }
		}
		if = {
			limit = {
				has_character_flag = secret_ceremony_big_success
				NOT = { has_character_flag = secret_ceremony_romance }
			}
			custom_tooltip = { text = EVTOPTA_MNM_3239_BIG_SUCCESS_TT_1 }
		}
		if = {
			limit = {
				has_character_flag = secret_ceremony_big_success
				has_character_flag = secret_ceremony_romance
			}
			custom_tooltip = { text = EVTOPTA_MNM_3239_BIG_SUCCESS_TT_2 }
		}
		
		if = { # the ceremony sparked something between the two of you
			limit = { has_character_flag = secret_ceremony_romance }
			if = {
				limit = {
					has_opinion_modifier = { who = FROM modifier = opinion_budding_romance }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_budding_romance }
				}
				add_lover = FROM 
			}
			if = {
				limit = { is_rival = FROM }
				remove_rival = FROM
			}
			if = {
				limit = {
					NOT = { has_opinion_modifier = { who = FROM modifier = opinion_budding_romance } }
					NOT = { reverse_has_opinion_modifier = { who = FROM modifier = opinion_budding_romance } }
				}
				reverse_opinion =  {
					who = FROM
					modifier = opinion_budding_romance
					years = 10
				}
				opinion =  {
					who = FROM
					modifier = opinion_budding_romance
					years = 10
				}
			}
		}

		if = { # the ceremony brought you closer together
			limit = { has_character_flag = secret_ceremony_friendship }
			if = {
				limit = { NOT = { is_rival = FROM } }
				add_friend = FROM
			}
			
			if = {
				limit = { is_rival = FROM }
				remove_rival = FROM
				reverse_opinion =  {
					who = FROM
					modifier = opinion_budding_friendship
					years = 10
				}
				opinion =  {
					who = FROM
					modifier = opinion_budding_friendship
					years = 10
				}
			}
		}	
		
		trigger_switch = { # Which trait to handle
			on_trigger = has_character_flag
			gregarious_flag = {
				add_trait_gregarious_effect = yes
				remove_trait_shy_effect = yes
				clr_character_flag = gregarious_flag
			}
			brave_flag = {
				add_trait_brave_effect = yes
				remove_trait_craven_effect = yes   
				clr_character_flag = brave_flag
			}
			diligent_flag = {
				add_trait_diligent_effect = yes
				remove_trait_slothful_effect = yes
				clr_character_flag = diligent_flag
			}
			patient_flag = {
				add_trait_patient_effect = yes
				remove_trait_wroth_effect = yes
				clr_character_flag = patient_flag
			}
		}
		
		if = {
			limit = { has_character_flag = feel_different_negative }
			random = {
				chance = 20
				add_trait = stressed
			}
		}

		if = { limit = { has_character_flag = secret_ceremony_small_failure }
			add_society_currency_minor_effect = yes
		}
		trigger_switch = {
			on_trigger = has_character_flag
			secret_ceremony_neutral_outcome = { add_society_currency_minor_effect = yes }
			secret_ceremony_small_success = { add_society_currency_medium_effect = yes }
			secret_ceremony_big_success = { add_society_currency_medium_effect = yes }
		}

		if = { limit = { NOT = { has_character_flag = secret_ceremony_tragic_failure } } #unless you tragically failed, you succeed
			clr_quest = quest_secret_religions_conduct_secret_ceremony
		}
		
		if = {
			limit = { has_character_flag = secret_ceremony_tragic_failure }
			event_target:unfortunate_interrupter = {
				death = { death_reason = death_murder_unknown killer = ROOT }
				show_portrait = yes
			}
			clr_quest = { id = quest_secret_religions_conduct_secret_ceremony failure = yes }
		}
		
		clr_character_flag = secret_ceremony_tragic_failure
		clr_character_flag = secret_ceremony_small_failure
		clr_character_flag = secret_ceremony_neutral_outcome
		clr_character_flag = secret_ceremony_small_success
		clr_character_flag = secret_ceremony_big_success
		clr_character_flag = secret_ceremony_friendship
		clr_character_flag = secret_ceremony_romance
		clr_character_flag = feel_different_positive
		clr_character_flag = feel_different_negative
		clr_character_flag = conduct_secret_ceremony_timer
	}
}

#------------------ Secret ceremony end--------------------


#MISSION: Induct a ruler
character_event = {
	id = MNM.3400
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3401 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3401
	desc = EVTDESC_MNM_3401
	quest_target = event_target:induction_target

	is_triggered_only = yes

	immediate = {
		top_liege = {
			random_realm_lord = { #Backup
				limit = { ok_sr_induction_mission_target_trigger = yes }
				save_event_target_as = induction_target
			}

			random_realm_lord = { #Baron-count for low levels
				limit = { 
					lower_tier_than = DUKE 
					ok_sr_induction_mission_target_trigger = yes
				}
				save_event_target_as = induction_target
			}
		}
		if = {
			limit = { society_rank >= 3 }
			top_liege = { 
				if = { #Top liege only if all other duke+ rulers are taken
					limit = { ok_sr_induction_mission_target_trigger = yes }
					save_event_target_as = induction_target
				}
			}
			random_realm_lord = { #For high level ppl, duke+ ruler
				limit = { 
					higher_tier_than = BARON 
					ok_sr_induction_mission_target_trigger = yes
				}
			save_event_target_as = induction_target
		  }
	   }
	}

	option = { #accept
		name = ACCEPT
		event_target:induction_target = {
			set_character_flag = appear_in_option
			clr_character_flag = appear_in_option
		}
			event_target:induction_target = {
				set_quest_target = {
				id = quest_secret_religious_societies_induct_ruler
					holder = ROOT
				}
			}
			
		}	
	option = { #nah thx
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		hidden_effect = {
			add_character_modifier = {
				name = quest_cooldown_timer
				hidden = yes
				days = 1000
			}
		}
		ai_chance = { factor = 0 }
	}
}


#MISSION: evoke a ruler's sympathy
character_event = {
	id = MNM.3402
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3403 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3403
	desc = EVTDESC_MNM_3403
	quest_target = event_target:sympathy_target

	is_triggered_only = yes

	immediate = {
		top_liege = {
			random_realm_lord = { #Backup
				limit = { 
					ok_sr_sympathy_mission_target_trigger = yes 
					is_adult = yes
				}
				save_event_target_as = sympathy_target
			}

			random_realm_lord = { #Baron-count for low levels
				limit = { 
					is_adult = yes
					lower_tier_than = DUKE 
					ok_sr_sympathy_mission_target_trigger = yes
				}
				save_event_target_as = sympathy_target
			}
		}
		if = {
			limit = { society_rank >= 3 }
			top_liege = { 
				if = { #Top liege only if all other duke+ rulers are taken
					limit = { 
						ok_sr_sympathy_mission_target_trigger = yes 
						is_adult = yes
					}
					save_event_target_as = sympathy_target
				}
				random_realm_lord = { #For high level ppl, duke+ ruler
					limit = { 
						is_adult = yes
						higher_tier_than = BARON 
						ok_sr_sympathy_mission_target_trigger = yes
					}
					save_event_target_as = sympathy_target
				}
			}
		}
	}

	option = { #accept
		name = ACCEPT
		
		event_target:sympathy_target = {
				set_quest_target = {
				id = quest_secret_religious_societies_sympathy_ruler
					holder = ROOT
				}
			}
		}	

	option = { #nah thx
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		hidden_effect = {
			add_character_modifier = {
				name = quest_cooldown_timer
				hidden = yes
				days = 1000
			}
		}
		ai_chance = { factor = 0 }
	}
}


#POWERS
#Power: Attempt to give character sympathy
character_event = {
	id = MNM.3404
	desc = EVTDESC_MNM_3404
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	

	#How to make your argument?

	#Friends & family
	option = { 
		name = EVTOPTA_MNM_3404
		custom_tooltip = { text = EVTOPTA_MNM_3404_TT }
		set_character_flag = sympathy_argument_friends_family

	}

	#Home & business
	option = {
		name = EVTOPTB_MNM_3404
		custom_tooltip = { text = EVTOPTB_MNM_3404_TT }
		set_character_flag = sympathy_argument_trauma
	}
	
	#Logical option
	option = {
		name = EVTOPTC_MNM_3404
		custom_tooltip = { text = EVTOPTC_MNM_3404_TT }
		set_character_flag = sympathy_argument_profit
	}
	
	#Stress your own opinion
	option = {
		name = EVTOPTD_MNM_3404
		custom_tooltip = { text = EVTOPTD_MNM_3404_TT }
		set_character_flag = sympathy_argument_personal
	}

	after = {
		hidden_effect = { FROM = { character_event = { id = MNM.3405 days = 5 } } }
	}
}

#Person is approached with touching story, develop sympathy or not?
character_event = {
	id = MNM.3405
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy

	desc = {
		trigger = { FROM = { has_character_flag = sympathy_argument_friends_family } }
		text = EVTDESC_MNM_3405_A
	}
	desc = {
		trigger = { FROM = { has_character_flag = sympathy_argument_trauma } }
		text = EVTDESC_MNM_3405_B
	}
	desc = {
		trigger = { FROM = { has_character_flag = sympathy_argument_profit } }
		text = EVTDESC_MNM_3405_C
	}
	desc = {
		trigger = { FROM = { has_character_flag = sympathy_argument_personal } }
		text = EVTDESC_MNM_3405_D
	}

	is_triggered_only = yes
	
	#Yes I agree
	option = { 
		name = EVTOPTA_MNM_3405

		if = {
			limit = { trait = zealous }
			remove_trait = zealous
		}

		FROM = {
			ROOT = {
				add_sympathy_for_prevs_true_religion_effect = yes
			}
		}

		reverse_opinion =  {
			who = FROM
			modifier = opinion_open_minded
			years = 10
		}

		hidden_effect = {
			FROM = { character_event =  { id = MNM.3406 days = 1 } }
		}

		ai_chance = {
			factor = 60
			modifier = { trait = kind factor = 3 }
			modifier = { trait = just factor = 2 }
			modifier = { trait = trusting factor = 2 }
			modifier = { trait = patient factor = 1.5 }
			modifier = { trait = charitable factor = 1.5 }
			modifier = { controls_religion = yes factor = 0 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.4 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.3 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			#modifier = { FROM = { ai = yes } factor = 2 } #The AI makes an uniformed choice, so they need this boost

			modifier = {
				factor = 3
				FROM = { has_character_flag = sympathy_argument_friends_family }
				OR = {
					trait = gregarious
					trait = socializer
					trait = kind
					num_of_friends = 1
					num_of_lovers = 1
					any_child = { reverse_opinion = { who = ROOT value = 35 } }
					has_education_diplomacy_trigger = yes
				}
			}

			modifier = {
				factor = 3
				FROM = { has_character_flag = sympathy_argument_trauma }
				OR = {
					trait = craven
					trait = kind
					has_scarred_trait_trigger = yes
					is_weak_trigger = yes
					character_disease_trigger = yes
					has_injury_trigger = yes
					has_disability_trigger = yes
					has_mental_disorder_trigger = yes
					has_negative_congenital_trigger = yes
				}
			}

			modifier = {
				factor = 3
				FROM = { has_character_flag = sympathy_argument_profit }
				OR = {
					trait = greedy
					trait = ambitious
					trait = cynical
					trait = administrator
					trait = diligent
					is_smart_trigger = yes
					has_education_stewardship_trigger = yes
				}
			}

			modifier = {
				factor = 3
				FROM = { has_character_flag = sympathy_argument_personal }
				opinion = { WHO = FROM value = 15 }
				OR = {
					is_friend = FROM
					is_lover = FROM
					opinion = { WHO = FROM value = 50 }
					liege = { character = FROM }
					top_liege = { character = FROM }
					is_close_relative = FROM
					FROM = { diplomacy = 15 }
				}
			}
		}
	}

	#No I don't care
	option = {
		name = EVTOPTB_MNM_3405

		reverse_opinion =  {
			who = FROM
			modifier = opinion_narrow_minded
			years = 10
		}

		hidden_effect = {
			FROM = { character_event =  { id = MNM.3407 days = 1 } }
		}

		ai_chance = {
			factor = 40
			modifier = { trait = zealous factor = 5 }
			modifier = { trait = cruel factor = 3 }
			modifier = { trait = arbitrary factor = 3 }
			modifier = { is_priest = yes factor = 2 }
			modifier = { NOT = { FROM = { diplomacy = 8 } } factor = 2 }
			modifier = { tier = BARON factor = 1.2 }
			modifier = { tier = DUKE factor = 1.4 }
			modifier = { tier = KING factor = 1.7 }
			modifier = { tier = EMPEROR factor = 2 }
		}
	}

	after = {
		hidden_effect = {
			FROM = {
				clr_character_flag = sympathy_argument_friends_family
				clr_character_flag = sympathy_argument_trauma
				clr_character_flag = sympathy_argument_profit
				clr_character_flag = sympathy_argument_personal
			}
		}
	}
}

#They gained sympathy
character_event = {
	id = MNM.3406
	desc = EVTDESC_MNM_3406
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3406

		tooltip = {
			FROM = { add_sympathy_for_prevs_true_religion_effect = yes }
		}
		if = {
			limit = { 
				has_quest = quest_secret_religious_societies_sympathy_ruler 
				FROM = { is_quest_target_of = ROOT }
			}
			clr_quest = quest_secret_religious_societies_sympathy_ruler
			add_society_currency_medium_effect = yes
		}
	}
}

#They did not gain sympathy
character_event = {
	id = MNM.3407
	desc = EVTDESC_MNM_3407
	picture = GFX_evt_courtiers_talking
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3407

		if = {
			limit = { 
				has_quest = quest_secret_religious_societies_sympathy_ruler 
				FROM = { is_quest_target_of = ROOT }
			}
			clr_quest = { id = quest_secret_religious_societies_sympathy_ruler failure = yes }
		}
	   	if = {
			limit = { 
				has_quest = quest_secret_religious_societies_induct_ruler 
				FROM = { is_quest_target_of = ROOT }
			}
			clr_quest = { id = quest_secret_religious_societies_induct_ruler failure = yes }
		}
	}
}


#POWER: Induct character to secret faith
character_event = {
	id = MNM.3408
	desc = EVTDESC_MNM_3408
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = {
		save_event_target_as = secret_religion_inductor
		FROM = { save_event_target_as = secret_religion_inductee }
	}
	
	#A passage about great warriors of the faith
	option = { 
		name = EVTOPTA_MNM_3408
		custom_tooltip = { text = EVTOPTA_MNM_3408_TT }
		set_character_flag = induction_argument_war
	}

	#A passage about community  
	option = {
		name = EVTOPTB_MNM_3408
		custom_tooltip = { text = EVTOPTB_MNM_3408_TT }
		 set_character_flag = induction_argument_community
	}
	
	#An interesting passage on matters of ethics and philosophy
	option = {
		name = EVTOPTC_MNM_3408
		custom_tooltip = { text = EVTOPTC_MNM_3408_TT }
		 set_character_flag = induction_argument_theology
	}
	
	#A passage about a succesful and fair ruler
	option = {
		name = EVTOPTD_MNM_3408
		custom_tooltip = { text = EVTOPTD_MNM_3408_TT }
		set_character_flag = induction_argument_stewardship
	}

	after = {
		hidden_effect = { event_target:secret_religion_inductee = { character_event = { id = MNM.3409 days = 3 } } }
	}
}

#Finds a holy book
character_event = {
	id = MNM.3409
	picture = GFX_evt_library
	desc = EVTDESC_MNM_3409
	border = GFX_event_normal_frame_religion

	hide_from = yes

	is_triggered_only = yes
  
	#Read it
	option = { 
		name = EVTOPTA_MNM_3409
		custom_tooltip = { text = EVTOPTA_MNM_3409_TT }

		hidden_effect = { character_event = { id = MNM.3410 days = 12 } }
		ai_chance = { factor = 10 }
	}

	#Hide it
	option = {
		name = EVTOPTC_MNM_3409
		custom_tooltip = { text = EVTOPTC_MNM_3409_TT }

		hidden_effect = { event_target:secret_religion_inductor = { character_event = { id = MNM.3413 days = 3 } } } #fail event

		random = {
			chance = 10
			add_trait_paranoid_effect = yes
		}

		ai_chance = { factor = 0 }
	}
}

#Reading the holy book
character_event = {
	id = MNM.3410
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_war } }
		text = EVTDESC_MNM_3410_A
	}
	desc = {
		trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_community } }
		text = EVTDESC_MNM_3410_B
	}
	desc = {
		trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_theology } }
		text = EVTDESC_MNM_3410_C
	}
	desc = {
		trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_stewardship } }
		text = EVTDESC_MNM_3410_D
	}

	hide_from = yes

	is_triggered_only = yes

	#It speaks the truth
	option = { 
		name = EVTOPTA_MNM_3410
		#custom_tooltip = { text = EVTOPTA_MNM_3410_TT }

		hidden_effect = {
			clear_secret_religion = yes
		}
		#Add new secret religion
		set_secret_religion = event_target:secret_religion_inductor
	   	event_target:secret_religion_inductor = {
	   		#And update the inductor
	   		hidden_effect = { character_event = { id = MNM.3411 days = 3 } }
	   	}

	   	ai_chance = {
			factor = 60
			modifier = { trait = trusting factor = 2 }
			modifier = { controls_religion = yes factor = 0 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.4 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.4 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.3 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.3 }
			modifier = { FROM = { diplomacy = 20 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 22 } factor = 1.2 }
			#modifier = { FROM = { ai = yes } factor = 1.5 } #The AI makes an uniformed choice, so they need this boost

			modifier = {
				factor = 3
				FROM = { has_character_flag = induction_argument_war }
				OR = {
					trait = brave
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
					has_job_title = job_marshal
				}
			}

			modifier = {
				factor = 3
				FROM = { has_character_flag = induction_argument_community }
				OR = {
					trait = gregarious
					num_of_friends = 1
					num_of_lovers = 1
					any_child = { reverse_opinion = { who = ROOT value = 35 } }
					has_education_diplomacy_trigger = yes
					has_lifestyle_diplomacy_trigger = yes
				}
			}

			modifier = {
				factor = 3
				FROM = { has_character_flag = induction_argument_theology }
				OR = {
					trait = erudite
					has_education_learning_trigger = yes
					has_lifestyle_learning_trigger = yes
				}
			}

			modifier = {
				factor = 3
				FROM = { has_character_flag = induction_argument_stewardship }
				OR = {
					trait = ambitious
					trait = just
					has_lifestyle_stewardship_trigger = yes
					has_education_stewardship_trigger = yes
				}
			}
		}
	}

	#Reaffirmed my belief
	option = {
		name = EVTOPTB_MNM_3410

		piety = 25

	   	hidden_effect = { event_target:secret_religion_inductor = { character_event = { id = MNM.3413 days = 3 } } } #fail event

		ai_chance = {
			factor = 40
			modifier = { is_priest = yes factor = 4 }
			modifier = { trait = paranoid factor = 10 }
			modifier = { trait = zealous factor = 100 }
			modifier = { NOT = { FROM = { diplomacy = 8 } } factor = 2 }
			modifier = { tier = BARON factor = 2 }
			modifier = { tier = COUNT factor = 3 }
			modifier = { tier = DUKE factor = 4 }
			modifier = { tier = KING is_nomadic = no factor = 16 }
			modifier = { tier = EMPEROR is_nomadic = no factor = 32 }
		}
	}

	after = {
		hidden_effect = {
			event_target:secret_religion_inductor = {
				clr_character_flag = induction_argument_war
				clr_character_flag = induction_argument_community
				clr_character_flag = induction_argument_theology
				clr_character_flag = induction_argument_stewardship
			}
		}
	}
}

#The inductee did accept my secret religion
character_event = {
	id = MNM.3411
	desc = EVTDESC_MNM_3411
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes

	#Attempt to recruit them
	option = { 
		name = EVTOPTA_MNM_3411
		custom_tooltip = { text = EVTOPTA_MNM_3411_TT }

		#Recruitment
		hidden_effect = {
			save_event_target_as = secret_religion_recruiter
			event_target:secret_religion_inductee = { 
				character_event = { id = MNM.3420 days = 14 }
				add_character_modifier = {
					name = secret_religions_recruitment_timer
					years = 5
					hidden = yes
				}
			}
		}		

		ai_chance = {
			factor = 5
			modifier = { event_target:secret_religion_inductee = { is_ruler = yes } factor = 20 }
			modifier = { event_target:secret_religion_inductee = { diplomacy = 12 } factor = 5 }
			modifier = { event_target:secret_religion_inductee = { diplomacy = 15 } factor = 4 }
			modifier = {
				factor = 0 # don't recruit characters interested in something else
				event_target:secret_religion_inductee = { ai = no }
				event_target:secret_religion_inductee = { NOT = { interested_in_society = secret_religious_cult } }
				event_target:secret_religion_inductee = { is_interested_in_any_society = yes }
			}
		}
	}

	#Good
	option = { 
		name = EVTOPTB_MNM_3411

		ai_chance = { factor = 10 }
	}

	after = {
		event_target:secret_religion_inductee = {
			tooltip = { set_secret_religion = event_target:secret_religion_inductor }
			if = {
				limit = { 
					ROOT = { has_quest = quest_secret_religious_societies_induct_ruler }
					is_quest_target_of = ROOT
				}
				ROOT = { 
					clr_quest = quest_secret_religious_societies_induct_ruler 
					add_society_currency_major_effect = yes
				}
			}
		}
	}
}


#Fail: Inductee hid/didn't read book
character_event = {
	id = MNM.3413
	desc = EVTDESC_MNM_3413
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_religion

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes

	option = { 
		name = EVTOPTA_MNM_3412

		if = {
			limit = { 
				has_quest = quest_secret_religious_societies_induct_ruler 
				FROM = { is_quest_target_of = ROOT }
			}
			clr_quest = { id = quest_secret_religious_societies_induct_ruler failure = yes }
		}
	}
}

# openly_adopt_faith - Convert cultists
character_event = {
	id = MNM.3800
	desc = EVTDESC_MNM_3800
	picture = GFX_evt_society_joining
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = currently_part_of_secret_religion_uncovering
		set_variable = { which = visibility_value value = 0 }
		remove_character_modifier = highly_suspect
		remove_character_modifier = under_suspicion
	}
	
	option = {
		name = EVTOPTA_MNM_3800
		if = {
			limit = {
				OR = {
					religion = americanist
					religion = consumerist
					religion = monetarist
					religion = rust_cultist
					religion = imamite
					has_religion_feature = religion_temporal_head
				}
				any_demesne_title = {
					controls_religion = yes
				}
			}
			any_demesne_title = {
				limit = {
					controls_religion = yes
				}
				destroy_landed_title = THIS
			}
		}
		if = {
			limit = {
				NOR = {
					religion = americanist
					religion = consumerist
					religion = monetarist
					religion = rust_cultist
					religion = imamite
					has_religion_feature = religion_temporal_head
				}
				any_demesne_title = {
					controls_religion = yes
				}
			}
			hidden_tooltip = {
				liege = {
					save_event_target_as = liege_target
				}
				create_character = {
					age = 38
					dynasty = random
					religion = ROOT
					culture = ROOT
					random_traits = yes
				}
				new_character = {
					character_event = { id = misc.3 } # Diversity
					character_event = { id = misc.4 } # Physique
					save_event_target_as = new_holder
				}
			}
			any_demesne_title = {
				limit = {
					controls_religion = yes
				}
				grant_title = event_target:new_holder
				holder_scope = {
					any_vassal = {
						set_defacto_liege = event_target:liege_target
					}
				}
			}
			hidden_tooltip = {
				set_defacto_liege = event_target:liege_target
			}
		}
		if = { # Holy Orders/Static Mercs are given to a random new character
			limit = {
				any_demesne_title = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
			}
			hidden_tooltip = {
				liege = {
					save_event_target_as = liege_target
				}
				create_character = {
					age = 38
					dynasty = random
					religion = ROOT
					culture = ROOT
					random_traits = yes
				}
				new_character = {
					character_event = { id = misc.3 } # Diversity
					character_event = { id = misc.4 } # Physique
					save_event_target_as = new_holder
				}
			}
			any_demesne_title = {
				limit = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
				grant_title = event_target:new_holder
				holder_scope = {
					any_vassal = {
						set_defacto_liege = event_target:liege_target
					}
				}
			}
			hidden_tooltip = {
				set_defacto_liege = event_target:liege_target
			}
		}
		flip_to_secret_religion_effect = yes
		if = {
			limit = {
				is_in_society = yes
			}
			leave_society = yes
		}
		if = {
			limit = { ai = yes }
			set_character_flag = ai_flag_refuse_conversion
		}
	}
}

# openly_adopt_faith - Allow sympathisers the chance to flip
character_event = {
	id = MNM.3810
	desc = EVTDESC_MNM_3810
	picture = GFX_evt_society_joining
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			ai = yes
			is_nomadic = yes
			NOR = {
				AND = {
					FROM = { 
						OR = {
							#islamic
						}
					}
					NOT = { has_dlc = "The Sword of Islam" }
				}
				AND = {
					FROM = {
						OR = {
							society_member_of = secret_religious_society_jewish
							society_member_of = secret_religious_society_reform
						}
					}
					NOT = { has_dlc = "Sons of Abraham" }
				}
				AND = {
					FROM = { 
						OR = {
							society_member_of = secret_religious_society_pagan
							society_member_of = secret_religious_society_revelationist
							society_member_of = secret_religious_society_revelationist_reformed
							society_member_of = secret_religious_society_occultist
							society_member_of = secret_religious_society_occultist_reformed
							society_member_of = secret_religious_society_thelemic
							society_member_of = secret_religious_society_thelemic_reformed
							society_member_of = secret_religious_society_norse_pagan
							society_member_of = secret_religious_society_norse_pagan_reformed
							society_member_of = secret_religious_society_celtic_pagan
							society_member_of = secret_religious_society_celtic_pagan_reformed
						}
					}
					NOT = { has_dlc = "The Old Gods" }
				}
				AND = {
					FROM = { 
						OR = {
							society_member_of = secret_religious_society_hindu
						}
					}
					NOT = { has_dlc = "Rajas of India" }
				}
			}
		}
	}
	
	immediate = {
		FROM = {
			trigger_switch = { # Figure out which society is uncovering itself
				on_trigger = society_member_of
				secret_religious_society_rastafarian = { 
					ROOT = { set_character_flag = adopt_faith_rastafarian }
				}
				secret_religious_society_voodoo = { 
					ROOT = { set_character_flag = adopt_faith_voodoo }
				}
				secret_religious_society_santeria = { 
					ROOT = { set_character_flag = adopt_faith_santeria }
				}
				secret_religious_society_candomble = { 
					ROOT = { set_character_flag = adopt_faith_candomble }
				}
				secret_religious_society_espiritista = { 
					ROOT = { set_character_flag = adopt_faith_espiritista }
				}
				secret_religious_society_espiritista_reformed = { 
					ROOT = { set_character_flag = adopt_faith_espiritista_reformed }
				}
				secret_religious_society_peyotist = { 
					ROOT = { set_character_flag = adopt_faith_peyotist }
				}
				secret_religious_society_midewiwin = { 
					ROOT = { set_character_flag = adopt_faith_midewiwin }
				}
				secret_religious_society_midewiwin_reformed = { 
					ROOT = { set_character_flag = adopt_faith_midewiwin_reformed }
				}
				secret_religious_society_raven_tales = { 
					ROOT = { set_character_flag = adopt_faith_raven_tales }
				}
				secret_religious_society_raven_tales_reformed = { 
					ROOT = { set_character_flag = adopt_faith_raven_tales_reformed }
				}
				secret_religious_society_catholic = { 
					ROOT = { set_character_flag = adopt_faith_catholic }
				}
				secret_religious_society_neognostic = { 
					ROOT = { set_character_flag = adopt_faith_neognostic }
				}
				secret_religious_society_sedevacantist = { 
					ROOT = { set_character_flag = adopt_faith_sedevacantist }
				}
				secret_religious_society_nestorian = { 
					ROOT = { set_character_flag = adopt_faith_nestorian }
				}
				secret_religious_society_ursuline = { 
					ROOT = { set_character_flag = adopt_faith_ursuline }
				}
				secret_religious_society_angeline = { 
					ROOT = { set_character_flag = adopt_faith_angeline }
				}
				secret_religious_society_confederated = { 
					ROOT = { set_character_flag = adopt_faith_confederated }
				}
				secret_religious_society_anabaptist = { 
					ROOT = { set_character_flag = adopt_faith_anabaptist }
				}
				secret_religious_society_batenburger = { 
					ROOT = { set_character_flag = adopt_faith_batenburger }
				}
				secret_religious_society_evangelical = { 
					ROOT = { set_character_flag = adopt_faith_evangelical }
				}
				secret_religious_society_antinomian = { 
					ROOT = { set_character_flag = adopt_faith_antinomian }
				}
				secret_religious_society_charismatic = { 
					ROOT = { set_character_flag = adopt_faith_charismatic }
				}
				secret_religious_society_postadventist = { 
					ROOT = { set_character_flag = adopt_faith_postadventist }
				}
				secret_religious_society_falling_star = { 
					ROOT = { set_character_flag = adopt_faith_falling_star }
				}
				secret_religious_society_moravian = { 
					ROOT = { set_character_flag = adopt_faith_moravian }
				}
				secret_religious_society_high_church = { 
					ROOT = { set_character_flag = adopt_faith_high_church }
				}
				secret_religious_society_nonconformist = { 
					ROOT = { set_character_flag = adopt_faith_nonconformist }
				}
				secret_religious_society_apostolic = { 
					ROOT = { set_character_flag = adopt_faith_apostolic }
				}
				secret_religious_society_sacred_heart = { 
					ROOT = { set_character_flag = adopt_faith_sacred_heart }
				}
				secret_religious_society_gracia_divina = { 
					ROOT = { set_character_flag = adopt_faith_gracia_divina }
				}
				secret_religious_society_cetic = { 
					ROOT = { set_character_flag = adopt_faith_cetic }
				}
				secret_religious_society_gaian = { 
					ROOT = { set_character_flag = adopt_faith_gaian }
				}
				secret_religious_society_shinto = { 
					ROOT = { set_character_flag = adopt_faith_shinto }
				}
				secret_religious_society_nousthreskeia = { 
					ROOT = { set_character_flag = adopt_faith_nousthreskeia }
				}
				secret_religious_society_mormon = { 
					ROOT = { set_character_flag = adopt_faith_mormon }
				}
				secret_religious_society_bickertonite = { 
					ROOT = { set_character_flag = adopt_faith_bickertonite }
				}
				secret_religious_society_woolleyite = { 
					ROOT = { set_character_flag = adopt_faith_woolleyite }
				}
				secret_religious_society_strangite = { 
					ROOT = { set_character_flag = adopt_faith_strangite }
				}
				secret_religious_society_sol_invicta = { 
					ROOT = { set_character_flag = adopt_faith_sol_invicta }
				}
				secret_religious_society_mictlantec = { 
					ROOT = { set_character_flag = adopt_faith_mictlantec }
				}
				secret_religious_society_uahomche = { 
					ROOT = { set_character_flag = adopt_faith_uahomche }
				}
				secret_religious_society_neomayan = { 
					ROOT = { set_character_flag = adopt_faith_neomayan }
				}
				secret_religious_society_americanist = { 
					ROOT = { set_character_flag = adopt_faith_americanist }
				}
				secret_religious_society_hamiltonian = { 
					ROOT = { set_character_flag = adopt_faith_hamiltonian }
				}
				secret_religious_society_jeffersonian = { 
					ROOT = { set_character_flag = adopt_faith_jeffersonian }
				}
				secret_religious_society_libertarian = { 
					ROOT = { set_character_flag = adopt_faith_libertarian }
				}
				secret_religious_society_consumerist = { 
					ROOT = { set_character_flag = adopt_faith_consumerist }
				}
				secret_religious_society_monetarist = { 
					ROOT = { set_character_flag = adopt_faith_monetarist }
				}
				secret_religious_society_atomicist = { 
					ROOT = { set_character_flag = adopt_faith_atomicist }
				}
				secret_religious_society_aphite = { 
					ROOT = { set_character_flag = adopt_faith_aphite }
				}
				secret_religious_society_pagan = { 
					ROOT = { set_character_flag = adopt_faith_pagan }
				}
				secret_religious_society_revelationist_reformed = { 
					ROOT = { set_character_flag = adopt_faith_revelationist_reformed }
				}
				secret_religious_society_revelationist = { 
					ROOT = { set_character_flag = adopt_faith_revelationist }
				}
				secret_religious_society_chrome_cultist = { 
					ROOT = { set_character_flag = adopt_faith_chrome_cultist }
				}
				secret_religious_society_rust_cultist = { 
					ROOT = { set_character_flag = adopt_faith_rust_cultist }
				}
				secret_religious_society_occultist_reformed = { 
					ROOT = { set_character_flag = adopt_faith_occultist_reformed }
				}
				secret_religious_society_occultist = { 
					ROOT = { set_character_flag = adopt_faith_occultist }
				}
				secret_religious_society_thelemic_reformed = { 
					ROOT = { set_character_flag = adopt_faith_thelemic_reformed }
				}
				secret_religious_society_thelemic = { 
					ROOT = { set_character_flag = adopt_faith_thelemic }
				}
				secret_religious_society_norse_pagan_reformed = { 
					ROOT = { set_character_flag = adopt_faith_norse_pagan_reformed }
				}
				secret_religious_society_norse_pagan = { 
					ROOT = { set_character_flag = adopt_faith_norse_pagan }
				}
				secret_religious_society_celtic_pagan = { 
					ROOT = { set_character_flag = adopt_faith_celtic_pagan }
				}
				secret_religious_society_celtic_pagan_reformed = { 
					ROOT = { set_character_flag = adopt_faith_celtic_pagan_reformed }
				}
				secret_religious_society_brethren = { 
					ROOT = { set_character_flag = adopt_faith_brethren }
				}
				secret_religious_society_jewish = { 
					ROOT = { set_character_flag = adopt_faith_jewish }
				}
				secret_religious_society_reform = { 
					ROOT = { set_character_flag = adopt_faith_reform }
				}
				secret_religious_society_meshichist = { 
					ROOT = { set_character_flag = adopt_faith_meshichist }
				}
				secret_religious_society_hindu = { 
					ROOT = { set_character_flag = adopt_faith_hindu }
				}
				secret_religious_society_traditionalist = { 
					ROOT = { set_character_flag = adopt_faith_traditionalist }
				}
				secret_religious_society_revivalist = { 
					ROOT = { set_character_flag = adopt_faith_revivalist }
				}
				secret_religious_society_imamite = { 
					ROOT = { set_character_flag = adopt_faith_imamite }
				}
				secret_religious_society_qingzheng = { 
					ROOT = { set_character_flag = adopt_faith_qingzheng }
				}
				secret_religious_society_alawiyya = { 
					ROOT = { set_character_flag = adopt_faith_alawiyya }
				}
				secret_religious_society_orientalist = { 
					ROOT = { set_character_flag = adopt_faith_orientalist }
				}
				secret_religious_society_misrist = { 
					ROOT = { set_character_flag = adopt_faith_misrist }
				}
				secret_religious_society_trailwalker = { 
					ROOT = { set_character_flag = adopt_faith_trailwalker }
				}
				secret_religious_society_trailwalker_reformed = { 
					ROOT = { set_character_flag = adopt_faith_trailwalker_reformed }
				}
				secret_religious_society_orthodox = { 
					ROOT = { set_character_flag = adopt_faith_orthodox }
				}
				secret_religious_society_exovedate = { 
					ROOT = { set_character_flag = adopt_faith_exovedate }
				}
				secret_religious_society_pelagic = { 
					ROOT = { set_character_flag = adopt_faith_pelagic }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3810 
		ai_chance = {
			factor = 20
			modifier = {
				factor = 1.3
				FROM = {
					diplomacy = 7
				}
			}
			modifier = {
				factor = 1.3
				FROM = {
					diplomacy = 10
				}
			}
			modifier = {
				factor = 1.3
				FROM = {
					diplomacy = 13
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					diplomacy = 15
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					diplomacy = 17
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 19
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 21
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 23
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 25
				}
			}
		}
		if = {
			limit = {
				OR = {
					religion = americanist
					religion = consumerist
					religion = monetarist
					religion = rust_cultist
					religion = imamite
					has_religion_feature = religion_temporal_head
				}
				any_demesne_title = {
					controls_religion = yes
				}
			}
			any_demesne_title = {
				limit = {
					controls_religion = yes
				}
				destroy_landed_title = THIS
			}
		}
		if = {
			limit = {
				NOR = {
					religion = americanist
					religion = consumerist
					religion = monetarist
					religion = rust_cultist
					religion = imamite
					has_religion_feature = religion_temporal_head
				}
				any_demesne_title = {
					controls_religion = yes
				}
			}
			hidden_tooltip = {
				liege = {
					save_event_target_as = liege_target
				}
				create_character = {
					age = 38
					dynasty = random
					religion = ROOT
					culture = ROOT
					random_traits = yes
				}
				new_character = {
					character_event = { id = misc.3 } # Diversity
					character_event = { id = misc.4 } # Physique
					save_event_target_as = new_holder
				}
			}
			any_demesne_title = {
				limit = {
					controls_religion = yes
				}
				grant_title = event_target:new_holder
				holder_scope = {
					any_vassal = {
						set_defacto_liege = event_target:liege_target
					}
				}
			}
			hidden_tooltip = {
				set_defacto_liege = event_target:liege_target
			}
		}
		if = { # Holy Orders/Static Mercs are given to a random new character
			limit = {
				any_demesne_title = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
			}
			hidden_tooltip = {
				liege = {
					save_event_target_as = liege_target
				}
				create_character = {
					age = 38
					dynasty = random
					religion = ROOT
					culture = ROOT
					random_traits = yes
				}
				new_character = {
					character_event = { id = misc.3 } # Diversity
					character_event = { id = misc.4 } # Physique
					save_event_target_as = new_holder
				}
			}
			any_demesne_title = {
				limit = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
				grant_title = event_target:new_holder
				holder_scope = {
					any_vassal = {
						set_defacto_liege = event_target:liege_target
					}
				}
			}
			hidden_tooltip = {
				set_defacto_liege = event_target:liege_target
			}
		}
		trigger_switch = {
			on_trigger = has_character_flag
			adopt_faith_rastafarian = {
				religion = rastafarian
			}
			adopt_faith_voodoo = {
				religion = voodoo
			}
			adopt_faith_santeria = {
				religion = santeria
			}
			adopt_faith_candomble = {
				religion = candomble
			}
			adopt_faith_espiritista = {
				religion = espiritista
			}
			adopt_faith_espiritista_reformed = {
				religion = espiritista_reformed
			}
			adopt_faith_peyotist = {
				religion = peyotist
			}
			adopt_faith_midewiwin = {
				religion = midewiwin
			}
			adopt_faith_midewiwin_reformed = {
				religion = midewiwin_reformed
			}
			adopt_faith_raven_tales = {
				religion = raven_tales
			}
			adopt_faith_raven_tales_reformed = {
				religion = raven_tales_reformed
			}
			adopt_faith_catholic = {
				religion = catholic
			}
			adopt_faith_neognostic = {
				religion = neognostic
			}
			adopt_faith_sedevacantist = {
				religion = sedevacantist
			}
			adopt_faith_nestorian = {
				religion = nestorian
			}
			adopt_faith_ursuline = {
				religion = ursuline
			}
			adopt_faith_angeline = {
				religion = angeline
			}
			adopt_faith_confederated = {
				religion = confederated
			}
			#ISN'T THERE AN EASIER WAY OF DOING THIS?
			adopt_faith_anabaptist = {
				religion = anabaptist
			}
			adopt_faith_batenburger = {
				religion = batenburger
			}
			adopt_faith_evangelical = {
				religion = evangelical
			}
			adopt_faith_antinomian = {
				religion = antinomian
			}
			adopt_faith_charismatic = {
				religion = charismatic
			}
			adopt_faith_postadventist = {
				religion = postadventist
			}
			#I swear I'm gonna get carpal tunnel
			adopt_faith_falling_star = {
				religion = falling_star
			}
			adopt_faith_moravian = {
				religion = moravian
			}
			adopt_faith_high_church = {
				religion = high_church
			}
			adopt_faith_nonconformist = {
				religion = nonconformist
			}
			adopt_faith_apostolic = {
				religion = apostolic
			}
			adopt_faith_sacred_heart = {
				religion = sacred_heart
			}
			adopt_faith_gracia_divina = {
				religion = gracia_divina
			}
			#I will haunt Johan's grave
			adopt_faith_cetic = {
				religion = cetic
			}
			adopt_faith_gaian = {
				religion = gaian
			}
			adopt_faith_shinto = {
				religion = shinto
			}
			adopt_faith_nousthreskeia = {
				religion = nousthreskeia
			}
			adopt_faith_mormon = {
				religion = mormon
			}
			adopt_faith_bickertonite = {
				religion = bickertonite
			}
			adopt_faith_woolleyite = {
				religion = woolleyite
			}
			adopt_faith_strangite = {
				religion = strangite
			}
			adopt_faith_sol_invicta = {
				religion = sol_invicta
			}
			adopt_faith_mictlantec = {
				religion = mictlantec
			}
			adopt_faith_uahomche = {
				religion = uahomche
			}
			adopt_faith_neomayan = {
				religion = neomayan
			}
			adopt_faith_americanist = {
				religion = americanist
			}
			adopt_faith_hamiltonian = {
				religion = hamiltonian
			}
			adopt_faith_jeffersonian = {
				religion = jeffersonian
			}
			adopt_faith_libertarian = {
				religion = libertarian
			}
			adopt_faith_consumerist = {
				religion = consumerist
			}
			adopt_faith_monetarist = {
				religion = monetarist
			}
			adopt_faith_atomicist = {
				religion = atomicist
			}
			adopt_faith_aphite = {
				religion = aphite
			}
			adopt_faith_pagan = {
				religion = pagan
			}
			adopt_faith_revelationist_reformed = {
				religion = revelationist_reformed
			}
			adopt_faith_revelationist = {
				religion = revelationist
			}
			adopt_faith_revelationist = {
				religion = revelationist
			}
			adopt_faith_chrome_cultist = {
				religion = chrome_cultist
			}
			adopt_faith_rust_cultist = {
				religion = rust_cultist
			}
			adopt_faith_occultist_reformed = {
				religion = occultist_reformed
			}
			adopt_faith_occultist = {
				religion = occultist
			}
			adopt_faith_thelemic_reformed = {
				religion = thelemic_reformed
			}
			adopt_faith_thelemic = {
				religion = thelemic
			}
			adopt_faith_norse_pagan_reformed = {
				religion = norse_pagan_reformed
			}
			adopt_faith_norse_pagan = {
				religion = norse_pagan
			}
			adopt_faith_celtic_pagan = {
				religion = celtic_pagan
			}
			adopt_faith_celtic_pagan_reformed = {
				religion = celtic_pagan_reformed
			}
			adopt_faith_brethren = {
				religion = brethren
			}
			adopt_faith_jewish = {
				religion = jewish
			}
			adopt_faith_reform = {
				religion = reform
			}
			adopt_faith_meshichist = {
				religion = meshichist
			}
			adopt_faith_hindu = {
				religion = hindu
			}
			adopt_faith_traditionalist = {
				religion = traditionalist 
			}
			adopt_faith_revivalist = {
				religion = revivalist 
			}
			adopt_faith_imamite = {
				religion = imamite 
			}
			adopt_faith_qingzheng = {
				religion = qingzheng 
			}
			adopt_faith_alawiyya = {
				religion = alawiyya 
			}
			adopt_faith_orientalist = {
				religion = orientalist 
			}
			adopt_faith_misrist = {
				religion = misrist 
			}
			adopt_faith_trailwalker = {
				religion = trailwalker
			}
			adopt_faith_trailwalker_reformed = {
				religion = trailwalker_reformed
			}
			adopt_faith_orthodox = {
				religion = orthodox
			}
			adopt_faith_exovedate = {
				religion = exovedate
			}
			adopt_faith_pelagic = {
				religion = pelagic
			}
		}
		clear_secret_religion = yes
		if = {
			limit = { ai = yes }
			set_character_flag = ai_flag_refuse_conversion
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3810
		ai_chance = {
			factor = 80
			modifier = {
				factor = 0.05
				FROM = {
					ROOT = {
						has_prevs_secret_religion_truly_trigger = yes
					}
				}
			}
		}
	}
	
	after = {
		set_character_flag = currently_part_of_secret_religion_uncovering
		
		clr_character_flag = adopt_faith_rastafarian
		clr_character_flag = adopt_faith_voodoo
		clr_character_flag = adopt_faith_santeria
		clr_character_flag = adopt_faith_candomble
		clr_character_flag = adopt_faith_espiritista
		clr_character_flag = adopt_faith_espiritista_reformed
		clr_character_flag = adopt_faith_peyotist
		clr_character_flag = adopt_faith_midewiwin
		clr_character_flag = adopt_faith_midewiwin_reformed
		clr_character_flag = adopt_faith_raven_tales
		clr_character_flag = adopt_faith_raven_tales_reformed
		clr_character_flag = adopt_faith_catholic
		clr_character_flag = adopt_faith_neognostic
		clr_character_flag = adopt_faith_sedevacantist
		clr_character_flag = adopt_faith_nestorian
		clr_character_flag = adopt_faith_ursuline
		clr_character_flag = adopt_faith_angeline
		clr_character_flag = adopt_faith_confederated
		clr_character_flag = adopt_faith_anabaptist
		clr_character_flag = adopt_faith_batenburger
		clr_character_flag = adopt_faith_evangelical
		clr_character_flag = adopt_faith_antinomian
		clr_character_flag = adopt_faith_charismatic
		clr_character_flag = adopt_faith_postadventist
		clr_character_flag = adopt_faith_falling_star
		clr_character_flag = adopt_faith_moravian
		clr_character_flag = adopt_faith_high_church
		clr_character_flag = adopt_faith_nonconformist
		clr_character_flag = adopt_faith_apostolic
		clr_character_flag = adopt_faith_sacred_heart
		clr_character_flag = adopt_faith_gracia_divina
		clr_character_flag = adopt_faith_cetic
		clr_character_flag = adopt_faith_gaian
		clr_character_flag = adopt_faith_shinto
		clr_character_flag = adopt_faith_nousthreskeia
		clr_character_flag = adopt_faith_mormon
		clr_character_flag = adopt_faith_bickertonite
		clr_character_flag = adopt_faith_woolleyite
		clr_character_flag = adopt_faith_strangite
		clr_character_flag = adopt_faith_sol_invicta
		clr_character_flag = adopt_faith_mictlantec
		clr_character_flag = adopt_faith_uahomche
		clr_character_flag = adopt_faith_neomayan
		clr_character_flag = adopt_faith_americanist
		clr_character_flag = adopt_faith_hamiltonian
		clr_character_flag = adopt_faith_jeffersonian
		clr_character_flag = adopt_faith_libertarian
		clr_character_flag = adopt_faith_consumerist
		clr_character_flag = adopt_faith_monetarist
		clr_character_flag = adopt_faith_atomicist
		clr_character_flag = adopt_faith_aphite
		clr_character_flag = adopt_faith_pagan
		clr_character_flag = adopt_faith_revelationist_reformed
		clr_character_flag = adopt_faith_revelationist
		clr_character_flag = adopt_faith_chrome_cultist
		clr_character_flag = adopt_faith_rust_cultist
		clr_character_flag = adopt_faith_occultist_reformed
		clr_character_flag = adopt_faith_occultist
		clr_character_flag = adopt_faith_thelemic_reformed
		clr_character_flag = adopt_faith_thelemic
		clr_character_flag = adopt_faith_norse_pagan_reformed
		clr_character_flag = adopt_faith_norse_pagan
		clr_character_flag = adopt_faith_celtic_pagan
		clr_character_flag = adopt_faith_celtic_pagan_reformed
		clr_character_flag = adopt_faith_brethren
		clr_character_flag = adopt_faith_jewish
		clr_character_flag = adopt_faith_reform
		clr_character_flag = adopt_faith_meshichist
		clr_character_flag = adopt_faith_hindu
		clr_character_flag = adopt_faith_traditionalist
		clr_character_flag = adopt_faith_revivalist
		clr_character_flag = adopt_faith_imamite
		clr_character_flag = adopt_faith_qingzheng
		clr_character_flag = adopt_faith_alawiyya
		clr_character_flag = adopt_faith_orientalist
		clr_character_flag = adopt_faith_misrist
		clr_character_flag = adopt_faith_revivalist
		clr_character_flag = adopt_faith_trailwalker
		clr_character_flag = adopt_faith_trailwalker_reformed
		clr_character_flag = adopt_faith_orthodox
		clr_character_flag = adopt_faith_exovedate
		clr_character_flag = adopt_faith_pelagic
	}
}

character_event = { # Openly Adopt Faith event (for the character who actually fires all of it)
	id = MNM.3811
	desc = EVTDESC_MNM_3811
	picture = GFX_evt_dark_prayer
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	immediate = {
		set_variable = { which = visibility_value value = 0 }
		remove_character_modifier = highly_suspect
		remove_character_modifier = under_suspicion
	}
	
	option = {	  
		name = EVTOPTA_MNM_3811
		custom_tooltip = { text = EVTOPTA_MNM_3811_TT }
		add_character_modifier = {
			modifier = devout_leader
			duration = -1
		}
		if = {
			limit = { ai = yes }
			set_character_flag = ai_flag_refuse_conversion
		}
	}
}


# openly_adopt_faith - Flip provinces with local cult modifier
character_event = {
	id = MNM.3820
	desc = EVTDESC_MNM_3820
	picture = GFX_evt_society_joining
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			trigger_switch = {
				on_trigger = society_member_of
				secret_religious_society_rastafarian = {
					ROOT = {
						set_character_flag = sr_rastafarian_prov_flip
					}
				}
				secret_religious_society_voodoo = {
					ROOT = {
						set_character_flag = sr_voodoo_prov_flip
					}
				}
				secret_religious_society_santeria = {
					ROOT = {
						set_character_flag = sr_santeria_prov_flip
					}
				}
				secret_religious_society_candomble = {
					ROOT = {
						set_character_flag = sr_candomble_prov_flip
					}
				}
				secret_religious_society_espiritista = {
					ROOT = {
						set_character_flag = sr_espiritista_prov_flip
					}
				}
				secret_religious_society_espiritista_reformed = {
					ROOT = {
						set_character_flag = sr_espiritista_reformed_prov_flip
					}
				}
				secret_religious_society_peyotist = {
					ROOT = {
						set_character_flag = sr_peyotist_prov_flip
					}
				}
				secret_religious_society_midewiwin = {
					ROOT = {
						set_character_flag = sr_midewiwin_prov_flip
					}
				}
				secret_religious_society_midewiwin_reformed = {
					ROOT = {
						set_character_flag = sr_midewiwin_eformed_prov_flip
					}
				}
				secret_religious_society_raven_tales = {
					ROOT = {
						set_character_flag = sr_raven_tales_prov_flip
					}
				}
				secret_religious_society_raven_tales_reformed = {
					ROOT = {
						set_character_flag = sr_raven_tales_reformed_prov_flip
					}
				}
				secret_religious_society_catholic = {
					ROOT = {
						set_character_flag = sr_catholic_prov_flip
					}
				}
				secret_religious_society_neognostic = {
					ROOT = {
						set_character_flag = sr_neognostic_prov_flip
					}
				}
				secret_religious_society_sedevacantist = {
					ROOT = {
						set_character_flag = sr_sedevacantist_prov_flip
					}
				}
				secret_religious_society_nestorian = {
					ROOT = {
						set_character_flag = sr_nestorian_prov_flip
					}
				}
				secret_religious_society_ursuline = {
					ROOT = {
						set_character_flag = sr_ursuline_prov_flip
					}
				}
				secret_religious_society_angeline = {
					ROOT = {
						set_character_flag = sr_angeline_prov_flip
					}
				}
				secret_religious_society_confederated = {
					ROOT = {
						set_character_flag = sr_confederated_prov_flip
					}
				}
				secret_religious_society_anabaptist = {
					ROOT = {
						set_character_flag = sr_anabaptist_prov_flip
					}
				}
				secret_religious_society_batenburger = {
					ROOT = {
						set_character_flag = sr_batenburger_prov_flip
					}
				}
				secret_religious_society_evangelical = {
					ROOT = {
						set_character_flag = sr_evangelical_prov_flip
					}
				}
				secret_religious_society_antinomian = {
					ROOT = {
						set_character_flag = sr_antinomian_prov_flip
					}
				}
				secret_religious_society_charismatic = {
					ROOT = {
						set_character_flag = sr_charismatic_prov_flip
					}
				}
				secret_religious_society_postadventist = {
					ROOT = {
						set_character_flag = sr_postadventist_prov_flip
					}
				}
				secret_religious_society_falling_star = {
					ROOT = {
						set_character_flag = sr_falling_star_prov_flip
					}
				}
				secret_religious_society_moravian = {
					ROOT = {
						set_character_flag = sr_moravian_prov_flip
					}
				}
				secret_religious_society_high_church = {
					ROOT = {
						set_character_flag = sr_high_church_prov_flip
					}
				}
				secret_religious_society_nonconformist = {
					ROOT = {
						set_character_flag = sr_nonconformist_prov_flip
					}
				}
				secret_religious_society_apostolic = {
					ROOT = {
						set_character_flag = sr_apostolic_prov_flip
					}
				}
				secret_religious_society_sacred_heart = {
					ROOT = {
						set_character_flag = sr_sacred_heart_prov_flip
					}
				}
				secret_religious_society_gracia_divina = {
					ROOT = {
						set_character_flag = sr_gracia_divina_prov_flip
					}
				}
				secret_religious_society_cetic = {
					ROOT = {
						set_character_flag = sr_cetic_prov_flip
					}
				}
				secret_religious_society_gaian = {
					ROOT = {
						set_character_flag = sr_gaian_prov_flip
					}
				}
				secret_religious_society_shinto = {
					ROOT = {
						set_character_flag = sr_shinto_prov_flip
					}
				}
				secret_religious_society_nousthreskeia = {
					ROOT = {
						set_character_flag = sr_nousthreskeia_prov_flip
					}
				}
				#I fully and completely empathize with the original devs.
				secret_religious_society_mormon = {
					ROOT = {
						set_character_flag = sr_mormon_prov_flip
					}
				}
				secret_religious_society_bickertonite = {
					ROOT = {
						set_character_flag = sr_bickertonite_prov_flip
					}
				}
				secret_religious_society_woolleyite = {
					ROOT = {
						set_character_flag = sr_woolleyite_prov_flip
					}
				}
				secret_religious_society_strangite = {
					ROOT = {
						set_character_flag = sr_strangite_prov_flip
					}
				}
				secret_religious_society_sol_invicta = {
					ROOT = {
						set_character_flag = sr_sol_invicta_prov_flip
					}
				}
				secret_religious_society_mictlantec = {
					ROOT = {
						set_character_flag = sr_mictlantec_prov_flip
					}
				}
				secret_religious_society_uahomche = {
					ROOT = {
						set_character_flag = sr_uahomche_prov_flip
					}
				}
				secret_religious_society_neomayan = {
					ROOT = {
						set_character_flag = sr_neomayan_prov_flip
					}
				}
				#you guys could have at least used a scripted effect or something
				secret_religious_society_americanist = {
					ROOT = {
						set_character_flag = sr_americanist_prov_flip
					}
				}
				secret_religious_society_hamiltonian = {
					ROOT = {
						set_character_flag = sr_hamiltonian_prov_flip
					}
				}
				secret_religious_society_jeffersonian = {
					ROOT = {
						set_character_flag = sr_jeffersonian_prov_flip
					}
				}
				secret_religious_society_libertarian = {
					ROOT = {
						set_character_flag = sr_libertarian_prov_flip
					}
				}
				secret_religious_society_consumerist = {
					ROOT = {
						set_character_flag = sr_consumerist_prov_flip
					}
				}
				secret_religious_society_monetarist = {
					ROOT = {
						set_character_flag = sr_monetarist_prov_flip
					}
				}
				secret_religious_society_atomicist = {
					ROOT = {
						set_character_flag = sr_atomicist_prov_flip
					}
				}
				secret_religious_society_aphite = {
					ROOT = {
						set_character_flag = sr_aphite_prov_flip
					}
				}
				secret_religious_society_pagan = {
					ROOT = {
						set_character_flag = sr_pagan_prov_flip
					}
				}
				secret_religious_society_revelationist_reformed = {
					ROOT = {
						set_character_flag = sr_revelationist_reformed_prov_flip
					}
				}
				secret_religious_society_revelationist = {
					ROOT = {
						set_character_flag = sr_revelationist_prov_flip
					}
				}
				secret_religious_society_chrome_cultist = {
					ROOT = {
						set_character_flag = sr_chrome_cultist_prov_flip
					}
				}
				secret_religious_society_rust_cultist = {
					ROOT = {
						set_character_flag = sr_rust_cultist_prov_flip
					}
				}
				secret_religious_society_occultist_reformed = {
					ROOT = {
						set_character_flag = sr_occultist_reformed_prov_flip
					}
				}
				secret_religious_society_occultist = {
					ROOT = {
						set_character_flag = sr_occultist_prov_flip
					}
				}
				secret_religious_society_thelemic_reformed = {
					ROOT = {
						set_character_flag = sr_thelemic_reformed_prov_flip
					}
				}
				secret_religious_society_thelemic = {
					ROOT = {
						set_character_flag = sr_thelemic_prov_flip
					}
				}
				secret_religious_society_norse_pagan_reformed = {
					ROOT = {
						set_character_flag = sr_norse_pagan_reformed_prov_flip
					}
				}
				secret_religious_society_norse_pagan = {
					ROOT = {
						set_character_flag = sr_norse_pagan_prov_flip
					}
				}
				secret_religious_society_celtic_pagan = {
					ROOT = {
						set_character_flag = sr_celtic_pagan_prov_flip
					}
				}
				secret_religious_society_celtic_pagan_reformed = {
					ROOT = {
						set_character_flag = sr_celtic_pagan_reformed_prov_flip
					}
				}
				secret_religious_society_brethren = {
					ROOT = {
						set_character_flag = sr_brethren_prov_flip
					}
				}
				secret_religious_society_jewish = {
					ROOT = {
						set_character_flag = sr_jewish_prov_flip
					}
				}
				secret_religious_society_reform = {
					ROOT = {
						set_character_flag = sr_reform_prov_flip
					}
				}
				secret_religious_society_meshichist = {
					ROOT = {
						set_character_flag = sr_meshichist_prov_flip
					}
				}
				secret_religious_society_hindu = {
					ROOT = {
						set_character_flag = sr_hindu_prov_flip
					}
				}
				secret_religious_society_traditionalist = {
					ROOT = {
						set_character_flag = sr_traditionalist_prov_flip
					}
				}
				secret_religious_society_revivalist = {
					ROOT = {
						set_character_flag = sr_revivalist_prov_flip
					}
				}
				secret_religious_society_imamite = {
					ROOT = {
						set_character_flag = sr_imamite_prov_flip
					}
				}
				secret_religious_society_qingzheng = {
					ROOT = {
						set_character_flag = sr_qingzheng_prov_flip
					}
				}
				secret_religious_society_alawiyya = {
					ROOT = {
						set_character_flag = sr_alawiyya_prov_flip
					}
				}
				secret_religious_society_orientalist = {
					ROOT = {
						set_character_flag = sr_orientalist_prov_flip
					}
				}
				secret_religious_society_misrist = {
					ROOT = {
						set_character_flag = sr_misrist_prov_flip
					}
				}
				secret_religious_society_trailwalker = {
					ROOT = {
						set_character_flag = sr_trailwalker_prov_flip
					}
				}
				secret_religious_society_trailwalker_reformed = {
					ROOT = {
						set_character_flag = sr_trailwalker_reformed_prov_flip
					}
				}
				secret_religious_society_orthodox = {
					ROOT = {
						set_character_flag = sr_orthodox_prov_flip
					}
				}
				secret_religious_society_exovedate = {
					ROOT = {
						set_character_flag = sr_exovedate_prov_flip
					}
				}
				secret_religious_society_pelagic = {
					ROOT = {
						set_character_flag = sr_pelagic_prov_flip
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3820
		
		trigger_switch = {
			on_trigger = has_character_flag
			sr_rastafarian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_rastafarian_community
					}
					religion = rastafarian
					remove_province_modifier = secret_rastafarian_community
				}
			}
			sr_voodoo_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_voodoo_community
					}
					religion = voodoo
					remove_province_modifier = secret_voodoo_community
				}
			}
			sr_santeria_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_santeria_community
					}
					religion = santeria
					remove_province_modifier = secret_santeria_community
				}
			}
			sr_candomble_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_candomble_community
					}
					religion = candomble
					remove_province_modifier = secret_candomble_community
				}
			}
			sr_espiritista_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_espiritista_community
					}
					religion = espiritista
					remove_province_modifier = secret_espiritista_community
				}
			}
			sr_espiritista_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_espiritista_reformed_community
					}
					religion = espiritista_reformed
					remove_province_modifier = secret_espiritista_reformed_community
				}
			}
			sr_peyotist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_peyotist_community
					}
					religion = peyotist
					remove_province_modifier = secret_peyotist_community
				}
			}
			sr_midewiwin_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_midewiwin_community
					}
					religion = midewiwin
					remove_province_modifier = secret_midewiwin_community
				}
			}
			sr_midewiwin_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_midewiwin_reformed_community
					}
					religion = midewiwin_reformed
					remove_province_modifier = secret_midewiwin_reformed_community
				}
			}
			sr_raven_tales_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_raven_tales_community
					}
					religion = raven_tales
					remove_province_modifier = secret_raven_tales_community
				}
			}
			sr_raven_tales_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_raven_tales_reformed_community
					}
					religion = raven_tales_reformed
					remove_province_modifier = secret_raven_tales_reformed_community
				}
			}
			sr_catholic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_catholic_community
					}
					religion = catholic
					remove_province_modifier = secret_catholic_community
				}
			}
			sr_neognostic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_neognostic_community
					}
					religion = neognostic
					remove_province_modifier = secret_neognostic_community
				}
			}
			sr_sedevacantist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_sedevacantist_community
					}
					religion = sedevacantist
					remove_province_modifier = secret_sedevacantist_community
				}
			}
			sr_nestorian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_nestorian_community
					}
					religion = nestorian
					remove_province_modifier = secret_nestorian_community
				}
			}
			sr_ursuline_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_ursuline_community
					}
					religion = ursuline
					remove_province_modifier = secret_ursuline_community
				}
			}
			sr_angeline_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_angeline_community
					}
					religion = angeline
					remove_province_modifier = secret_angeline_community
				}
			}
			sr_confederated_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_confederated_community
					}
					religion = confederated
					remove_province_modifier = secret_confederated_community
				}
			}
			sr_anabaptist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_anabaptist_community
					}
					religion = anabaptist
					remove_province_modifier = secret_anabaptist_community
				}
			}
			sr_batenburger_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_batenburger_community
					}
					religion = batenburger
					remove_province_modifier = secret_batenburger_community
				}
			}
			sr_evangelical_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_evangelical_community
					}
					religion = evangelical
					remove_province_modifier = secret_evangelical_community
				}
			}
			sr_antinomian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_antinomian_community
					}
					religion = antinomian
					remove_province_modifier = secret_antinomian_community
				}
			}
			sr_charismatic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_charismatic_community
					}
					religion = charismatic
					remove_province_modifier = secret_charismatic_community
				}
			}
			sr_postadventist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_postadventist_community
					}
					religion = postadventist
					remove_province_modifier = secret_postadventist_community
				}
			}
			sr_falling_star_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_falling_star_community
					}
					religion = falling_star
					remove_province_modifier = secret_falling_star_community
				}
			}
			sr_moravian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_moravian_community
					}
					religion = moravian
					remove_province_modifier = secret_moravian_community
				}
			}
			sr_high_church_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_high_church_community
					}
					religion = high_church
					remove_province_modifier = secret_high_church_community
				}
			}
			sr_nonconformist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_nonconformist_community
					}
					religion = nonconformist
					remove_province_modifier = secret_nonconformist_community
				}
			}
			sr_apostolic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_apostolic_community
					}
					religion = apostolic
					remove_province_modifier = secret_apostolic_community
				}
			}
			sr_sacred_heart_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_sacred_heart_community
					}
					religion = sacred_heart
					remove_province_modifier = secret_sacred_heart_community
				}
			}
			sr_gracia_divinia_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_gracia_divinia_community
					}
					religion = gracia_divinia
					remove_province_modifier = secret_gracia_divinia_community
				}
			}
			sr_cetic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_cetic_community
					}
					religion = cetic
					remove_province_modifier = secret_cetic_community
				}
			}
			sr_gaian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_gaian_community
					}
					religion = gaian
					remove_province_modifier = secret_gaian_community
				}
			}
			sr_shinto_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_shinto_community
					}
					religion = shinto
					remove_province_modifier = secret_shinto_community
				}
			}
			sr_nousthreskeia_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_nousthreskeia_community
					}
					religion = nousthreskeia
					remove_province_modifier = secret_nousthreskeia_community
				}
			}
			sr_mormon_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_mormon_community
					}
					religion = mormon
					remove_province_modifier = secret_mormon_community
				}
			}
			sr_bickertonite_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_bickertonite_community
					}
					religion = bickertonite
					remove_province_modifier = secret_bickertonite_community
				}
			}
			sr_woolleyite_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_woolleyite_community
					}
					religion = woolleyite
					remove_province_modifier = secret_woolleyite_community
				}
			}
			sr_strangite_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_strangite_community
					}
					religion = strangite
					remove_province_modifier = secret_strangite_community
				}
			}
			sr_sol_invicta_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_sol_invicta_community
					}
					religion = sol_invicta
					remove_province_modifier = secret_sol_invicta_community
				}
			}
			sr_mictlantec_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_mictlantec_community
					}
					religion = mictlantec
					remove_province_modifier = secret_mictlantec_community
				}
			}
			sr_uahomche_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_uahomche_community
					}
					religion = uahomche
					remove_province_modifier = secret_uahomche_community
				}
			}
			sr_neomayan_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_neomayan_community
					}
					religion = neomayan
					remove_province_modifier = secret_neomayan_community
				}
			}
			sr_americanist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_americanist_community
					}
					religion = americanist
					remove_province_modifier = secret_americanist_community
				}
			}
			sr_hamiltonian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hamiltonian_community
					}
					religion = hamiltonian
					remove_province_modifier = secret_hamiltonian_community
				}
			}
			sr_jeffersonian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_jeffersonian_community
					}
					religion = jeffersonian
					remove_province_modifier = secret_jeffersonian_community
				}
			}
			#thank god for hyperfocus
			sr_libertarian_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_libertarian_community
					}
					religion = libertarian
					remove_province_modifier = secret_libertarian_community
				}
			}
			sr_consumerist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_consumerist_community
					}
					religion = consumerist
					remove_province_modifier = secret_consumerist_community
				}
			}
			sr_monetarist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_monetarist_community
					}
					religion = monetarist
					remove_province_modifier = secret_monetarist_community
				}
			}
			sr_atomicist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_atomicist_community
					}
					religion = atomicist
					remove_province_modifier = secret_atomicist_community
				}
			}
			sr_aphite_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_aphite_community
					}
					religion = aphite
					remove_province_modifier = secret_aphite_community
				}
			}
			sr_pagan_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_pagan_community
					}
					religion = pagan
					remove_province_modifier = secret_pagan_community
				}
			}
			sr_revelationist_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_revelationist_reformed_community
					}
					religion = revelationist_reformed
					remove_province_modifier = secret_revelationist_reformed_community
				}
			}
			sr_revelationist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_revelationist_community
					}
					religion = revelationist
					remove_province_modifier = secret_revelationist_community
				}
			}
			sr_chrome_cultist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_chrome_cultist_community
					}
					religion = chrome_cultist
					remove_province_modifier = secret_chrome_cultist_community
				}
			}
			sr_rust_cultist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_rust_cultist_community
					}
					religion = rust_cultist
					remove_province_modifier = secret_rust_cultist_community
				}
			}
			sr_occultist_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_occultist_reformed_community
					}
					religion = occultist_reformed
					remove_province_modifier = secret_occultist_reformed_community
				}
			}
			sr_occultist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_occultist_community
					}
					religion = occultist
					remove_province_modifier = secret_occultist_community
				}
			}
			sr_thelemic_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_thelemic_reformed_community
					}
					religion = thelemic_reformed
					remove_province_modifier = secret_thelemic_reformed_community
				}
			}
			sr_thelemic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_thelemic_community
					}
					religion = thelemic
					remove_province_modifier = secret_thelemic_community
				}
			}
			sr_norse_pagan_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_norse_pagan_reformed_community
					}
					religion = norse_pagan_reformed
					remove_province_modifier = secret_norse_pagan_reformed_community
				}
			}
			sr_norse_pagan_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_norse_pagan_community
					}
					religion = norse_pagan
					remove_province_modifier = secret_norse_pagan_community
				}
			}
			sr_celtic_pagan_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_celtic_pagan_community
					}
					religion = celtic_pagan
					remove_province_modifier = secret_celtic_pagan_community
				}
			}
			sr_celtic_pagan_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_celtic_pagan_reformed_community
					}
					religion = celtic_pagan_reformed
					remove_province_modifier = secret_celtic_pagan_reformed_community
				}
			}
			sr_brethren_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_brethren_community
					}
					religion = brethren
					remove_province_modifier = secret_brethren_community
				}
			}
			sr_jewish_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_jewish_community
					}
					religion = jewish
					remove_province_modifier = secret_jewish_community
				}
			}
			sr_reform_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_reform_community
					}
					religion = reform
					remove_province_modifier = secret_reform_community
				}
			}
			sr_meshichist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_meshichist_community
					}
					religion = meshichist
					remove_province_modifier = secret_meshichist_community
				}
			}
			sr_hindu_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hindu_community
					}
					religion = hindu
					remove_province_modifier = secret_hindu_community
				}
			}
			sr_traditionalist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_traditionalist_community
					}
					religion = traditionalist
					remove_province_modifier = secret_traditionalist_community
				}
			}
			sr_revivalist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_revivalist_community
					}
					religion = revivalist
					remove_province_modifier = secret_revivalist_community
				}
			}
			sr_imamite_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_imamite_community
					}
					religion = imamite
					remove_province_modifier = secret_imamite_community
				}
			}
			sr_qingzheng_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_qingzheng_community
					}
					religion = qingzheng
					remove_province_modifier = secret_qingzheng_community
				}
			}
			sr_alawiyya_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_alawiyya_community
					}
					religion = alawiyya
					remove_province_modifier = secret_alawiyya_community
				}
			}
			sr_orientalist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_orientalist_community
					}
					religion = orientalist
					remove_province_modifier = secret_orientalist_community
				}
			}
			sr_misrist_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_misrist_community
					}
					religion = misrist
					remove_province_modifier = secret_misrist_community
				}
			}
			sr_trailwalker_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_trailwalker_community
					}
					religion = trailwalker
					remove_province_modifier = secret_trailwalker_community
				}
			}
			sr_trailwalker_reformed_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_trailwalker_reformed_community
					}
					religion = trailwalker_reformed
					remove_province_modifier = secret_trailwalker_reformed_community
				}
			}
			sr_orthodox_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_orthodox_community
					}
					religion = orthodox
					remove_province_modifier = secret_orthodox_community
				}
			}
			sr_exovedate_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_exovedate_community
					}
					religion = exovedate
					remove_province_modifier = secret_exovedate_community
				}
			}
			sr_pelagic_prov_flip = { 
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_pelagic_community
					}
					religion = pelagic
					remove_province_modifier = secret_pelagic_community
				}
			}
		}
		clr_character_flag = sr_rastafarian_prov_flip
		clr_character_flag = sr_voodoo_prov_flip
		clr_character_flag = sr_santeria_prov_flip
		clr_character_flag = sr_candomble_prov_flip
		clr_character_flag = sr_espiritista_prov_flip
		clr_character_flag = sr_espiritista_reformed_prov_flip
		clr_character_flag = sr_peyotist_prov_flip
		clr_character_flag = sr_midewiwin_prov_flip
		clr_character_flag = sr_midewiwin_reformed_prov_flip
		clr_character_flag = sr_raven_tales_prov_flip
		clr_character_flag = sr_raven_tales_reformed_prov_flip
		clr_character_flag = sr_catholic_prov_flip
		clr_character_flag = sr_neognostic_prov_flip
		clr_character_flag = sr_sedevacantist_prov_flip
		clr_character_flag = sr_nestorian_prov_flip
		clr_character_flag = sr_ursuline_prov_flip
		clr_character_flag = sr_angeline_prov_flip
		clr_character_flag = sr_confederated_prov_flip
		clr_character_flag = sr_anabaptist_prov_flip
		clr_character_flag = sr_batenburger_prov_flip
		clr_character_flag = sr_evangelical_prov_flip
		clr_character_flag = sr_antinomian_prov_flip
		clr_character_flag = sr_charismatic_prov_flip
		clr_character_flag = sr_postadventist_prov_flip
		clr_character_flag = sr_falling_star_prov_flip
		clr_character_flag = sr_moravian_prov_flip
		clr_character_flag = sr_high_church_prov_flip
		clr_character_flag = sr_nonconformist_prov_flip
		clr_character_flag = sr_apostolic_prov_flip
		clr_character_flag = sr_sacred_heart_prov_flip
		clr_character_flag = sr_gracia_divina_prov_flip
		clr_character_flag = sr_cetic_prov_flip
		clr_character_flag = sr_gaian_prov_flip
		clr_character_flag = sr_shinto_prov_flip
		clr_character_flag = sr_nousthreskeia_prov_flip
		clr_character_flag = sr_mormon_prov_flip
		clr_character_flag = sr_bickertonite_prov_flip
		clr_character_flag = sr_woolleyite_prov_flip
		clr_character_flag = sr_strangite_prov_flip
		clr_character_flag = sr_sol_invicta_prov_flip
		clr_character_flag = sr_mictlantec_prov_flip
		clr_character_flag = sr_uahomche_prov_flip
		clr_character_flag = sr_neomayan_prov_flip
		clr_character_flag = sr_americanist_prov_flip
		clr_character_flag = sr_hamiltonian_prov_flip
		clr_character_flag = sr_jeffersonian_prov_flip
		clr_character_flag = sr_libertarian_prov_flip
		clr_character_flag = sr_consumerist_prov_flip
		clr_character_flag = sr_monetarist_prov_flip
		clr_character_flag = sr_atomicist_prov_flip
		clr_character_flag = sr_aphite_prov_flip
		clr_character_flag = sr_pagan_prov_flip
		clr_character_flag = sr_revelationist_reformed_prov_flip
		clr_character_flag = sr_revelationist_prov_flip
		clr_character_flag = sr_chrome_cultist_prov_flip
		clr_character_flag = sr_rust_cultist_prov_flip
		clr_character_flag = sr_occultist_reformed_prov_flip
		clr_character_flag = sr_occultist_prov_flip
		clr_character_flag = sr_thelemic_reformed_prov_flip
		clr_character_flag = sr_thelemic_prov_flip
		clr_character_flag = sr_norse_pagan_reformed_prov_flip
		clr_character_flag = sr_norse_pagan_prov_flip
		clr_character_flag = sr_celtic_pagan_prov_flip
		clr_character_flag = sr_celtic_pagan_reformed_prov_flip
		clr_character_flag = sr_brethren_prov_flip
		clr_character_flag = sr_jewish_prov_flip
		clr_character_flag = sr_reform_prov_flip
		clr_character_flag = sr_meshichist_prov_flip
		clr_character_flag = sr_hindu_prov_flip
		clr_character_flag = sr_traditionalist_prov_flip
		clr_character_flag = sr_revivalist_prov_flip
		clr_character_flag = sr_imamite_prov_flip
		clr_character_flag = sr_qingzheng_prov_flip
		clr_character_flag = sr_alawiyya_prov_flip
		clr_character_flag = sr_orientalist_prov_flip
		clr_character_flag = sr_misrist_prov_flip
		clr_character_flag = sr_trailwalker_prov_flip
		clr_character_flag = sr_trailwalker_reformed_prov_flip
		clr_character_flag = sr_orthodox_prov_flip
		clr_character_flag = sr_exovedate_prov_flip
		clr_character_flag = sr_pelagic_prov_flip
	}
}

# openly_adopt_faith - Inform lieges unless they're part of the cult flipping
character_event = {
	id = MNM.3830
	desc = EVTDESC_MNM_3830
	picture = GFX_evt_society_joining
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_character_flag = currently_part_of_secret_religion_uncovering }
	}
	
	option = {
		name = EVTOPTA_MNM_3830
	}
}

###INTERACTIONS###

#Interaction: I am so stressed
character_event = {
	id = MNM.3500
	hide_window = yes
	is_triggered_only = yes

	min_age = 16
	only_playable = yes
	only_capable = yes
	prisoner = no
   
	trigger = {
		OR = {
			trait = stressed
			trait = depressed
		}
		society_member_of = secret_religious_cult

		society = {
			any_society_member = {
				ai = yes
				block_general_event_trigger = no
				opinion = { who = ROOT value = 20 }
				reverse_opinion = { who = ROOT value = 20 }
				NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
				NOT = { is_lover = ROOT }
				OR = {
					is_friend = ROOT 
					AND = {
						root_attraction_trigger = yes
						NOT = { is_close_relative = ROOT }
					}
				}
			}
		}
	}

	immediate = {
		society = {
			random_society_member = {
				limit = {
					ai = yes
					block_general_event_trigger = no
					opinion = { who = ROOT value = 20 }
					reverse_opinion = { who = ROOT value = 20 }
					NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
					NOT = { is_lover = ROOT }
					OR = {
						is_friend = ROOT 
						AND = {
							root_attraction_trigger = yes
							NOT = { is_close_relative = ROOT }
						}
					}
					is_within_diplo_range = ROOT
				}
				save_event_target_as = supportive_sr_member
			}
			random_society_member = {
				limit = {
					ai = yes
					block_general_event_trigger = no
					opinion = { who = ROOT value = 20 }
					reverse_opinion = { who = ROOT value = 20 }
					NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
					NOT = { is_lover = ROOT }
					OR = {
						is_friend = ROOT 
						AND = {
							root_attraction_trigger = yes
							NOT = { is_close_relative = ROOT }
						}
					}
					same_realm = ROOT
				}
				save_event_target_as = supportive_sr_member
			}
			random_society_member = {
				limit = {
					ai = yes
					block_general_event_trigger = no
					opinion = { who = ROOT value = 20 }
					reverse_opinion = { who = ROOT value = 20 }
					NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
					NOT = { is_lover = ROOT }
					OR = {
						is_friend = ROOT 
						AND = {
							root_attraction_trigger = yes
							NOT = { is_close_relative = ROOT }
						}
					}
					at_location = ROOT
				}
				save_event_target_as = supportive_sr_member
			}
		}
		event_target:supportive_sr_member = { character_event = { id = MNM.3501 } }
	}
}


character_event = {
	id = MNM.3501
	hide_window = yes
	is_triggered_only = yes
	immediate = { FROM = { character_event = { id = MNM.3502 } } }
}   

#I am stessed, do I find support?
character_event = {
	id = MNM.3502
	desc = EVTDESC_MNM_3502
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes

	#Friend
	option = { 
		trigger = { NOT = { is_friend = FROM } }
		name = EVTOPTA_MNM_3502
		add_friend = FROM

		ai_chance = { factor = 100 }
	}

	#Lover?
	option = {
		trigger = {
			FROM = { root_attraction_trigger = yes }
			NOT = { is_close_relative = FROM }
		}
		name = EVTOPTB_MNM_3502
		custom_tooltip = { text = EVTOPTB_MNM_3502_TT }

		hidden_effect = { FROM = { character_event = { id = MNM.6906 days = 3 } } }

		ai_chance = {
			factor = 10
			modifier = {
				factor = 10
				OR = {
					trait = lustful
					trait = seducer
					trait = seductress
					trait = gregarious
					trait = socializer
				}
			}
			modifier = {
				factor = 5
				FROM = { has_attractive_trait_trigger = yes }
			}
		}
	}
	
	#Not lover
	option = {
		trigger = {
			FROM = { root_attraction_trigger = yes }
			NOT = { is_close_relative = FROM }
			is_friend = FROM
		}

		name = EVTOPTA_MNM_3502
		custom_tooltip = { text = EVTOPTC_MNM_3502_TT }

		ai_chance = { factor = 100 }
	}
	
	after = {
		if = {
			limit = { trait = stressed }
			remove_trait = stressed
		}
		if = {
			limit = { trait = depressed }
			remove_trait = depressed
		}
		if = {
			limit = { FROM = { trait = stressed } }
			remove_trait = stressed
		}
		if = {
			limit = { FROM = { trait = depressed } }
			remove_trait = depressed
		}
	}
}

#Interaction: Get help from another member with problematic trait
character_event = {
	id =  MNM.3505
	hide_window = yes

	is_triggered_only = yes

	min_age = 16
	only_playable = yes
	only_capable = yes
	prisoner = no

	trigger = {
		society_member_of = secret_religious_cult
		check_variable = { which = visibility_value value = 1 }
		block_general_event_trigger = no
		OR = {
			trait = honest
			trait = slothful
			trait = wroth
			trait = trusting
			NOT = { intrigue = 8 }
		}
	}

	immediate = {
		clr_character_flag = sr_too_honest
		clr_character_flag = sr_too_wroth
		clr_character_flag = sr_too_slothful
		clr_character_flag = sr_too_trusting
		clr_character_flag = sr_too_indiscreet

		random_list = {
			20 = { #Root is too honest
				modifier = {
					factor = 0
					NAND = {
						trait = honest
						society = {
							any_society_member = {
								block_general_event_trigger = no 
								NOT = { trait = honest }
								NOT = { character = ROOT }
							}
						}
					}
				}
				set_character_flag = sr_too_honest

				society = {
					random_society_member = {
						limit = {
							block_general_event_trigger = no 
							NOT = { trait = honest }
							NOT = { character = ROOT }
						}
						character_event = { id = MNM.3506 days = 3 }
					}
				}
			}
			20 = { #Root is too slothful
				modifier = {
					factor = 0
					NAND = {
						trait = slothful
						society = {
							any_society_member = {
								block_general_event_trigger = no 
								NOT = { trait = slothful }
								NOT = { character = ROOT }
							}
						}
					}
				}
				set_character_flag = sr_too_slothful

				society = {
					random_society_member = {
						limit = {
							block_general_event_trigger = no 
							NOT = { trait = slothful }
							NOT = { character = ROOT }
						}
						character_event = { id = MNM.3506 days = 3 }
					}
				}
			}
			20 = { #Root is too wroth
				modifier = {
					factor = 0
					NAND = {
						trait = wroth
						society = {
							any_society_member = {
								block_general_event_trigger = no 
								NOT = { trait = wroth }
								NOT = { character = ROOT }
							}
						}
					}
				}
				set_character_flag = sr_too_wroth

				society = {
					random_society_member = {
						limit = {
							block_general_event_trigger = no 
							NOT = { trait = wroth }
							NOT = { character = ROOT }
						}
						character_event = { id = MNM.3506 days = 3 }
					}
				}
			}
			20 = { #Root is too trusting
				modifier = {
					factor = 0
					NAND = {
						trait = trusting
						society = {
							any_society_member = {
								block_general_event_trigger = no 
								NOT = { trait = trusting }
								NOT = { character = ROOT }
							}
						}
					}
				}
				set_character_flag = sr_too_trusting

				society = {
					random_society_member = {
						limit = {
							block_general_event_trigger = no 
							NOT = { trait = trusting }
							NOT = { character = ROOT }
						}
						character_event = { id = MNM.3506 days = 3 }
					}
				}
			}
			20 = { #Root is too indiscreet
				modifier = {
					factor = 0
					NAND = {
						intrigue = 8
						society = {
							any_society_member = {
								block_general_event_trigger = no 
								intrigue = 12
								NOT = { character = ROOT }
							}
						}
					}
				}
				set_character_flag = sr_too_indiscreet

				society = {
					random_society_member = {
						limit = {
							block_general_event_trigger = no 
							intrigue = 12
							NOT = { character = ROOT }
						}
						character_event = { id = MNM.3506 days = 3 }
					}
				}
			}
		}
	}
}

#This person is too suspicious, what do?
character_event = {
	id = MNM.3506
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	desc = {
		trigger = { FROM = { has_character_flag = sr_too_honest } }
		text = EVTDESC_MNM_3506_A
	}
	desc = {
		trigger = { FROM = { has_character_flag = sr_too_wroth } }
		text = EVTDESC_MNM_3506_B
	}
	desc = {
		trigger = { FROM = { has_character_flag = sr_too_slothful } }
		text = EVTDESC_MNM_3506_C
	}
	desc = {
		trigger = { FROM = { has_character_flag = sr_too_trusting } }
		text = EVTDESC_MNM_3506_D
	}
	desc = {
		trigger = { FROM = { has_character_flag = sr_too_indiscreet } }
		text = EVTDESC_MNM_3506_E
	}

	is_triggered_only = yes

	immediate = {
		clr_character_flag = free_help
		clr_character_flag = help_for_cost	  
	}

	#Offer help freely
	option = { 
		name = EVTOPTA_MNM_3506
		custom_tooltip = { text = EVTOPTA_MNM_3506_TT }

		hidden_effect = {
			set_character_flag = free_help
			FROM = { character_event = { id = MNM.3507 } }
		}

		ai_chance = { 
			factor = 1 
			modifier = {
				factor = 3
				OR = {
					trait = content
					is_benevolent_trigger = yes
					opinion = { who = FROM value = 50 }
				}
			}
		}
	}

	#Offer help for a cost
	option = {
		trigger = { FROM = { has_society_currency_minor_trigger = yes } }
		name = EVTOPTB_MNM_3506
		custom_tooltip = { text = EVTOPTB_MNM_3506_TT }

		hidden_effect = {
			set_character_flag = help_for_cost
			FROM = { character_event = { id = MNM.3507 } }
		}

		ai_chance = { 
			factor = 1 
			modifier = {
				factor = 3
				OR = {
					trait = ambitious
					trait = greedy
					is_evil_trigger = yes
					intrigue = 15
				}
			}
		}
	}

	#Do not help
	option = {
		name = EVTOPTC_MNM_3506
		custom_tooltip = { text = EVTOPTC_MNM_3506_TT }		 

		ai_chance = { factor = 0 }

		hidden_effect = {
		   FROM = {
				clr_character_flag = sr_too_honest
				clr_character_flag = sr_too_wroth
				clr_character_flag = sr_too_slothful
				clr_character_flag = sr_too_trusting
				clr_character_flag = sr_too_indiscreet
			} 
		}
	}
}

#I am offered help to hide my true religion
character_event = {	 
	id = MNM.3507
	picture = GFX_evt_shady_meeting
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	trigger = { society_member_of = secret_religious_cult }

	desc = {
		trigger = { has_character_flag = sr_too_honest }
		text = EVTDESC_MNM_3507_A
	}
	desc = {
		trigger = { has_character_flag = sr_too_wroth }
		text = EVTDESC_MNM_3507_B
	}
	desc = {
		trigger = { has_character_flag = sr_too_slothful }
		text = EVTDESC_MNM_3507_C
	}
	desc = {
		trigger = { has_character_flag = sr_too_trusting }
		text = EVTDESC_MNM_3507_D
	}
	desc = {
		trigger = { has_character_flag = sr_too_indiscreet }
		text = EVTDESC_MNM_3507_E
	}

	option = { 
		trigger = { FROM = { has_character_flag = free_help } }
		name = EVTOPTA_MNM_3507
		custom_tooltip = { text = EVTOPTA_MNM_3507_TT }

		random_list = {
			50 = {
				modifier = { FROM = { intrigue = 12 } factor = 1.2 }
				modifier = { FROM = { intrigue = 14 } factor = 1.2 }
				modifier = { FROM = { intrigue = 16 } factor = 1.2 }
				modifier = { FROM = { intrigue = 18 } factor = 1.2 }
				modifier = { FROM = { intrigue = 20 } factor = 1.2 }

				custom_tooltip = { text = EVTOPT_MNM_3507_SUCCESS_TT }
				hidden_effect = { FROM = { character_event = { id = MNM.3508 days = 21 } } }

				tooltip = {
					trigger_switch = {
						on_trigger = has_character_flag 
						sr_too_honest	   = { remove_trait = honest }
						sr_too_wroth		= { remove_trait = wroth }
						sr_too_slothful	 = { remove_trait = slothful }
						sr_too_trusting	 = { remove_trait = trusting }
						sr_too_indiscreet   = { change_intrigue = 2 }
					}
				}
			}
			50 = {
				custom_tooltip = { text = EVTOPT_MNM_3507_FAIL_TT }
				hidden_effect = { FROM = { character_event = { id = MNM.3509 days = 21 } } }
			}
		}

		reverse_opinion = {
			who = FROM
			modifier = opinion_took_my_advice
			years = 5
		}

		ai_chance = {
			factor = 10
			modifier = { FROM = { intrigue = 12 } factor = 1.2 }
			modifier = { FROM = { intrigue = 14 } factor = 1.2 }
			modifier = { FROM = { intrigue = 16 } factor = 1.2 }
			modifier = { FROM = { intrigue = 18 } factor = 1.2 }
			modifier = { FROM = { intrigue = 20 } factor = 1.2 }
		}
	}

	option = {
		trigger = { FROM = { has_character_flag = help_for_cost } }
		name = EVTOPTB_MNM_3507
		custom_tooltip = { text = EVTOPTB_MNM_3507_TT }

		detract_society_currency_minor_effect = yes

		random_list = {
			50 = {
				modifier = { FROM = { intrigue = 12 } factor = 1.2 }
				modifier = { FROM = { intrigue = 14 } factor = 1.2 }
				modifier = { FROM = { intrigue = 16 } factor = 1.2 }
				modifier = { FROM = { intrigue = 18 } factor = 1.2 }
				modifier = { FROM = { intrigue = 20 } factor = 1.2 }

				custom_tooltip = { text = EVTOPT_MNM_3507_SUCCESS_TT }
				hidden_effect = { FROM = { character_event = { id = MNM.3508 days = 21 } } }

				tooltip = {
					trigger_switch = {
						on_trigger = has_character_flag 
						sr_too_honest	   = { remove_trait = honest }
						sr_too_wroth		= { remove_trait = wroth }
						sr_too_slothful	 = { remove_trait = slothful }
						sr_too_trusting	 = { remove_trait = trusting }
						sr_too_indiscreet   = { change_intrigue = 2 }
					}
				}
			}
			50 = {
				custom_tooltip = { text = EVTOPT_MNM_3507_FAIL_TT }
				hidden_effect = { FROM = { character_event = { id = MNM.3509 days = 21 } } }
			}
		}

		reverse_opinion = {
			who = FROM
			modifier = opinion_took_my_advice
			years = 5
		}

		ai_chance = {
			factor = 10
			modifier = { FROM = { intrigue = 12 } factor = 1.2 }
			modifier = { FROM = { intrigue = 14 } factor = 1.2 }
			modifier = { FROM = { intrigue = 16 } factor = 1.2 }
			modifier = { FROM = { intrigue = 18 } factor = 1.2 }
			modifier = { FROM = { intrigue = 20 } factor = 1.2 }
		}
	}
	
	option = {
		name = EVTOPTC_MNM_3507

		hidden_effect = { FROM = { character_event = { id = MNM.3510 days = 7 } } }

		reverse_opinion = {
			who = FROM
			modifier = opinion_did_not_take_my_advice
			years = 5
		}

		ai_chance = {
			factor = 5
		}
	}
}

#Successful help - giver
character_event = {
	id = MNM.3508
	desc = EVTDESC_MNM_3508
	picture = GFX_evt_shady_meeting
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes

	option = { 
		name = EXCELLENT
		custom_tooltip = { text = EVTOPTA_MNM_3508_TT }

		if = {
			limit = { has_character_flag = help_for_cost }
			add_society_currency_medium_effect = yes
		}

		tooltip = {
			FROM  = {
				trigger_switch = {
					on_trigger = has_character_flag 
					sr_too_honest	   = { remove_trait = honest }
					sr_too_wroth		= { remove_trait = wroth }
					sr_too_slothful	 = { remove_trait = slothful }
					sr_too_trusting	 = { remove_trait = trusting }
					sr_too_indiscreet   = { change_intrigue = 2 }
				}
			}
		}

		hidden_effect = {
			clr_character_flag = free_help
			clr_character_flag = help_for_cost
			FROM  = { character_event = { id = MNM.3511 } }
		}
	}
}

#Unsuccessful help - giver
character_event = {
	id = MNM.3509
	desc = EVTDESC_MNM_3509
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3509

		if = {
			limit = { has_character_flag = help_for_cost }
			add_society_currency_medium_effect = yes
		}

		hidden_effect = {
			clr_character_flag = free_help
			clr_character_flag = help_for_cost
			FROM  = { character_event = { id = MNM.3512 } }
		}
	}
}

#They didn't want my help 
character_event = {
	id = MNM.3510
	desc = EVTDESC_MNM_3510
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3509

		opinion = {
			who = FROM
			modifier = opinion_did_not_take_my_advice
			years = 5
		}

		hidden_effect = { 
			clr_character_flag = free_help
			clr_character_flag = help_for_cost
			FROM = {
				clr_character_flag = sr_too_honest
				clr_character_flag = sr_too_wroth
				clr_character_flag = sr_too_slothful
				clr_character_flag = sr_too_trusting
				clr_character_flag = sr_too_indiscreet
			}
		}
	}
}

#Successful help - receiver
character_event = {
	id = MNM.3511
	desc = EVTDESC_MNM_3511
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes

	option = { 
		name = EVTOPTA_MNM_3511
		custom_tooltip = { text = EVTOPTA_MNM_3511_TT }

		trigger_switch = {
			on_trigger = has_character_flag 
			sr_too_honest	   = { remove_trait = honest }
			sr_too_wroth		= { remove_trait = wroth }
			sr_too_slothful	 = { remove_trait = slothful }
			sr_too_trusting	 = { remove_trait = trusting }
			sr_too_indiscreet   = { change_intrigue = 2 }
		}

		hidden_effect = {
			decrease_visibility_effect = yes
			clr_character_flag = sr_too_honest
			clr_character_flag = sr_too_wroth
			clr_character_flag = sr_too_slothful
			clr_character_flag = sr_too_trusting
			clr_character_flag = sr_too_indiscreet
		}
	}
}


#Unsuccessful help - receiver
character_event = {
	id = MNM.3512
	desc = EVTDESC_MNM_3512
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_diplomacy

	trigger = { society_member_of = secret_religious_cult }

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3512

		hidden_effect = {
			clr_character_flag = sr_too_honest
			clr_character_flag = sr_too_wroth
			clr_character_flag = sr_too_slothful
			clr_character_flag = sr_too_trusting
			clr_character_flag = sr_too_indiscreet
		}
	}
}



###MISC###

#Misc: convert child to secret religion
#Ping event from child
character_event = {
	id = MNM.3429
	hide_window = yes
	
	is_triggered_only = yes

	trigger = {
		OR = {
			AND = {
				educator = { 
					has_secret_religion_trait_trigger = yes 
					NOT = { society_member_of = secret_religious_cult }
					any_ward = { character = PREV }
				}
			}
			guardian = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
			mother = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
			father = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
		}
	}

	immediate = {
		educator = {
			if = {
				limit = { has_secret_religion_trait_trigger = yes }
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		guardian = {
			if = {
				limit = { has_secret_religion_trait_trigger = yes }
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		mother = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_playable = yes
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		father = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_playable = yes
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		mother = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		father = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}
	}
	
	option = {
		event_target:secret_religion_influencer = { character_event = { id = MNM.3430 days = 3 random = 9 } }
	}
}

#Should I read my holy scripture to child?
character_event = {
	id = MNM.3430
	desc = EVTDESC_MNM_3430
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	trigger = {
		has_secret_religion_trait_trigger = yes
		FROM = { 
			has_secret_religion_trait_trigger = no 
			has_prevs_secret_religion_truly_trigger = no
		}
	}

	immediate = {
	
	}

	#Yes
	option = { 
		name = EVTOPTA_MNM_3430
		custom_tooltip = { text = EVTOPTA_MNM_3430_TT }

		hidden_effect = {
			save_event_target_as = secret_religion_inductor
			FROM = {
				character_event = { id = MNM.3431 days = 1 }
			}
		}
		ai_chance = { 
			factor = 100 
			modifier = { trait = brave factor = 3 }
		}
	}

	#No
	option = {
		name = EVTOPTB_MNM_3430
		custom_tooltip = { text = EVTOPTB_MNM_3430_TT }

		ai_chance = { 
			factor = 20 
			modifier = { trait = craven factor = 5 }
			modifier = { trait = paranoid factor = 5 }
			modifier = { trait = arbitrary factor = 5 }
		}
	}
}

#Child gets holy scripture read to them, do they like it?
character_event = { 
	id = MNM.3431
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = { FROM = { shares_true_religion_group_with_prev_trigger = no } }
		text = EVTDESC_MNM_3431_A
	}
	desc = {
		trigger = { FROM = { shares_true_religion_group_with_prev_trigger = yes } }
		text = EVTDESC_MNM_3431_B
	}

	is_triggered_only = yes
 
 	#tell me more
   	option = {
		name = EVTOPTC_MNM_3431

		FROM = { ROOT = { add_prevs_secret_religion_trait_effect = yes } }

		hidden_effect = { FROM = { character_event = { id = MNM.3432 days = 14 } } }

		ai_chance = {
			factor = 20
			modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
		}
	}

	#interesting
	option = { 
		trigger = { #Can get sympathy
			FROM = { ROOT = { has_sympathy_for_true_religion_of_prev_trigger = no } }
			FROM = { shares_true_religion_group_with_prev_trigger = no }
		}
		name = EVTOPTA_MNM_3431
		
		FROM = { ROOT = { add_sympathy_for_prevs_true_religion_effect = yes } }
		
		hidden_effect = { FROM = { character_event = { id = MNM.3433 days = 14 } } }

		ai_chance = {
			factor = 40
			modifier = { mother = { character = FROM } factor = 1.4 }
			modifier = { father = { character = FROM } factor = 1.4 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.2 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.2 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.2 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.1 }
		}
	}

	#this is stupid!
	option = {
		name = EVTOPTB_MNM_3431

		hidden_effect = { FROM = { character_event = { id = MNM.3434 days = 14 } } }

		ai_chance = {
			factor = 40
			modifier = { NOT = { opinion = { who = FROM value = 0 } } factor = 1.5 }
			modifier = { NOT = { opinion = { who = FROM value = -20 } } factor = 1.5 }
			modifier = { NOT = { opinion = { who = FROM value = -40 } } factor = 1.5 }
			modifier = { OR = { trait = zealous trait = idolizer } factor = 5 }
			modifier = { OR = { trait = willful trait = stubborn } factor = 1.5 }
			modifier = { OR = { trait = cynical trait = curious } factor = 1.5 }
			modifier = { FROM = { NOT = { diplomacy = 8 } } factor = 1.5 }
			modifier = { FROM = { NOT = { diplomacy = 6 } } factor = 1.5 }
		}
	}
}

#They seemed to like the holy scripture!
character_event = {
	id = MNM.3432
	desc = EVTDESC_MNM_3432
	picture = GFX_evt_child_reading
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { 
		name = EVTOPTA_MNM_3432
		tooltip = { FROM = { add_prevs_secret_religion_trait_effect = yes } }
	}
}

#They were intrigued by the holy scripture
character_event = {
	id = MNM.3433
	desc = EVTDESC_MNM_3433
	picture = GFX_evt_child_reading
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { 
		name = EVTOPTA_MNM_3433
		tooltip = { FROM = { add_sympathy_for_prevs_true_religion_effect = yes } }
	}
}

#They weren't impressed...
character_event = {
	id = MNM.3434
	desc = EVTDESC_MNM_3434
	picture = GFX_evt_child_play
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	#Try anyway
	option = { 
		trigger = {
			OR = {
				trait = patient
				NOT = { has_character_modifier = out_of_patience }
			}
		}

		name = EVTOPTA_MNM_3434

		tooltip = {
			random_list = {
				60 = { #Success
					modifier = { mother = { character = ROOT } factor = 1.6 }
					modifier = { father = { character = ROOT } factor = 1.6 }
					modifier = { opinion = { who = ROOT value = 30 } factor = 1.5 }
					modifier = { opinion = { who = ROOT value = 50 } factor = 1.5 }
					modifier = { opinion = { who = ROOT value = 70 } factor = 1.6 }
					modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
					modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
					modifier = { ROOT = { diplomacy = 10 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 12 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 14 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 16 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 18 } factor = 1.2 }

					FROM = { add_prevs_secret_religion_trait_effect = yes }		
				}
				40 = { #Fail
					modifier = { NOT = { opinion = { who = ROOT value = 0 } } factor = 1.5 }
					modifier = { NOT = { opinion = { who = ROOT value = -20 } } factor = 1.5 }
					modifier = { NOT = { opinion = { who = ROOT value = -40 } } factor = 1.5 }
					modifier = { OR = { trait = zealous trait = idolizer } factor = 5 }
					modifier = { OR = { trait = willful trait = stubborn } factor = 1.5 }
					modifier = { OR = { trait = cynical trait = curious } factor = 1.5 }
					modifier = { ROOT = { NOT = { diplomacy = 8 } } factor = 1.5 }
					modifier = { ROOT = { NOT = { diplomacy = 6 } } factor = 1.5 }

					FROM = {
						if = {
							limit = {
								NOT = { trait = zealous }
								NOT = { has_dlc = Zeus }
							}
							add_trait = zealous
						}
						if = {
							limit = {
								NOT = { trait = idolizer }
								has_dlc = Zeus
							}
							add_trait = idolizer
						}
						add_rival = ROOT
					}
				}
			}
		}

		if = {
			limit = { NOT = { trait = patient } }
			add_character_modifier = {
				name = out_of_patience 
				years = 3
			}
		}

		hidden_effect = {
			FROM = { character_event = { id = MNM.3435 days = 1 } }
		}

		ai_chance = { 
			factor = 20
			modifier = { any_child = { character = ROOT } factor = 5 }
			modifier = { current_heir = { character = ROOT } factor = 5 }
		}
	}

	#Let it be
	option = {
		name = EVTOPTB_MNM_3434

		ai_chance = { 
			factor = 80
		}
	}
}

#They're trying to force the scripture on me again
character_event = {
	id = MNM.3435
	desc = EVTDESC_MNM_3435
	picture = GFX_evt_child_reading
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = { 
		name = EVTOPTA_MNM_3435

		FROM = { ROOT = { add_prevs_secret_religion_trait_effect = yes } }

		hidden_effect = { FROM = { character_event = { id = MNM.3436 days = 14 } } }

		ai_chance = {
			factor = 60
			modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
		}
	}

	option = {
		name = EVTOPTB_MNM_3435

		if = {
			limit = {
				NOT = { trait = zealous }
				NOT = { has_dlc = Zeus }
			}
			add_trait = zealous
		}
		if = {
			limit = {
				NOT = { trait = idolizer }
				has_dlc = Zeus
			}
			add_trait = idolizer
		}

		add_rival = FROM

		hidden_effect = { FROM = { character_event = { id = MNM.3437 days = 14 } } }

		ai_chance = {
			factor = 60
			modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
		}
	}
}

#It worked out, in the end!
character_event = {
	id = MNM.3436
	desc = EVTDESC_MNM_3436
	picture = GFX_evt_child_reading
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { 
		name = EVTOPTA_MNM_3436
		tooltip = { FROM = { add_prevs_secret_religion_trait_effect = yes } }
	}
}

#I failed and now they are zealous
character_event = {
	id = MNM.3437
	desc = EVTDESC_MNM_3437
	picture = GFX_evt_child_sword
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { 
		name = EVTOPTA_MNM_3412
		tooltip = {
			FROM  =	{
				if = {
					limit = {
						NOT = { trait = zealous }
						NOT = { has_dlc = Zeus }
					}
					add_trait = zealous
				}
				if = {
					limit = {
						NOT = { trait = idolizer }
						has_dlc = Zeus
					}
					add_trait = idolizer
				}

				add_rival = ROOT
			}
		}
	}
}

#Parent/educator/guardian ping event for the decision
character_event = {
	id = MNM.3438
	hide_window = yes
	is_triggered_only = yes
	immediate = { FROM = { character_event = { id = MNM.3431 } } }
}

# personally_openly_adopt_faith - inform liege
character_event = {
	id = MNM.3840
	desc = EVTDESC_MNM_3840
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3840
	}
}

# prepare_grounds - safety flag clear
character_event = {
	id = MNM.3849
	hide_window = yes
	is_triggered_only = yes
	immediate = { clr_character_flag = preparing_grounds_in_@FROM }
}

# prepare_grounds - Start progress
character_event = {
	id = MNM.3850
	desc = EVTDESC_MNM_3850
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3850
		custom_tooltip = {
			text = EVTTOOLTIP_MNM_3850
			hidden_effect = {
				random_list = {
					20 = {
						modifier = {
							factor = 0.1
							event_target:target_province = {
								holder_scope = {
									NOT = {
										character = ROOT
									}
								}
							}
						}
						modifier = {
							factor = 1.1
							diplomacy = 12
						}
						modifier = {
							factor = 1.1
							diplomacy = 14
						}
						modifier = {
							factor = 1.1
							diplomacy = 16
						}
						modifier = {
							factor = 1.1
							diplomacy = 18
						}
						modifier = {
							factor = 1.1
							diplomacy = 20
						}
						
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3860 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3860 days = 300 random = 50 }
						}
					}
					50 = {
						modifier = {
							factor = 0.2
							event_target:target_province = {
								holder_scope = {
									NOT = {
										character = ROOT
									}
								}
							}
						}
						modifier = {
							factor = 1.1
							diplomacy = 12
						}
						modifier = {
							factor = 1.1
							diplomacy = 14
						}
						modifier = {
							factor = 1.1
							diplomacy = 16
						}
						modifier = {
							factor = 1.1
							diplomacy = 18
						}
						modifier = {
							factor = 1.1
							diplomacy = 20
						}
						
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3870 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3870 days = 300 random = 50 }
						}
					}
					30 = {
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3880 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3880 days = 300 random = 50 }
						}
					}
				}
			}
		}
		character_event = { id = MNM.3859 days = 30 }
	}
}

character_event = {
	id = MNM.3858
	desc = EVTDESC_MNM_3858
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3858
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = { id = quest_secret_religions_societies_prepare_grounds failure = yes }
		}
		clear_delayed_event = { id = MNM.3849 }
		clear_delayed_event = { id = MNM.3859 }
		clr_character_flag = preparing_grounds_in_@event_target:target_province
	}
}

character_event = {
	id = MNM.3859
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				#OR = {
				#	NOT = {
				#		society = {
				#			event_target:original_society = {
				#				society_type = PREV
				#			}
				#		}
				#	}
					event_target:target_province = {
						county = {
							holder_scope = {
								NOT = { 
									same_realm = ROOT
								}
							}
						}
					}
				#}
			}
			clear_delayed_event = { id = MNM.3860 }
			clear_delayed_event = { id = MNM.3870 }
			clear_delayed_event = { id = MNM.3880 }
			clear_delayed_event = { id = MNM.3890 }
			character_event = { id = MNM.3858 }
			break = yes
		}
		repeat_event = { id = MNM.3859 days = 30 }
	}
}

character_event = {
	id = MNM.3860
	desc = EVTDESC_MNM_3860
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3860
		hidden_effect = {
			character_event = { id = MNM.3890 days = 150 random = 50 }
		}
	}
}

character_event = {
	id = MNM.3870
	desc = EVTDESC_MNM_3870
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3870
		hidden_effect = {
			character_event = { id = MNM.3890 days = 350 random = 50 }
		}
	}
}

character_event = {
	id = MNM.3880
	desc = EVTDESC_MNM_3880
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3880
		scaled_wealth = {
			value = -0.3
			min = -50
			max = -250
		}
		hidden_effect = {
			character_event = { id = MNM.3890 days = 450 random = 50 }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3880
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = { id = quest_secret_religions_societies_prepare_grounds failure = yes }
		}
		hidden_effect = {
			clear_delayed_event = { id = MNM.3859 }
			clear_delayed_event = { id = MNM.3849 }
			clr_character_flag = preparing_grounds_in_@event_target:target_province
		}
	}
}

character_event = {
	id = MNM.3890
	desc = EVTDESC_MNM_3890
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3890
		trigger_switch = {
			on_trigger = secret_religion
			rastafarian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_rastafarian_community
						duration = -1
					} 
				}
			}
			voodoo = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_voodoo_community
						duration = -1
					} 
				}
			}
			santeria = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_santeria_community
						duration = -1
					} 
				}
			}
			candomble = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_candomble_community
						duration = -1
					} 
				}
			}
			espiritista = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_espiritista_community
						duration = -1
					} 
				}
			}
			espiritista_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_espiritista_reformed_community
						duration = -1
					} 
				}
			}
			peyotist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_peyotist_community
						duration = -1
					} 
				}
			}
			midewiwin = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_midewiwin_community
						duration = -1
					} 
				}
			}
			midewiwin_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_midewiwin_reformed_community
						duration = -1
					} 
				}
			}
			raven_tales = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_raven_tales_community
						duration = -1
					} 
				}
			}
			raven_tales_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_raven_tales_reformed_community
						duration = -1
					} 
				}
			}
			catholic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_catholic_community
						duration = -1
					} 
				}
			}
			neognostic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_neognostic_community
						duration = -1
					} 
				}
			}
			sedevacantist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_sedevacantist_community
						duration = -1
					} 
				}
			}
			nestorian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_nestorian_community
						duration = -1
					} 
				}
			}
			ursuline = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_ursuline_community
						duration = -1
					} 
				}
			}
			angeline = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_angeline_community
						duration = -1
					} 
				}
			}
			confederated = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_confederated_community
						duration = -1
					} 
				}
			}
			anabaptist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_anabaptist_community
						duration = -1
					} 
				}
			}
			batenburger = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_batenburger_community
						duration = -1
					} 
				}
			}
			evangelical = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_evangelical_community
						duration = -1
					} 
				}
			}
			antinomian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_antinomian_community
						duration = -1
					} 
				}
			}
			charismatic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_charismatic_community
						duration = -1
					} 
				}
			}
			postadventist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_postadventist_community
						duration = -1
					} 
				}
			}
			falling_star = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_falling_star_community
						duration = -1
					} 
				}
			}
			moravian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_moravian_community
						duration = -1
					} 
				}
			}
			high_church = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_high_church_community
						duration = -1
					} 
				}
			}
			nonconformist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_nonconformist_community
						duration = -1
					} 
				}
			}
			apostolic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_apostolic_community
						duration = -1
					} 
				}
			}
			sacred_heart = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_sacred_heart_community
						duration = -1
					} 
				}
			}
			gracia_divina = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_gracia_divina_community
						duration = -1
					} 
				}
			}
			cetic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_cetic_community
						duration = -1
					} 
				}
			}
			gaian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_gaian_community
						duration = -1
					} 
				}
			}
			shinto = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_shinto_community
						duration = -1
					} 
				}
			}
			nousthreskeia = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_nousthreskeia_community
						duration = -1
					} 
				}
			}
			mormon = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_mormon_community
						duration = -1
					} 
				}
			}
			bickertonite = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_bickertonite_community
						duration = -1
					} 
				}
			}
			woolleyite = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_woolleyite_community
						duration = -1
					} 
				}
			}
			strangite = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_strangite_community
						duration = -1
					} 
				}
			}
			sol_invicta = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_sol_invicta_community
						duration = -1
					} 
				}
			}
			mictlantec = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_mictlantec_community
						duration = -1
					} 
				}
			}
			uahomche = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_uahomche_community
						duration = -1
					} 
				}
			}
			neomayan = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_neomayan_community
						duration = -1
					} 
				}
			}
			americanist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_americanist_community
						duration = -1
					} 
				}
			}
			hamiltonian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_hamiltonian_community
						duration = -1
					} 
				}
			}
			jeffersonian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_jeffersonian_community
						duration = -1
					} 
				}
			}
			libertarian = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_libertarian_community
						duration = -1
					} 
				}
			}
			consumerist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_consumerist_community
						duration = -1
					} 
				}
			}
			monetarist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_monetarist_community
						duration = -1
					} 
				}
			}
			atomicist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_atomicist_community
						duration = -1
					} 
				}
			}
			aphite = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_aphite_community
						duration = -1
					} 
				}
			}
			pagan = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_pagan_community
						duration = -1
					} 
				}
			}
			revelationist_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_revelationist_reformed_community
						duration = -1
					} 
				}
			}
			revelationist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_revelationist_community
						duration = -1
					} 
				}
			}
			chrome_cultist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_chrome_cultist_community
						duration = -1
					} 
				}
			}
			rust_cultist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_rust_cultist_community
						duration = -1
					} 
				}
			}
			occultist_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_occultist_reformed_community
						duration = -1
					} 
				}
			}
			occultist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_occultist_community
						duration = -1
					} 
				}
			}
			thelemic_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_thelemic_reformed_community
						duration = -1
					} 
				}
			}
			thelemic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_thelemic_community
						duration = -1
					} 
				}
			}
			celtic_pagan = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_celtic_pagan_community
						duration = -1
					} 
				}
			}
			celtic_pagan_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_celtic_pagan_reformed_community
						duration = -1
					} 
				}
			}
			brethren = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_brethren_community
						duration = -1
					} 
				}
			}
			jewish = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_jewish_community
						duration = -1
					} 
				}
			}
			reform = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_reform_community
						duration = -1
					} 
				}
			}
			meshichist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_meshichist_community
						duration = -1
					} 
				}
			}
			hindu = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_hindu_community
						duration = -1
					} 
				}
			}
			traditionalist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_traditionalist_community
						duration = -1
					} 
				}
			}
			revivalist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_revivalist_community
						duration = -1
					} 
				}
			}
			imamite = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_imamite_community
						duration = -1
					} 
				}
			}
			qingzheng = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_qingzheng_community
						duration = -1
					} 
				}
			}
			alawiyya = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_alawiyya_community
						duration = -1
					} 
				}
			}
			orientalist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_orientalist_community
						duration = -1
					} 
				}
			}
			misrist = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_misrist_community
						duration = -1
					} 
				}
			}
			trailwalker = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_trailwalker_community
						duration = -1
					} 
				}
			}
			trailwalker_reformed = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_trailwalker_reformed_community
						duration = -1
					} 
				}
			}
			orthodox = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_orthodox_community
						duration = -1
					} 
				}
			}
			exovedate = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_exovedate_community
						duration = -1
					} 
				}
			}
			pelagic = { 
				event_target:target_province = { 
					add_province_modifier = { 
						name = secret_pelagic_community
						duration = -1
					} 
				}
			}
		}
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = quest_secret_religions_societies_prepare_grounds
			
			add_society_currency_minor_effect = yes
		}
		clear_delayed_event = { id = MNM.3849 }
		clr_character_flag = preparing_grounds_in_@event_target:target_province
		
		hidden_effect = {
			clear_delayed_event = { id = MNM.3859 }
		}
	}
}

character_event = {
	id = MNM.3900
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3901 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3901
	border = GFX_event_letter_frame_religion

	desc = EVTDESC_MNM_3901

	is_triggered_only = yes
	
	immediate = {
		random_demesne_province = {
			limit = {
				OR = {
					#PLEASE
					AND = { 
						ROOT = { secret_religion = rastafarian }
						NOR = {
							religion = rastafarian
							has_province_modifier = secret_rastafarian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = voodoo }
						NOR = {
							religion = voodoo
							has_province_modifier = secret_voodoo_community
						}
					}
					AND = { 
						ROOT = { secret_religion = santeria }
						NOR = {
							religion = santeria
							has_province_modifier = secret_santeria_community
						}
					}
					AND = { 
						ROOT = { secret_religion = candomble }
						NOR = {
							religion = candomble
							has_province_modifier = secret_candomble_community
						}
					}
					AND = { 
						ROOT = { secret_religion = espiritista }
						NOR = {
							religion = espiritista
							has_province_modifier = secret_espiritista_community
						}
					}
					AND = { 
						ROOT = { secret_religion = espiritista_reformed }
						NOR = {
							religion = espiritista_reformed
							has_province_modifier = secret_espiritista_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = peyotist }
						NOR = {
							religion = peyotist
							has_province_modifier = secret_peyotist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = midewiwin }
						NOR = {
							religion = midewiwin
							has_province_modifier = secret_midewiwin_community
						}
					}
					AND = { 
						ROOT = { secret_religion = midewiwin_reformed }
						NOR = {
							religion = midewiwin_reformed
							has_province_modifier = secret_midewiwin_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = raven_tales }
						NOR = {
							religion = raven_tales
							has_province_modifier = secret_raven_tales_community
						}
					}
					AND = { 
						ROOT = { secret_religion = raven_tales_reformed }
						NOR = {
							religion = raven_tales_reformed
							has_province_modifier = secret_raven_tales_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = catholic }
						NOR = {
							religion = catholic
							has_province_modifier = secret_catholic_community
						}
					}
					AND = { 
						ROOT = { secret_religion = neognostic }
						NOR = {
							religion = neognostic
							has_province_modifier = secret_neognostic_community
						}
					}
					AND = { 
						ROOT = { secret_religion = sedevacantist }
						NOR = {
							religion = sedevacantist
							has_province_modifier = secret_sedevacantist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = nestorian }
						NOR = {
							religion = nestorian
							has_province_modifier = secret_nestorian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = ursuline }
						NOR = {
							religion = ursuline
							has_province_modifier = secret_ursuline_community
						}
					}
					AND = { 
						ROOT = { secret_religion = angeline }
						NOR = {
							religion = angeline
							has_province_modifier = secret_angeline_community
						}
					}
					AND = { 
						ROOT = { secret_religion = confederated }
						NOR = {
							religion = confederated
							has_province_modifier = secret_confederated_community
						}
					}
					AND = { 
						ROOT = { secret_religion = anabaptist }
						NOR = {
							religion = anabaptist
							has_province_modifier = secret_anabaptist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = batenburger }
						NOR = {
							religion = batenburger
							has_province_modifier = secret_batenburger_community
						}
					}
					AND = { 
						ROOT = { secret_religion = evangelical }
						NOR = {
							religion = evangelical
							has_province_modifier = secret_evangelical_community
						}
					}
					AND = { 
						ROOT = { secret_religion = antinomian }
						NOR = {
							religion = antinomian
							has_province_modifier = secret_antinomian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = charismatic }
						NOR = {
							religion = charismatic
							has_province_modifier = secret_charismatic_community
						}
					}
					AND = { 
						ROOT = { secret_religion = postadventist }
						NOR = {
							religion = postadventist
							has_province_modifier = secret_postadventist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = falling_star }
						NOR = {
							religion = falling_star
							has_province_modifier = secret_falling_star_community
						}
					}
					AND = { 
						ROOT = { secret_religion = moravian }
						NOR = {
							religion = moravian
							has_province_modifier = secret_moravian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = high_church }
						NOR = {
							religion = high_church
							has_province_modifier = secret_high_church_community
						}
					}
					AND = { 
						ROOT = { secret_religion = nonconformist }
						NOR = {
							religion = nonconformist
							has_province_modifier = secret_nonconformist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = apostolic }
						NOR = {
							religion = apostolic
							has_province_modifier = secret_apostolic_community
						}
					}
					AND = { 
						ROOT = { secret_religion = sacred_heart }
						NOR = {
							religion = sacred_heart
							has_province_modifier = secret_sacred_heart_community
						}
					}
					AND = { 
						ROOT = { secret_religion = gracia_divina }
						NOR = {
							religion = gracia_divina
							has_province_modifier = secret_gracia_divina_community
						}
					}
					AND = { 
						ROOT = { secret_religion = cetic }
						NOR = {
							religion = cetic
							has_province_modifier = secret_cetic_community
						}
					}
					AND = { 
						ROOT = { secret_religion = gaian }
						NOR = {
							religion = gaian
							has_province_modifier = secret_gaian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = shinto }
						NOR = {
							religion = shinto
							has_province_modifier = secret_shinto_community
						}
					}
					AND = { 
						ROOT = { secret_religion = nousthreskeia }
						NOR = {
							religion = nousthreskeia
							has_province_modifier = secret_nousthreskeia_community
						}
					}
					AND = { 
						ROOT = { secret_religion = mormon }
						NOR = {
							religion = mormon
							has_province_modifier = secret_mormon_community
						}
					}
					AND = { 
						ROOT = { secret_religion = bickertonite }
						NOR = {
							religion = bickertonite
							has_province_modifier = secret_bickertonite_community
						}
					}
					AND = { 
						ROOT = { secret_religion = woolleyite }
						NOR = {
							religion = woolleyite
							has_province_modifier = secret_woolleyite_community
						}
					}
					AND = { 
						ROOT = { secret_religion = strangite }
						NOR = {
							religion = strangite
							has_province_modifier = secret_strangite_community
						}
					}
					AND = { 
						ROOT = { secret_religion = sol_invicta }
						NOR = {
							religion = sol_invicta
							has_province_modifier = secret_sol_invicta_community
						}
					}
					AND = { 
						ROOT = { secret_religion = mictlantec }
						NOR = {
							religion = mictlantec
							has_province_modifier = secret_mictlantec_community
						}
					}
					AND = { 
						ROOT = { secret_religion = uahomche }
						NOR = {
							religion = uahomche
							has_province_modifier = secret_uahomche_community
						}
					}
					AND = { 
						ROOT = { secret_religion = neomayan }
						NOR = {
							religion = neomayan
							has_province_modifier = secret_neomayan_community
						}
					}
					AND = { 
						ROOT = { secret_religion = americanist }
						NOR = {
							religion = americanist
							has_province_modifier = secret_americanist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = hamiltonian }
						NOR = {
							religion = hamiltonian
							has_province_modifier = secret_hamiltonian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = jeffersonian }
						NOR = {
							religion = jeffersonian
							has_province_modifier = secret_jeffersonian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = libertarian }
						NOR = {
							religion = libertarian
							has_province_modifier = secret_libertarian_community
						}
					}
					AND = { 
						ROOT = { secret_religion = consumerist }
						NOR = {
							religion = consumerist
							has_province_modifier = secret_consumerist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = monetarist }
						NOR = {
							religion = monetarist
							has_province_modifier = secret_monetarist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = atomicist }
						NOR = {
							religion = atomicist
							has_province_modifier = secret_atomicist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = aphite }
						NOR = {
							religion = aphite
							has_province_modifier = secret_aphite_community
						}
					}
					AND = { 
						ROOT = { secret_religion = pagan }
						NOR = {
							religion = pagan
							has_province_modifier = secret_pagan_community
						}
					}
					AND = { 
						ROOT = { secret_religion = revelationist_reformed }
						NOR = {
							religion = revelationist_reformed
							has_province_modifier = secret_revelationist_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = revelationist }
						NOR = {
							religion = revelationist
							has_province_modifier = secret_revelationist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = chrome_cultist }
						NOR = {
							religion = chrome_cultist
							has_province_modifier = secret_chrome_cultist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = rust_cultist }
						NOR = {
							religion = rust_cultist
							has_province_modifier = secret_rust_cultist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = occultist }
						NOR = {
							religion = occultist
							has_province_modifier = secret_occultist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = thelemic_reformed }
						NOR = {
							religion = thelemic_reformed
							has_province_modifier = secret_thelemic_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = thelemic }
						NOR = {
							religion = thelemic
							has_province_modifier = secret_thelemic_community
						}
					}
					AND = { 
						ROOT = { secret_religion = norse_pagan_reformed }
						NOR = {
							religion = norse_pagan_reformed
							has_province_modifier = secret_norse_pagan_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = norse_pagan }
						NOR = {
							religion = norse_pagan
							has_province_modifier = secret_norse_pagan_community
						}
					}
					AND = { 
						ROOT = { secret_religion = celtic_pagan }
						NOR = {
							religion = celtic_pagan
							has_province_modifier = secret_celtic_pagan_community
						}
					}
					AND = { 
						ROOT = { secret_religion = celtic_pagan_reformed }
						NOR = {
							religion = celtic_pagan_reformed
							has_province_modifier = secret_celtic_pagan_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = brethren }
						NOR = {
							religion = brethren
							has_province_modifier = secret_brethren_community
						}
					}
					AND = { 
						ROOT = { secret_religion = jewish }
						NOR = {
							religion = jewish
							has_province_modifier = secret_jewish_community
						}
					}
					AND = { 
						ROOT = { secret_religion = reform }
						NOR = {
							religion = reform
							has_province_modifier = secret_reform_community
						}
					}
					AND = { 
						ROOT = { secret_religion = meshichist }
						NOR = {
							religion = meshichist
							has_province_modifier = secret_meshichist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = hindu }
						NOR = {
							religion = hindu
							has_province_modifier = secret_hindu_community
						}
					}
					AND = { 
						ROOT = { secret_religion = traditionalist }
						NOR = {
							religion = traditionalist
							has_province_modifier = secret_traditionalist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = revivalist }
						NOR = {
							religion = revivalist
							has_province_modifier = secret_revivalist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = imamite }
						NOR = {
							religion = imamite
							has_province_modifier = secret_imamite_community
						}
					}
					AND = { 
						ROOT = { secret_religion = qingzheng }
						NOR = {
							religion = qingzheng
							has_province_modifier = secret_qingzheng_community
						}
					}
					AND = { 
						ROOT = { secret_religion = alawiyya }
						NOR = {
							religion = alawiyya
							has_province_modifier = secret_alawiyya_community
						}
					}
					AND = { 
						ROOT = { secret_religion = orientalist }
						NOR = {
							religion = orientalist
							has_province_modifier = secret_orientalist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = misrist }
						NOR = {
							religion = misrist
							has_province_modifier = secret_misrist_community
						}
					}
					AND = { 
						ROOT = { secret_religion = trailwalker }
						NOR = {
							religion = trailwalker
							has_province_modifier = secret_trailwalker_community
						}
					}
					AND = { 
						ROOT = { secret_religion = trailwalker_reformed }
						NOR = {
							religion = trailwalker_reformed
							has_province_modifier = secret_trailwalker_reformed_community
						}
					}
					AND = { 
						ROOT = { secret_religion = orthodox }
						NOR = {
							religion = orthodox
							has_province_modifier = secret_orthodox_community
						}
					}
					AND = { 
						ROOT = { secret_religion = exovedate }
						NOR = {
							religion = exovedate
							has_province_modifier = secret_exovedate_community
						}
					}
					AND = { 
						ROOT = { secret_religion = pelagic }
						NOR = {
							religion = pelagic
							has_province_modifier = secret_pelagic_community
						}
					}
				}
			}
			save_event_target_as = target_province
		}
	}

	option = {
		name = ACCEPT
		event_target:target_province = {
			set_quest_target = {
				id = quest_secret_religions_societies_prepare_grounds
				holder = ROOT
			}
		}
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}


#Character gets option to secretly keep old religion
character_event = {
	id = MNM.3949
	desc = EVTDESC_MNM_3949
	picture = GFX_evt_uncomfortable
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	hide_from = yes
	
	trigger = {
		has_secret_religion_trait_trigger = no
		has_any_char_old_religion = yes
	}

	immediate = {
		event_target_old_religion_from_flag_effect = yes
		FROM = { FROMFROM = { save_event_target_as = demander } }
	}

	option = {
		name = EVTOPTA_MNM_3949
		ai_chance = {
			factor = 50
			modifier = {
				trait = zealous 
				factor = 1.5
			}
			modifier = {
				trait = brave 
				factor = 1.5
			}
			modifier = {
				OR = {
					AND = {
						has_character_flag = character_was_rastafarian
						liege = { secret_religion = rastafarian }
					}
					AND = {
						has_character_flag = character_was_voodoo
						liege = { secret_religion = voodoo }
					}
					AND = {
						has_character_flag = character_was_santeria
						liege = { secret_religion = santeria }
					}
					AND = {
						has_character_flag = character_was_candomble
						liege = { secret_religion = candomble }
					}
					AND = {
						has_character_flag = character_was_espiritista
						liege = { secret_religion = espiritista }
					}
					AND = {
						has_character_flag = character_was_espiritista_reformed
						liege = { secret_religion = espiritista_reformed }
					}
					AND = {
						has_character_flag = character_was_peyotist
						liege = { secret_religion = peyotist }
					}
					AND = {
						has_character_flag = character_was_midewiwin
						liege = { secret_religion = midewiwin }
					}
					AND = {
						has_character_flag = character_was_midewiwin_reformed
						liege = { secret_religion = midewiwin_reformed }
					}
					AND = {
						has_character_flag = character_was_raven_tales
						liege = { secret_religion = raven_tales }
					}
					AND = {
						has_character_flag = character_was_raven_tales_reformed
						liege = { secret_religion = raven_tales_reformed }
					}
					AND = {
						has_character_flag = character_was_catholic
						liege = { secret_religion = catholic }
					}
					AND = {
						has_character_flag = character_was_neognostic
						liege = { secret_religion = neognostic }
					}
					AND = {
						has_character_flag = character_was_sedevacantist
						liege = { secret_religion = sedevacantist }
					}
					AND = {
						has_character_flag = character_was_nestorian
						liege = { secret_religion = nestorian }
					}
					AND = {
						has_character_flag = character_was_ursuline
						liege = { secret_religion = ursuline }
					}
					AND = {
						has_character_flag = character_was_angeline
						liege = { secret_religion = angeline }
					}
					AND = {
						has_character_flag = character_was_confederated
						liege = { secret_religion = confederated }
					}
					AND = {
						has_character_flag = character_was_anabaptist
						liege = { secret_religion = anabaptist }
					}
					AND = {
						has_character_flag = character_was_batenburger
						liege = { secret_religion = batenburger }
					}
					AND = {
						has_character_flag = character_was_evangelical
						liege = { secret_religion = evangelical }
					}
					AND = {
						has_character_flag = character_was_antinomian
						liege = { secret_religion = antinomian }
					}
					AND = {
						has_character_flag = character_was_charismatic
						liege = { secret_religion = charismatic }
					}
					AND = {
						has_character_flag = character_was_postadventist
						liege = { secret_religion = postadventist }
					}
					AND = {
						has_character_flag = character_was_falling_star
						liege = { secret_religion = falling_star }
					}
					AND = {
						has_character_flag = character_was_moravian
						liege = { secret_religion = moravian }
					}
					AND = {
						has_character_flag = character_was_high_church
						liege = { secret_religion = high_church }
					}
					AND = {
						has_character_flag = character_was_nonconformist
						liege = { secret_religion = nonconformist }
					}
					AND = {
						has_character_flag = character_was_apostolic
						liege = { secret_religion = apostolic }
					}
					AND = {
						has_character_flag = character_was_sacred_heart
						liege = { secret_religion = sacred_heart }
					}
					AND = {
						has_character_flag = character_was_gracia_divina
						liege = { secret_religion = gracia_divina }
					}
					AND = {
						has_character_flag = character_was_cetic
						liege = { secret_religion = cetic }
					}
					AND = {
						has_character_flag = character_was_gaian
						liege = { secret_religion = gaian }
					}
					AND = {
						has_character_flag = character_was_shinto
						liege = { secret_religion = shinto }
					}
					AND = {
						has_character_flag = character_was_nousthreskeia
						liege = { secret_religion = nousthreskeia }
					}
					AND = {
						has_character_flag = character_was_mormon
						liege = { secret_religion = mormon }
					}
					AND = {
						has_character_flag = character_was_bickertonite
						liege = { secret_religion = bickertonite }
					}
					AND = {
						has_character_flag = character_was_woolleyite
						liege = { secret_religion = woolleyite }
					}
					AND = {
						has_character_flag = character_was_strangite
						liege = { secret_religion = strangite }
					}
					AND = {
						has_character_flag = character_was_sol_invicta
						liege = { secret_religion = sol_invicta }
					}
					AND = {
						has_character_flag = character_was_mictlantec
						liege = { secret_religion = mictlantec }
					}
					AND = {
						has_character_flag = character_was_uahomche
						liege = { secret_religion = uahomche }
					}
					AND = {
						has_character_flag = character_was_neomayan
						liege = { secret_religion = neomayan }
					}
					AND = {
						has_character_flag = character_was_americanist
						liege = { secret_religion = americanist }
					}
					AND = {
						has_character_flag = character_was_hamiltonian
						liege = { secret_religion = hamiltonian }
					}
					AND = {
						has_character_flag = character_was_jeffersonian
						liege = { secret_religion = jeffersonian }
					}
					AND = {
						has_character_flag = character_was_libertarian
						liege = { secret_religion = libertarian }
					}
					AND = {
						has_character_flag = character_was_consumerist
						liege = { secret_religion = consumerist }
					}
					AND = {
						has_character_flag = character_was_monetarist
						liege = { secret_religion = monetarist }
					}
					AND = {
						has_character_flag = character_was_atomicist
						liege = { secret_religion = atomicist }
					}
					AND = {
						has_character_flag = character_was_aphite
						liege = { secret_religion = aphite }
					}
					AND = {
						has_character_flag = character_was_pagan
						liege = { secret_religion = pagan }
					}
					AND = {
						has_character_flag = character_was_revelationist_reformed
						liege = { secret_religion = revelationist_reformed }
					}
					AND = {
						has_character_flag = character_was_revelationist
						liege = { secret_religion = revelationist }
					}
					AND = {
						has_character_flag = character_was_chrome_cultist
						liege = { secret_religion = chrome_cultist }
					}
					AND = {
						has_character_flag = character_was_rust_cultist
						liege = { secret_religion = rust_cultist }
					}
					AND = {
						has_character_flag = character_was_occultist_reformed
						liege = { secret_religion = occultist_reformed }
					}
					AND = {
						has_character_flag = character_was_occultist
						liege = { secret_religion = occultist }
					}
					AND = {
						has_character_flag = character_was_thelemic_reformed
						liege = { secret_religion = thelemic_reformed }
					}
					AND = {
						has_character_flag = character_was_thelemic
						liege = { secret_religion = thelemic }
					}
					AND = {
						has_character_flag = character_was_norse_pagan_reformed
						liege = { secret_religion = norse_pagan_reformed }
					}
					AND = {
						has_character_flag = character_was_norse_pagan
						liege = { secret_religion = norse_pagan }
					}
					AND = {
						has_character_flag = character_was_celtic_pagan
						liege = { secret_religion = celtic_pagan }
					}
					AND = {
						has_character_flag = character_was_celtic_pagan_reformed
						liege = { secret_religion = celtic_pagan_reformed }
					}
					AND = {
						has_character_flag = character_was_brethren
						liege = { secret_religion = brethren }
					}
					AND = {
						has_character_flag = character_was_jewish
						liege = { secret_religion = jewish }
					}
					AND = {
						has_character_flag = character_was_reform
						liege = { secret_religion = reform }
					}
					AND = {
						has_character_flag = character_was_meshichist
						liege = { secret_religion = meshichist }
					}
					AND = {
						has_character_flag = character_was_hindu
						liege = { secret_religion = hindu }
					}
					AND = {
						has_character_flag = character_was_traditionalist
						liege = { secret_religion = traditionalist }
					}
					AND = {
						has_character_flag = character_was_revivalist
						liege = { secret_religion = revivalist }
					}
					AND = {
						has_character_flag = character_was_imamite
						liege = { secret_religion = imamite }
					}
					AND = {
						has_character_flag = character_was_qingzheng
						liege = { secret_religion = qingzheng }
					}
					AND = {
						has_character_flag = character_was_alawiyya
						liege = { secret_religion = alawiyya }
					}
					AND = {
						has_character_flag = character_was_orientalist
						liege = { secret_religion = orientalist }
					}
					AND = {
						has_character_flag = character_was_misrist
						liege = { secret_religion = misrist }
					}
					AND = {
						has_character_flag = character_was_trailwalker
						liege = { secret_religion = trailwalker }
					}
					AND = {
						has_character_flag = character_was_trailwalker_reformed
						liege = { secret_religion = trailwalker_reformed }
					}
					AND = {
						has_character_flag = character_was_orthodox
						liege = { secret_religion = orthodox }
					}
					AND = {
						has_character_flag = character_was_exovedate
						liege = { secret_religion = exovedate }
					}
					AND = {
						has_character_flag = character_was_pelagic
						liege = { secret_religion = pelagic }
					}
				}
				factor = 500
			}
		}
		add_secret_religion_trait_trigger_is_religion_or_old_religion_flag_clear_flag_after_effect_is_run_this_name_is_a_tribute_to_m_effect = yes
		custom_tooltip = { text = EVTOPTA_MNM_3949_TT }
	}

	option = {
		name = EVTOPTB_MNM_3949
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.3
				trait = craven 
			}
		}
		custom_tooltip = { text = EVTOPTB_MNM_3949_TT }
	}	
}

# Secret religion - Member thinks it's too stressful to keep practising their secret religion.
character_event = {
	id = MNM.3920
	desc = EVTDESC_MNM_3920
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	capable_only = yes
	only_playable = yes
	is_in_society = yes
	
	trigger = {
		society_member_of = secret_religious_cult
		block_general_event_trigger = no
		
		society = {
			any_society_member = {
				ai = yes
				NOT = { character = ROOT }
				NOT = { is_society_grandmaster = yes }
				
				is_within_diplo_range = ROOT
			}
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 0.05
			ai = yes
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					count = 5
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					count = 10
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
	}
	
	immediate = {
		# Find a suitable person
		society = {
			random_society_member = {
				limit = {
					ai = yes
					NOT = { character = ROOT }
					NOT = { is_society_grandmaster = yes }
					same_realm = ROOT
					OR = {
						trait = paranoid
						trait = stressed
					}
					
					is_within_diplo_range = ROOT
				}
				save_event_target_as = worried_secret_member
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						same_realm = ROOT
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						OR = {
							trait = paranoid
							trait = stressed
						}
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
		}
	}
	
	option = { # Try to convince by talking about solidarity
		name = EVTOPTA_MNM_3920
		hidden_effect = {
			random_list = {
				40 = { # Success
					modifier = {
						factor = 1.3
						diplomacy = 9
					}
					modifier = {
						factor = 1.3
						diplomacy = 11
					}
					modifier = {
						factor = 1.3
						diplomacy = 13
					}
					modifier = {
						factor = 1.3
						diplomacy = 15
					}
					modifier = {
						factor = 1.3
						diplomacy = 17
					}
					modifier = {
						factor = 1.3
						diplomacy = 19
					}
					modifier = {
						factor = 2
						FROM = { trait = charitable }
					}
					modifier = {
						factor = 2
						FROM = { trait = kind }
					}
					modifier = {
						factor = 2
						FROM = { trait = honest }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = craven }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = cynical }
					}
					
					set_character_flag = solidarity_success
				}
				20 = { # Failure
					modifier = { # ai can't deem what would be a good choice
						factor = 0.5
						ai = yes
					}
					set_character_flag = solidarity_failure
				}
			}
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # Try to convince by talking about devotion
		name = EVTOPTB_MNM_3920
		hidden_effect = {
			random_list = {
				40 = { # Success
					modifier = {
						factor = 1.3
						diplomacy = 9
					}
					modifier = {
						factor = 1.3
						diplomacy = 11
					}
					modifier = {
						factor = 1.3
						diplomacy = 13
					}
					modifier = {
						factor = 1.3
						diplomacy = 15
					}
					modifier = {
						factor = 1.3
						diplomacy = 17
					}
					modifier = {
						factor = 1.3
						diplomacy = 19
					}
					modifier = {
						factor = 2
						FROM = { trait = patient }
					}
					modifier = {
						factor = 2
						FROM = { trait = diligent }
					}
					modifier = {
						factor = 2
						FROM = { trait = brave }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = paranoid }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = arbitrary }
					}
					
					set_character_flag = devotion_success
				}
				20 = { # Failure
					modifier = { # ai can't deem what would be a good choice
						factor = 0.5
						ai = yes
					}
					set_character_flag = devotion_failure
				}
			}
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # Use smooth talking to calm her
		name = EVTOPTC_MNM_3920
		trigger = {
			trait = gregarious
		}
		tooltip_info = gregarious
		
		hidden_effect = {
			set_character_flag = gregarious_success
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # She is free to leave if she feels that way
		name = EVTOPTD_MNM_3920
		event_target:worried_secret_member = {
			leave_society = yes
			clear_secret_religion = yes
		}
	}
}

character_event = {
	id = MNM.3921
	picture = "GFX_evt_uncomfortable"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	trigger = { society_member_of = secret_religious_cult }
	
	desc = {
		text = EVTDESC_MNM_3921_A
		trigger = { has_character_flag = solidarity_success }
	}
	desc = {
		text = EVTDESC_MNM_3921_B
		trigger = { has_character_flag = solidarity_failure }
	}
	desc = {
		text = EVTDESC_MNM_3921_C
		trigger = { has_character_flag = devotion_success }
	}
	desc = {
		text = EVTDESC_MNM_3921_D
		trigger = { has_character_flag = devotion_failure }
	}
	desc = {
		text = EVTDESC_MNM_3921_E
		trigger = { has_character_flag = gregarious_success }
	}
	
	option = {
		name = EVTOPTA_MNM_3921
		trigger = {
			OR = {
				has_character_flag = solidarity_success
				has_character_flag = devotion_success
				has_character_flag = gregarious_success
			}
		}
		if = {
			limit = {
				has_character_flag = gregarious_success
				event_target:worried_secret_member = {
					trait = paranoid
				}
			}
			event_target:worried_secret_member = {
				remove_trait = paranoid
			}
		}
		if = {
			limit = {
				has_character_flag = gregarious_success
				event_target:worried_secret_member = {
					trait = stressed
				}
			}
			event_target:worried_secret_member = {
				remove_trait = stressed
			}
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3921
		trigger = {
			NOR = {
				has_character_flag = solidarity_success
				has_character_flag = devotion_success
				has_character_flag = gregarious_success
			}
		}
		event_target:worried_secret_member = {
			leave_society = yes
			clear_secret_religion = yes
		}
	}

	after = {
		clr_character_flag = solidarity_success
		clr_character_flag = solidarity_failure
		clr_character_flag = devotion_success
		clr_character_flag = devotion_failure
		clr_character_flag = gregarious_success
	}
}

### Secret religions - commission painting
character_event = {
	id = MNM.3910
	desc = EVTDESC_MNM_3910
	picture = GFX_evt_dharmic_pilgrims
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	only_playable = yes
	
	trigger = {
		NOT = { has_character_flag = commissioned_painting }
		block_general_event_trigger = no
		OR = {
			is_in_society = no
			NOT = { society_member_of = secret_religious_cult }
			society = {
				any_society_member = {
					NOT = { character = ROOT }
					same_realm = ROOT
				}
			}
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 0.05
			NOT = { society_member_of = secret_religious_cult }
		}
	}
	
	immediate = {
		set_character_flag = commissioned_painting
	}
	
	option = {
		name = EVTOPTA_MNM_3910
		
		scaled_wealth = {
			value = -0.3
			min = -25
			max = -125
		}
		hidden_effect = {
			character_event = { id = MNM.3911 days = 60 random = 20 }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3910
	}
}

# Add hidden religious symbols to the painting?
character_event = {
	id = MNM.3911
	desc = EVTDESC_MNM_3911
	picture = GFX_evt_dharmic_pilgrims
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = { # Ask artist to add symbols
		name = EVTOPTA_MNM_3911
		trigger = {
			society_member_of = secret_religious_cult
		}
		
		scaled_wealth = {
			value = -0.05
			min = -5
			max = -30
		}
		if = {
			limit = { random = 50 }
			custom_tooltip = {
				text = EVTTOOLTIPA_MNM_3911_FEMALE
				random_list = {
					95 = {
						hidden_effect = {
							character_event = { id = MNM.3912 days = 25 random = 5 }
						}
					}
					5 = {
						add_character_modifier = {
							modifier = unfaithful_rumors
							years = 3
						}
						scaled_wealth = {
							value = -0.05
							min = -5
							max = -30
						}
					}
				}
			}
		}
		if = {
			limit = { NOT = { random = 50 } }
			custom_tooltip = {
				text = EVTTOOLTIPA_MNM_3911_MALE
				random_list = {
					95 = {
						hidden_effect = {
							character_event = { id = MNM.3912 days = 25 random = 5 }
						}
					}
					5 = {
						add_character_modifier = {
							modifier = unfaithful_rumors
							years = 3
						}
						scaled_wealth = {
							value = -0.05
							min = -5
							max = -30
						}
					}
				}
			}
		}
	}
	
	option = { # Add symbols yourself
		name = EVTOPTB_MNM_3911
		trigger = {
			society_member_of = secret_religious_cult
		}
		
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_3911
			hidden_effect = {
				random_list = {
					60 = { # Success
						character_event = { id = MNM.3912 days = 35 random = 10 }
					}
					40 = { # Avant Garde
						character_event = { id = MNM.3914 days = 35 random = 10 }
					}
				}
			}
		}
	}
	
	option = { # Keep as is
		name = EVTOPTC_MNM_3911
		add_artifact = magnificent_painting
	}
}

character_event = {
	id = MNM.3912
	desc = EVTDESC_MNM_3912
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		society = {
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					same_realm = ROOT
					OR = {
						AND = {
							society_rank > 1
							ROOT = { society_rank == 1 }
						}
						AND = {
							society_rank > 2
							ROOT = { society_rank == 2 }
						}
						AND = {
							society_rank > 3
							ROOT = { society_rank == 3 }
						}
					}
				}
				save_event_target_as = society_art_observer
			}
			if = {
				limit = {
					NOT = { event_target:society_art_observer = { always = yes } }
				}
				random_society_member = {
					limit = {
						NOT = { character = ROOT }
						same_realm = ROOT
					}
					save_event_target_as = society_art_observer
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_3912
		add_artifact = magnificent_painting
		add_society_currency_minor_effect = yes
		
		event_target:society_art_observer = {
			opinion = {
				who = ROOT
				modifier = opinion_budding_friendship
				years = 10
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_budding_friendship
				years = 10
			}
		}
	}
}

character_event = {
	id = MNM.3914
	desc = EVTDESC_MNM_3914
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_3914
		add_artifact = avant_garde_painting
	}
	
	option = {
		name = EVTOPTB_3914
		prestige = -100
	}
}

### Fellow society member asks you to go for a round of drinks
character_event = {
	id = MNM.3930
	desc = EVTDESC_MNM_3930
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	capable_only = yes
	is_in_society = yes
	
	trigger = {
		block_general_event_trigger = no
		society_member_of = secret_religious_cult
		
		society = {
			any_society_member = {
				NOT = { character = ROOT }
				ai = yes
			}
		}
	}
	
	immediate = {
		society = {
			
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					ai = yes
					same_realm = ROOT
				}
				save_event_target_as = society_character
			}
			if = {
				limit = { NOT = { event_target:society_character = { always = yes } } }				
				random_society_member = {
					limit = {
						NOT = {	character = ROOT }
						ai = yes
					}
					save_event_target_as = society_character
				}
			}
		}
	}
	
	option = { # Of course
		name = EVTOPTA_3930
		custom_tooltip = {
			text = EVTTOOLTIP_MNM_3930
			hidden_effect = {
				event_target:society_character = {
					character_event = { id = MNM.3931 }
				}
			}
		}
	}
	
	option = { # I don't have time for that
		name = EVTOPTB_3930
	}
}

character_event = {
	id = MNM.3931
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			character_event = { id = MNM.3932 days = 21 random = 7 }
		}
	}
}

# Argument with local
character_event = {
	id = MNM.3932
	desc = EVTDESC_MNM_3932
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	trigger = { society_member_of = secret_religious_cult }

	
	option = { # diplomatically calm the situation
		name = EVTOPTA_MNM_3932
		custom_tooltip = {
			text = EVTTOOLTIPA_MNM_3932
			hidden_effect = {
				character_event = { id = MNM.3933 days = 7 }
			}
		}
	}
	
	option = { # fight the local
		name = EVTOPTB_MNM_3932
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_3932
			hidden_effect = {
				character_event = { id = MNM.3934 days = 7 }
			}
		}
	}
}

character_event = {
	id = MNM.3933
	desc = {
		text = EVTDESC_MNM_3933_SUCCESS
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
	}
	desc = {
		text = EVTDESC_MNM_3933_FAILURE
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
	}
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = { # Diplomacy check
			30 = { # success
				modifier = {
					factor = 1.3
					diplomacy = 7
				}
				modifier = {
					factor = 1.3
					diplomacy = 9
				}
				modifier = {
					factor = 1.3
					diplomacy = 11
				}
				modifier = {
					factor = 1.3
					diplomacy = 13
				}
			
			
				set_character_flag = sr_bar_fight_success
			}
			70 = { # failure
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3933
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
		
		add_character_modifier = {
			modifier = mediator
			years = 2
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3933
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
		
		if = {
			limit = {
				OR = {
					trait = wounded
					is_maimed_trigger = yes
				}
			}
			prestige = -50
		}
		if = {
			limit = {
				NOR = {
					trait = wounded
					is_maimed_trigger = yes
				}
			}
			add_trait = wounded
		}
		event_target:society_character = {
			if = {
				limit = {
					OR = {
						trait = wounded
						is_maimed_trigger = yes
					}
				}
				prestige = -50
			}
			if = {
				limit = {
					NOR = {
						trait = wounded
						is_maimed_trigger = yes
					}
				}
				add_trait = wounded
			}
		}
		add_character_modifier = {
			modifier = bruised_knuckles
			months = 6
		}
	}
	
	after = {
		clr_character_flag = sr_bar_fight_success
		event_target:society_character = {
			opinion = {
				who = ROOT
				modifier = opinion_happy
				years = 5
			}
			hidden_effect = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_happy
					years = 5
				}
			}
		}
	}
}

character_event = {
	id = MNM.3934
	desc = {
		text = EVTDESC_MNM_3934_SUCCESS
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
	}
	desc = {
		text = EVTDESC_MNM_3934_FAILURE
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
	}
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = { # Martial check
			30 = { # success
				modifier = {
					factor = 1.3
					martial = 7
				}
				modifier = {
					factor = 1.3
					martial = 9
				}
				modifier = {
					factor = 1.3
					martial = 11
				}
				modifier = {
					factor = 1.3
					martial = 13
				}
			
				set_character_flag = sr_bar_fight_success
			}
			70 = { # failure
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3934
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
		
		change_society_currency = 30
		increase_visibility_effect = yes
	}
	
	option = {
		name = EVTOPTB_MNM_3934
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
		
		increase_visibility_effect = yes
		if = {
			limit = {
				OR = {
					trait = wounded
					is_maimed_trigger = yes
				}
			}
			prestige = -50
		}
		if = {
			limit = {
				NOR = {
					trait = wounded
					is_maimed_trigger = yes
				}
			}
			add_trait = wounded
		}
		event_target:society_character = {
			if = {
				limit = {
					OR = {
						trait = wounded
						is_maimed_trigger = yes
					}
				}
				prestige = -50
			}
			if = {
				limit = {
					NOR = {
						trait = wounded
						is_maimed_trigger = yes
					}
				}
				add_trait = wounded
			}
		}
	}
	
	after = {
		add_character_modifier = {
			modifier = bruised_knuckles
			months = 6
		}
		event_target:society_character = {
			opinion = {
				who = ROOT
				modifier = opinion_happy
				years = 5
			}
			hidden_effect = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_happy
					years = 5
				}
			}
		}
		clr_character_flag = sr_bar_fight_success
	}
}

# Feedback event for found_religious_cult decision
character_event = {
	id = MNM.3950
	desc = EVTDESC_MNM_3950
	picture = GFX_evt_secret_ceremony
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3950
	}
}

# Feedback event for falsely_confess_faith decision
character_event = {
	id = MNM.3951
	desc = EVTDESC_MNM_3951
	picture = GFX_evt_secluded_in_prayer
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3951
	}
}

# rare ai only - secretly convert from spouse/friend/province's religion
character_event = {
	id = MNM.3948
	hide_window = yes
	
	is_triggered_only = yes
	
	ai = yes
	only_playable = yes
	
	trigger = {
		has_secret_religion = no
		any_spouse = {
			same_true_religion_as_root_trigger = no
		}
		any_consort = {
			same_true_religion_as_root_trigger = no
		}
		any_demesne_province = {
			NOT = { religion = { target_type = true target = ROOT} }
		}
		any_friend = {
			same_true_religion_as_root_trigger = no
		}
	}
	
	weight_multiplier = {
		days = 1
	}
	
	immediate = {
		random_spouse = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
		random_consort = {
			limit = {
				NOT = { character = ROOT }
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
		random_demesne_province = {
			limit = {
				NOT = { religion = { target_type = true target = ROOT} }
			}
			ROOT = { set_secret_religion = { target_type = public target = PREV } }
			ROOT = {
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
					}
					set_secret_religion = { target_type = true target = ROOT }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
					}
					set_secret_religion = { target_type = true target = ROOT }
				}
			}
			break = yes
		}
		random_friend = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
	}
}