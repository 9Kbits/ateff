###########################################
#
# Society decisions for secret religious societies
#
###########################################

society_decisions = {
	
	secret_religions_openly_adopt_faith = {
		is_high_prio = yes
		
		potential = {
			society_member_of = secret_religious_cult

			society_rank == 4
		}
	
		allow = {
			OR = {
				has_society_currency_major_trigger = yes
				hidden_tooltip = {
					ai = yes
				}
			}
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			war = no
		}
		
		effect = {
			#hidden_effect = { # To track the number of Revealed Cults
			#	change_variable = { which = global_revealed_cults value = 1 }
			#	if = {
			#		limit = {
			#			secret_religion = rastafarian
			#		}
			#		change_variable = { which = global_rastafarian_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = voodoo
			#		}
			#		change_variable = { which = global_voodoo_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = santeria
			#		}
			#		change_variable = { which = global_santeria_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = candomble
			#		}
			#		change_variable = { which = global_candomble_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = espiritista
			#		}
			#		change_variable = { which = global_espiritista_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = espiritista_reformed
			#		}
			#		change_variable = { which = global_espiritista_reformed_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = ghost_dance
			#		}
			#		change_variable = { which = global_ghost_dance_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = raven_tales
			#		}
			#		change_variable = { which = global_raven_tales_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = catholic
			#		}
			#		change_variable = { which = global_catholic_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = neognostic
			#		}
			#		change_variable = { which = global_neognostic_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = sedevacantist
			#		}
			#		change_variable = { which = global_sedevacantist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = ursuline
			#		}
			#		change_variable = { which = global_ursuline_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = angeline
			#		}
			#		change_variable = { which = global_angeline_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = confederated
			#		}
			#		change_variable = { which = global_confederated_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = anabaptist
			#		}
			#		change_variable = { which = global_anabaptist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = evangelical
			#		}
			#		change_variable = { which = global_evangelical_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = antinomian
			#		}
			#		change_variable = { which = global_antinomian_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = charismatic
			#		}
			#		change_variable = { which = global_charismatic_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = falling_star
			#		}
			#		change_variable = { which = global_falling_star_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = high_church
			#		}
			#		change_variable = { which = global_high_church_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = anglo_papalist
			#		}
			#		change_variable = { which = global_anglo_papalist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = united_church
			#		}
			#		change_variable = { which = global_united_church_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = sacred_heart
			#		}
			#		change_variable = { which = global_sacred_heart_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = gracia_divina
			#		}
			#		change_variable = { which = global_gracia_divina_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = cetic
			#		}
			#		change_variable = { which = global_cetic_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = gaian
			#		}
			#		change_variable = { which = global_gaian_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = shinto
			#		}
			#		change_variable = { which = global_shinto_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = nousthreskeia
			#		}
			#		change_variable = { which = global_nousthreskeia_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = mormon
			#		}
			#		change_variable = { which = global_mormon_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = bickertonite
			#		}
			#		change_variable = { which = global_bickertonite_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = godbeite
			#		}
			#		change_variable = { which = global_godbeite_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = strangite
			#		}
			#		change_variable = { which = global_strangite_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = sol_invicta
			#		}
			#		change_variable = { which = global_sol_invicta_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = mictlantec
			#		}
			#		change_variable = { which = global_mictlantec_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = uahomche
			#		}
			#		change_variable = { which = global_uahomche_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = neomayan
			#		}
			#		change_variable = { which = global_neomayan_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = americanist
			#		}
			#		change_variable = { which = global_americanist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = hamiltonian
			#		}
			#		change_variable = { which = global_hamiltonian_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = jeffersonian
			#		}
			#		change_variable = { which = global_jeffersonian_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = libertarian
			#		}
			#		change_variable = { which = global_libertarian_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = consumerist
			#		}
			#		change_variable = { which = global_consumerist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = atomicist
			#		}
			#		change_variable = { which = global_atomicist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = pagan
			#		}
			#		change_variable = { which = global_pagan_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = revelationist_reformed
			#		}
			#		change_variable = { which = global_revelationist_reformed_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = revelationist
			#		}
			#		change_variable = { which = global_revelationist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = rust_cultist_reformed
			#		}
			#		change_variable = { which = global_rust_cultist_reformed_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = rust_cultist
			#		}
			#		change_variable = { which = global_rust_cultist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = occultist_reformed
			#		}
			#		change_variable = { which = global_occultist_reformed_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = occultist
			#		}
			#		change_variable = { which = global_occultist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = thelemic_reformed
			#		}
			#		change_variable = { which = global_thelemic_reformed_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = thelemic
			#		}
			#		change_variable = { which = global_thelemic_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = norse_pagan_reformed
			#		}
			#		change_variable = { which = global_norse_pagan_reformed_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = norse_pagan
			#		}
			#		change_variable = { which = global_norse_pagan_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = celticist
			#		}
			#		change_variable = { which = global_celticist_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = brethren
			#		}
			#		change_variable = { which = global_brethren_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = jewish
			#		}
			#		change_variable = { which = global_jewish_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = reform
			#		}
			#		change_variable = { which = global_reform_revealed_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = hindu
			#		}
			#		change_variable = { which = global_hindu_revealed_cults value = 1 }
			#	}
			#}
			detract_society_currency_major_effect = yes
			custom_tooltip = {
				text = openly_adopt_faith_effect_tooltip
				if = { # Malls and Fylkirates are forfeit
					limit = {
						OR = {
							religion = consumerist
							religion = norse_pagan_reformed
						}
						any_demesne_title = {
							controls_religion = yes
						}
					}
					any_demesne_title = {
						limit = {
							controls_religion = yes
						}
						destroy_landed_title = THIS
					}
				}
				if = { # Papacies are given to a random new character
					limit = {
						NOR = {
							religion = consumerist
							religion = norse_pagan_reformed
						}
						any_demesne_title = {
							controls_religion = yes
						}
					}
					hidden_tooltip = {
						liege = {
							save_event_target_as = liege_target
						}
						create_character = {
							age = 38
							dynasty = random
							religion = ROOT
							culture = ROOT
							random_traits = yes
						}
						new_character = {
							save_event_target_as = new_holder
						}
					}
					any_demesne_title = {
						limit = {
							controls_religion = yes
						}
						grant_title = event_target:new_holder
						holder_scope = {
							any_vassal = {
								set_defacto_liege = event_target:liege_target
							}
						}
					}
					hidden_tooltip = {
						set_defacto_liege = event_target:liege_target
					}
				}
				if = { # Holy Orders/Static Mercs are given to a random new character
					limit = {
						any_demesne_title = {
							OR = {
								holy_order = yes
								mercenary = yes
							}
						}
					}
					hidden_tooltip = {
						liege = {
							save_event_target_as = liege_target
						}
						create_character = {
							age = 38
							dynasty = random
							religion = ROOT
							culture = ROOT
							random_traits = yes
						}
						new_character = {
							save_event_target_as = new_holder
						}
					}
					any_demesne_title = {
						limit = {
							OR = {
								holy_order = yes
								mercenary = yes
							}
						}
						grant_title = event_target:new_holder
						holder_scope = {
							any_vassal = {
								set_defacto_liege = event_target:liege_target
							}
						}
					}
					hidden_tooltip = {
						set_defacto_liege = event_target:liege_target
					}
				}
				hidden_effect = {
					character_event = { id = MNM.3811 }
					any_society_member = {
						if = {
							limit = {
								NOT = {
									character = ROOT
								}
								same_society_as = ROOT
							}
							character_event = { id = MNM.3800 } # Convert cultists
						}
					}
					top_liege = {
						any_realm_character = {
							if = {
								limit = {
									NOT = {
										same_society_as = ROOT
									}
									OR = {
										has_prevs_secret_religion_truly_trigger = yes
										has_sympathy_for_true_religion_of_prev_trigger = yes
									}
								}
								character_event = { id = MNM.3810 } # Allow sympathisers the chance to flip
							}
							
							if = {
								limit = {
									is_ruler = yes
									any_demesne_province = {
										OR = {
											AND = {
												has_province_modifier = secret_rastafarian_community
												ROOT = {
													society_member_of = secret_religious_society_rastafarian
												}
											}
											AND = {
												has_province_modifier = secret_voodoo_community
												ROOT = {
													society_member_of = secret_religious_society_voodoo
												}
											}
											AND = {
												has_province_modifier = secret_santeria_community
												ROOT = {
													society_member_of = secret_religious_society_santeria
												}
											}
											AND = {
												has_province_modifier = secret_candomble_community
												ROOT = {
													society_member_of = secret_religious_society_candomble
												}
											}
											AND = {
												has_province_modifier = secret_espiritista_community
												ROOT = {
													society_member_of = secret_religious_society_espiritista
												}
											}
											AND = {
												has_province_modifier = secret_espiritista_reformed_community
												ROOT = {
													society_member_of = secret_religious_society_espiritista_reformed
												}
											}
											AND = {
												has_province_modifier = secret_ghost_dance_community
												ROOT = {
													society_member_of = secret_religious_society_ghost_dance
												}
											}
											AND = {
												has_province_modifier = secret_raven_tales_community
												ROOT = {
													society_member_of = secret_religious_society_raven_tales
												}
											}
											AND = {
												has_province_modifier = secret_catholic_community
												ROOT = {
													society_member_of = secret_religious_society_catholic
												}
											}
											AND = {
												has_province_modifier = secret_neognostic_community
												ROOT = {
													society_member_of = secret_religious_society_neognostic
												}
											}
											AND = {
												has_province_modifier = secret_sedevacantist_community
												ROOT = {
													society_member_of = secret_religious_society_sedevacantist
												}
											}
											AND = {
												has_province_modifier = secret_ursuline_community
												ROOT = {
													society_member_of = secret_religious_society_ursuline
												}
											}
											AND = {
												has_province_modifier = secret_angeline_community
												ROOT = {
													society_member_of = secret_religious_society_angeline
												}
											}
											AND = {
												has_province_modifier = secret_confederated_community
												ROOT = {
													society_member_of = secret_religious_society_confederated
												}
											}
											AND = {
												has_province_modifier = secret_anabaptist_community
												ROOT = {
													society_member_of = secret_religious_society_anabaptist
												}
											}
											AND = {
												has_province_modifier = secret_evangelical_community
												ROOT = {
													society_member_of = secret_religious_society_evangelical
												}
											}
											AND = {
												has_province_modifier = secret_antinomian_community
												ROOT = {
													society_member_of = secret_religious_society_antinomian
												}
											}
											AND = {
												has_province_modifier = secret_charismatic_community
												ROOT = {
													society_member_of = secret_religious_society_charismatic
												}
											}
											AND = {
												has_province_modifier = secret_falling_star_community
												ROOT = {
													society_member_of = secret_religious_society_falling_star
												}
											}
											AND = {
												has_province_modifier = secret_high_church_community
												ROOT = {
													society_member_of = secret_religious_society_high_church
												}
											}
											AND = {
												has_province_modifier = secret_anglo_papalist_community
												ROOT = {
													society_member_of = secret_religious_society_anglo_papalist
												}
											}
											AND = {
												has_province_modifier = secret_united_church_community
												ROOT = {
													society_member_of = secret_religious_society_united_church
												}
											}
											AND = {
												has_province_modifier = secret_sacred_heart_community
												ROOT = {
													society_member_of = secret_religious_society_sacred_heart
												}
											}
											AND = {
												has_province_modifier = secret_gracia_divina_community
												ROOT = {
													society_member_of = secret_religious_society_gracia_divina
												}
											}
											AND = {
												has_province_modifier = secret_cetic_community
												ROOT = {
													society_member_of = secret_religious_society_cetic
												}
											}
											AND = {
												has_province_modifier = secret_gaian_community
												ROOT = {
													society_member_of = secret_religious_society_gaian
												}
											}
											AND = {
												has_province_modifier = secret_shinto_community
												ROOT = {
													society_member_of = secret_religious_society_shinto
												}
											}
											AND = {
												has_province_modifier = secret_nousthreskeia_community
												ROOT = {
													society_member_of = secret_religious_society_nousthreskeia
												}
											}
											AND = {
												has_province_modifier = secret_mormon_community
												ROOT = {
													society_member_of = secret_religious_society_mormon
												}
											}
											AND = {
												has_province_modifier = secret_bickertonite_community
												ROOT = {
													society_member_of = secret_religious_society_bickertonite
												}
											}
											AND = {
												has_province_modifier = secret_godbeite_community
												ROOT = {
													society_member_of = secret_religious_society_godbeite
												}
											}
											AND = {
												has_province_modifier = secret_strangite_community
												ROOT = {
													society_member_of = secret_religious_society_strangite
												}
											}
											AND = {
												has_province_modifier = secret_sol_invicta_community
												ROOT = {
													society_member_of = secret_religious_society_sol_invicta
												}
											}
											AND = {
												has_province_modifier = secret_mictlantec_community
												ROOT = {
													society_member_of = secret_religious_society_mictlantec
												}
											}
											AND = {
												has_province_modifier = secret_uahomche_community
												ROOT = {
													society_member_of = secret_religious_society_uahomche
												}
											}
											AND = {
												has_province_modifier = secret_neomayan_community
												ROOT = {
													society_member_of = secret_religious_society_neomayan
												}
											}
											AND = {
												has_province_modifier = secret_americanist_community
												ROOT = {
													society_member_of = secret_religious_society_americanist
												}
											}
											AND = {
												has_province_modifier = secret_hamiltonian_community
												ROOT = {
													society_member_of = secret_religious_society_hamiltonian
												}
											}
											AND = {
												has_province_modifier = secret_jeffersonian_community
												ROOT = {
													society_member_of = secret_religious_society_jeffersonian
												}
											}
											AND = {
												has_province_modifier = secret_libertarian_community
												ROOT = {
													society_member_of = secret_religious_society_libertarian
												}
											}
											AND = {
												has_province_modifier = secret_consumerist_community
												ROOT = {
													society_member_of = secret_religious_society_consumerist
												}
											}
											AND = {
												has_province_modifier = secret_atomicist_community
												ROOT = {
													society_member_of = secret_religious_society_atomicist
												}
											}
											AND = {
												has_province_modifier = secret_pagan_community
												ROOT = {
													society_member_of = secret_religious_society_pagan
												}
											}
											AND = {
												has_province_modifier = secret_revelationist_reformed_community
												ROOT = {
													society_member_of = secret_religious_society_revelationist_reformed
												}
											}
											AND = {
												has_province_modifier = secret_revelationist_community
												ROOT = {
													society_member_of = secret_religious_society_revelationist
												}
											}
											AND = {
												has_province_modifier = secret_rust_cultist_reformed_community
												ROOT = {
													society_member_of = secret_religious_society_rust_cultist_reformed
												}
											}
											AND = {
												has_province_modifier = secret_rust_cultist_community
												ROOT = {
													society_member_of = secret_religious_society_rust_cultist
												}
											}
											AND = {
												has_province_modifier = secret_occultist_reformed_community
												ROOT = {
													society_member_of = secret_religious_society_occultist_reformed
												}
											}
											AND = {
												has_province_modifier = secret_occultist_community
												ROOT = {
													society_member_of = secret_religious_society_occultist
												}
											}
											AND = {
												has_province_modifier = secret_thelemic_reformed_community
												ROOT = {
													society_member_of = secret_religious_society_thelemic_reformed
												}
											}
											AND = {
												has_province_modifier = secret_thelemic_community
												ROOT = {
													society_member_of = secret_religious_society_thelemic
												}
											}
											AND = {
												has_province_modifier = secret_norse_pagan_reformed_community
												ROOT = {
													society_member_of = secret_religious_society_norse_pagan_reformed
												}
											}
											AND = {
												has_province_modifier = secret_norse_pagan_community
												ROOT = {
													society_member_of = secret_religious_society_norse_pagan
												}
											}
											AND = {
												has_province_modifier = secret_celticist_community
												ROOT = {
													society_member_of = secret_religious_society_celticist
												}
											}
											AND = {
												has_province_modifier = secret_brethren_community
												ROOT = {
													society_member_of = secret_religious_society_brethren
												}
											}
											AND = {
												has_province_modifier = secret_jewish_community
												ROOT = {
													society_member_of = secret_religious_society_jewish
												}
											}
											AND = {
												has_province_modifier = secret_reform_community
												ROOT = {
													society_member_of = secret_religious_society_reform
												}
											}
											AND = {
												has_province_modifier = secret_hindu_community
												ROOT = {
													society_member_of = secret_religious_society_hindu
												}
											}
										}
									}
								}
								if = {
									limit = { NOT = { has_character_flag = currently_part_of_secret_religion_uncovering } }
									character_event = { id = MNM.3820 } # Flip provinces with local cult modifier
								}
								if = {
									limit = { has_character_flag = currently_part_of_secret_religion_uncovering }
									ROOT = {
										trigger_switch = {
											on_trigger = society_member_of
											secret_religious_society_rastafarian = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_rastafarian_community
														}
														religion = rastafarian
														remove_province_modifier = secret_rastafarian_community
													}
												}
											}
											secret_religious_society_voodoo = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_voodoo_community
														}
														religion = voodoo
														remove_province_modifier = secret_voodoo_community
													}
												}
											}
											secret_religious_society_santeria = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_santeria_community
														}
														religion = santeria
														remove_province_modifier = secret_santeria_community
													}
												}
											}
											secret_religious_society_candomble = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_candomble_community
														}
														religion = candomble
														remove_province_modifier = secret_candomble_community
													}
												}
											}
											secret_religious_society_espiritista = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_espiritista_community
														}
														religion = espiritista
														remove_province_modifier = secret_espiritista_community
													}
												}
											}
											secret_religious_society_espiritista_reformed = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_espiritista_reformed_community
														}
														religion = espiritista_reformed
														remove_province_modifier = secret_espiritista_reformed_community
													}
												}
											}
											secret_religious_society_ghost_dance = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_ghost_dance_community
														}
														religion = ghost_dance
														remove_province_modifier = secret_ghost_dance_community
													}
												}
											}
											secret_religious_society_raven_tales = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_raven_tales_community
														}
														religion = raven_tales
														remove_province_modifier = secret_raven_tales_community
													}
												}
											}
											secret_religious_society_catholic = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_catholic_community
														}
														religion = catholic
														remove_province_modifier = secret_catholic_community
													}
												}
											}
											secret_religious_society_neognostic = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_neognostic_community
														}
														religion = neognostic
														remove_province_modifier = secret_neognostic_community
													}
												}
											}
											secret_religious_society_sedevacantist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_sedevacantist_community
														}
														religion = sedevacantist
														remove_province_modifier = secret_sedevacantist_community
													}
												}
											}
											secret_religious_society_ursuline = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_ursuline_community
														}
														religion = ursuline
														remove_province_modifier = secret_ursuline_community
													}
												}
											}
											secret_religious_society_angeline = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_angeline_community
														}
														religion = angeline
														remove_province_modifier = secret_angeline_community
													}
												}
											}
											secret_religious_society_confederated = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_confederated_community
														}
														religion = confederated
														remove_province_modifier = secret_confederated_community
													}
												}
											}
											secret_religious_society_anabaptist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_anabaptist_community
														}
														religion = anabaptist
														remove_province_modifier = secret_anabaptist_community
													}
												}
											}
											secret_religious_society_evangelical = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_evangelical_community
														}
														religion = evangelical
														remove_province_modifier = secret_evangelical_community
													}
												}
											}
											secret_religious_society_antinomian = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_antinomian_community
														}
														religion = antinomian
														remove_province_modifier = secret_antinomian_community
													}
												}
											}
											secret_religious_society_charismatic = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_charismatic_community
														}
														religion = charismatic
														remove_province_modifier = secret_charismatic_community
													}
												}
											}
											secret_religious_society_falling_star = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_falling_star_community
														}
														religion = falling_star
														remove_province_modifier = secret_falling_star_community
													}
												}
											}
											secret_religious_society_high_church = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_high_church_community
														}
														religion = high_church
														remove_province_modifier = secret_high_church_community
													}
												}
											}
											secret_religious_society_anglo_papalist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_anglo_papalist_community
														}
														religion = anglo_papalist
														remove_province_modifier = secret_anglo_papalist_community
													}
												}
											}
											secret_religious_society_united_church = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_united_church_community
														}
														religion = united_church
														remove_province_modifier = secret_united_church_community
													}
												}
											}
											secret_religious_society_sacred_heart = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_sacred_heart_community
														}
														religion = sacred_heart
														remove_province_modifier = secret_sacred_heart_community
													}
												}
											}
											secret_religious_society_gracia_divina = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_gracia_divina_community
														}
														religion = gracia_divina
														remove_province_modifier = secret_gracia_divina_community
													}
												}
											}
											secret_religious_society_cetic = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_cetic_community
														}
														religion = cetic
														remove_province_modifier = secret_cetic_community
													}
												}
											}
											secret_religious_society_gaian = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_gaian_community
														}
														religion = gaian
														remove_province_modifier = secret_gaian_community
													}
												}
											}
											secret_religious_society_shinto = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_shinto_community
														}
														religion = shinto
														remove_province_modifier = secret_shinto_community
													}
												}
											}
											secret_religious_society_nousthreskeia = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_nousthreskeia_community
														}
														religion = nousthreskeia
														remove_province_modifier = secret_nousthreskeia_community
													}
												}
											}
											secret_religious_society_mormon = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_mormon_community
														}
														religion = mormon
														remove_province_modifier = secret_mormon_community
													}
												}
											}
											secret_religious_society_bickertonite = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_bickertonite_community
														}
														religion = bickertonite
														remove_province_modifier = secret_bickertonite_community
													}
												}
											}
											secret_religious_society_godbeite = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_godbeite_community
														}
														religion = godbeite
														remove_province_modifier = secret_godbeite_community
													}
												}
											}
											secret_religious_society_strangite = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_strangite_community
														}
														religion = strangite
														remove_province_modifier = secret_strangite_community
													}
												}
											}
											secret_religious_society_sol_invicta = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_sol_invicta_community
														}
														religion = sol_invicta
														remove_province_modifier = secret_sol_invicta_community
													}
												}
											}
											secret_religious_society_mictlantec = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_mictlantec_community
														}
														religion = mictlantec
														remove_province_modifier = secret_mictlantec_community
													}
												}
											}
											secret_religious_society_uahomche = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_uahomche_community
														}
														religion = uahomche
														remove_province_modifier = secret_uahomche_community
													}
												}
											}
											secret_religious_society_neomayan = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_neomayan_community
														}
														religion = neomayan
														remove_province_modifier = secret_neomayan_community
													}
												}
											}
											secret_religious_society_americanist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_americanist_community
														}
														religion = americanist
														remove_province_modifier = secret_americanist_community
													}
												}
											}
											secret_religious_society_hamiltonian = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_hamiltonian_community
														}
														religion = hamiltonian
														remove_province_modifier = secret_hamiltonian_community
													}
												}
											}
											secret_religious_society_jeffersonian = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_jeffersonian_community
														}
														religion = jeffersonian
														remove_province_modifier = secret_jeffersonian_community
													}
												}
											}
											secret_religious_society_libertarian = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_libertarian_community
														}
														religion = libertarian
														remove_province_modifier = secret_libertarian_community
													}
												}
											}
											secret_religious_society_consumerist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_consumerist_community
														}
														religion = consumerist
														remove_province_modifier = secret_consumerist_community
													}
												}
											}
											secret_religious_society_atomicist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_atomicist_community
														}
														religion = atomicist
														remove_province_modifier = secret_atomicist_community
													}
												}
											}
											secret_religious_society_pagan = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_pagan_community
														}
														religion = pagan
														remove_province_modifier = secret_pagan_community
													}
												}
											}
											secret_religious_society_revelationist_reformed = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_revelationist_reformed_community
														}
														religion = revelationist_reformed
														remove_province_modifier = secret_revelationist_reformed_community
													}
												}
											}
											secret_religious_society_revelationist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_revelationist_community
														}
														religion = revelationist
														remove_province_modifier = secret_revelationist_community
													}
												}
											}
											secret_religious_society_rust_cultist_reformed = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_rust_cultist_reformed_community
														}
														religion = rust_cultist_reformed
														remove_province_modifier = secret_rust_cultist_reformed_community
													}
												}
											}
											secret_religious_society_rust_cultist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_rust_cultist_community
														}
														religion = rust_cultist
														remove_province_modifier = secret_rust_cultist_community
													}
												}
											}
											secret_religious_society_occultist_reformed = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_occultist_reformed_community
														}
														religion = occultist_reformed
														remove_province_modifier = secret_occultist_reformed_community
													}
												}
											}
											secret_religious_society_occultist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_occultist_community
														}
														religion = occultist
														remove_province_modifier = secret_occultist_community
													}
												}
											}
											secret_religious_society_thelemic_reformed = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_thelemic_reformed_community
														}
														religion = thelemic_reformed
														remove_province_modifier = secret_thelemic_reformed_community
													}
												}
											}
											secret_religious_society_thelemic = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_thelemic_community
														}
														religion = thelemic
														remove_province_modifier = secret_thelemic_community
													}
												}
											}
											secret_religious_society_norse_pagan_reformed = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_norse_pagan_reformed_community
														}
														religion = norse_pagan_reformed
														remove_province_modifier = secret_norse_pagan_reformed_community
													}
												}
											}
											secret_religious_society_norse_pagan = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_norse_pagan_community
														}
														religion = norse_pagan
														remove_province_modifier = secret_norse_pagan_community
													}
												}
											}
											secret_religious_society_celticist = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_celticist_community
														}
														religion = celticist
														remove_province_modifier = secret_celticist_community
													}
												}
											}
											secret_religious_society_brethren = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_brethren_community
														}
														religion = brethren
														remove_province_modifier = secret_brethren_community
													}
												}
											}
											secret_religious_society_jewish = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_jewish_community
														}
														religion = jewish
														remove_province_modifier = secret_jewish_community
													}
												}
											}
											secret_religious_society_reform = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_reform_community
														}
														religion = reform
														remove_province_modifier = secret_reform_community
													}
												}
											}
											secret_religious_society_hindu = {
												PREV = {
													any_demesne_province = {
														limit = {
															has_province_modifier = secret_hindu_community
														}
														religion = hindu
														remove_province_modifier = secret_hindu_community
													}
												}
											}
										}
									}
								}
							}
						}
					}
					flip_secret_religious_community_provinces = yes
					flip_to_secret_religion_effect = yes
					
					top_liege = {
						any_realm_lord = {
							character_event = { id = MNM.3830 } # Inform lieges unless they're part of the cult flipping, save a flag on previous events.
						}
						
						any_realm_character = {
							limit = {
								NOT = {
									character = ROOT
								}
								same_society_as = ROOT
							}
							leave_society = yes
						}
						
						any_realm_character = {
							limit = {
								has_character_flag = currently_part_of_secret_religion_uncovering
							}
							clr_character_flag = currently_part_of_secret_religion_uncovering
						}
					}
					any_society_member = {
						limit = {
							NOT = {
								character = ROOT
							}
							same_society_as = ROOT
						}
						leave_society = yes
					}
					leave_society = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1 # Slow down
			}
			modifier = {
				factor = 0.1
				is_landed = no
			}
			modifier = {
				factor = 0
				prisoner = yes
			}
			modifier = {
				factor = 0.001
				any_society_member = {
					NOT = { character = ROOT }
					same_realm = ROOT
					ai = no
				}
				NOT = {
					top_liege = {
						OR = {
							same_society_as = ROOT
							is_openly_of_roots_secret_religion_trigger = yes
						}
					}
				}
			}
			modifier = {
				factor = 0
				top_liege = {
					war = yes
				}
			}
			modifier = { #Don't do it unless you are confident in support
				factor = 0
				NOR = {
					AND = { # The Top Liege is in the Secret Cult, and at least 3 of the Liege's direct vassals are also members
						top_liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_roots_secret_religion_trigger = yes
							}
						}
						top_liege = {
							any_vassal = {
								count = 3
								higher_tier_than = BARON
								prisoner = no
								OR = {
									same_society_as = ROOT
									is_openly_of_roots_secret_religion_trigger = yes
								}
							}
						}
					}
					top_liege = { # At least 5 direct vassals of the Top Liege is in the Secret Cult
						any_vassal = {
							count = 5
							higher_tier_than = BARON
							prisoner = no
							OR = {
								same_society_as = ROOT
								is_openly_of_roots_secret_religion_trigger = yes
							}
						}
					}
					top_liege = { # All direct vassals of the Top Liege are in the Secret Cult
						NOT = {
							any_vassal = {
								higher_tier_than = BARON
								NOR = {
									same_society_as = ROOT
									is_openly_of_roots_secret_religion_trigger = yes
								}
							}
						}
					}
					top_liege = {
						realm_character_percent = {
							target = 0.30
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
					}
					AND = {
						top_liege = {
							realm_character_percent = {
								target = 0.25
								OR = {
									same_society_as = ROOT
									is_openly_of_prevs_secret_religion_trigger = yes
								}
							}
						}
						liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
					}
					AND = {
						top_liege = {
							realm_character_percent = {
								target = 0.20
								OR = {
									same_society_as = ROOT
									is_openly_of_prevs_secret_religion_trigger = yes
								}
							}
						}
						top_liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
						liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
					}
					AND = {
						top_liege = {
							realm_character_percent = {
								target = 0.15
								OR = {
									same_society_as = ROOT
									is_openly_of_prevs_secret_religion_trigger = yes
								}
							}
						}
						any_vassal = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
						top_liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
						liege = {
							OR = {
								same_society_as = ROOT
								is_openly_of_prevs_secret_religion_trigger = yes
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.15
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}				
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.25
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}				
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.35
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}				
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.5
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}				
			}
			modifier = {
				factor = 1.5
				realm_character_percent = {
					target = 0.65
					OR = {
						same_society_as = ROOT
						is_openly_of_prevs_secret_religion_trigger = yes
					}
				}				
			}
		}
	}

	secret_religions_blend_in = {
		
		potential = {
			society_member_of = secret_religious_cult
			has_quest = quest_secret_religions_societies_blend_in
			NOT = { has_character_modifier = attempting_to_blend_in }
		}
		allow = {
			has_quest = quest_secret_religions_societies_blend_in
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = quest_secret_religions_societies_blend_in_allow_tt
				OR = {
					NOT = { has_character_flag = blending_in_timer }
					had_character_flag = { flag = blending_in_timer days = 1000 }
				}
			}
		}

		effect = {
			add_character_modifier = {
				name = attempting_to_blend_in
				duration = -1
			}
			hidden_effect = { character_event = { id = MNM.3399 } }
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0.1

			modifier = {
				factor = 0.01
				war = yes
			}
			modifier = {
				factor = 2
				OR = {
					trait = gregarious
					trait = socializer
				}
			}
			modifier = {
				factor = 0.1
				trait = shy
			}
			modifier = {
				factor = 0.1
				is_dumb_trigger = yes
			}
		}
	}
}

targeted_decisions = {
	secret_religions_conduct_secret_ceremony = {
		is_in_society = yes
		
		filter = self
		ai_target_filter = self
		
		potential = {
			society_member_of = secret_religious_cult
			has_quest = quest_secret_religions_conduct_secret_ceremony 
		}
		allow = {
			has_quest = quest_secret_religions_conduct_secret_ceremony
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = quest_secret_religions_conduct_secret_ceremony_allow_tt
				OR = {
					NOT = { has_character_flag = conduct_secret_ceremony_timer }
					had_character_flag = { flag = conduct_secret_ceremony_timer days = 1000 }
				}
			}
		}

		effect = {
			set_character_flag = conduct_secret_ceremony_timer
			hidden_effect = { character_event = { id = MNM.3235 days = 5 } }
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0.1
			modifier = {
				is_ruler = yes
				factor = 10
			}
			modifier = {
				diplomacy = 12
    			factor = 3
			}
			modifier = {
				diplomacy = 15
    			factor = 3
			}
			modifier = {
				trait = paranoid
    			factor = 0.1
			}
			modifier = {
				trait = craven
    			factor = 0.1
			}
		}
	}
	
	secret_religions_induct_child = {
		is_in_society = yes
		
		ai_target_filter = home_court

		from_potential = {
			society_member_of = secret_religious_cult
		}

		potential = {
			NOT = {
				character = FROM
			}
			OR = {
				mother = { character = FROM }
				father = { character = FROM }
				educator = { character = FROM }
				guardian = { character = FROM }
			}
			has_secret_religion_trait_trigger = no
			FROM = { ROOT = { is_openly_of_prevs_secret_religion_trigger = no } }
			is_adult = no
		}

		allow = {
			FROM = {
				prisoner = no
				is_inaccessible_trigger = no
				NOT = { trait = incapable }
			}
			age = 8
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = secret_religions_induct_child_allow_tt
				FROM = { shares_prevs_secret_religion_trigger = no }
			}
			custom_tooltip = {
				text = secret_religions_induct_character_cd_tt
				NOT = { has_character_modifier = secret_religions_induct_child_timer }
			}
		}

		effect = {
			custom_tooltip = {
				text = secret_religions_induct_child_effect

				FROM = { character_event = { id = MNM.3438 } }

				hidden_effect = {
					add_character_modifier = {
						name = secret_religions_induct_child_timer
						years = 6
						hidden = yes
					}
				}
			}
			FROM = { 
				if = { 
					limit = {
						is_society_grandmaster = yes
					}
					increase_visibility_minor_effect = yes
				}
				if = {
					limit = {
						NOT = { is_society_grandmaster = yes }
					}
					increase_visibility_effect = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_induct_ruler }
    			is_quest_target_of = FROM
    			factor = 100
			}
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_induct_ruler }
    			NOT = {
					is_quest_target_of = FROM
				}
    			factor = 0.01
			}
			modifier = {
				OR = {
					mother = { character = FROM }
					father = { character = FROM }
				}
				factor = 10
			}
			modifier = {
				FROM = { current_heir = { character = ROOT } }
				factor = 10
			}
			modifier = {
				is_friend = FROM
				factor = 10
			}
			modifier = {
				trait = trusting
				factor = 5
			}
			modifier = {
				ai = no
				factor = 5
			}
			modifier = {
				OR = {
					mother = { ai = no }
					father = { ai = no }
				}
				factor = 0.1
			}
		}
	}
	
	secret_religions_recruit = {
		is_in_society = yes
		
		filter = realm 
		ai_target_filter = realm

		from_potential = {
			society_member_of = secret_religious_cult
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			OR = { # Performance saving measures
				has_society_currency_tiny_trigger = yes
				ai = no
			}
			OR = {
				ai = no
				is_society_grandmaster = yes
				num_of_society_members < 90
			}
		}

		potential = {
			OR = {
				FROM = { ai = no } #Either a player is using the decision, OR the target is interested in the AI's secret religious cult
				ai = yes # Or the target is an AI...
				AND = {
					ai = no
					is_in_society = no
					interested_in_society_of_character = FROM
				}
			}
			
			FROM = {
				OR = {
					ai = yes
					same_realm = PREV
				}
				secret_religion = PREV
			}
			
			is_adult = yes
			NOT = {
				character = FROM
				society = {
					FROM = {
						society = {
							society_type = prevprev
						}
					}
				}
			}

			#AI can't invite when the society is full
			NAND = {
				ai = yes
				FROM = { ai = yes }
				NOT = {
					FROM = {
						society = {
							ROOT = {
								can_join_society = PREV
							}
						}
					}
				}
			}
		}

		allow = {
			FROM = {
				NOT = {
					has_character_modifier = accused_apostate
				}
				prisoner = no
				is_inaccessible_trigger = no
				NOT = { trait = incapable }
			}
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = secret_religions_recruit_allow_tt
				FROM = { shares_prevs_secret_religion_trigger = yes }
			}
			custom_tooltip = {
				text = secret_religions_recruit_cd_tt
				NOT = { has_character_modifier = secret_religions_recruitment_timer }
			}
		}

		effect = {
			custom_tooltip = { 	
				text = secret_religions_recruit_effect_tt
				FROM = { save_event_target_as = secret_religion_recruiter } 
				character_event = { id = MNM.3420 }

				add_character_modifier = {
					name = secret_religions_recruitment_timer
					years = 10
					hidden = yes
				}
			}
			FROM = { 
				if = { 
					limit = {
						is_society_grandmaster = yes
					}
					increase_visibility_minor_effect = yes
				}
				if = {
					limit = {
						NOT = { is_society_grandmaster = yes }
					}
					increase_visibility_effect = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				is_ruler = yes
				factor = 10
			}
			modifier = {
				ai = no
				factor = 5
			}
			modifier = {
				diplomacy = 12
    			factor = 3
			}
			modifier = {
				diplomacy = 15
    			factor = 3
			}
			modifier = {
				trait = paranoid
    			factor = 0.1
			}
			modifier = {
				trait = craven
    			factor = 0.1
			}
			modifier = {
				factor = 0 # don't recruit characters interested in something else
				NOT = { interested_in_society = secret_religious_cult }
				is_interested_in_any_society = yes
			}
			modifier = {
				NOT = {
					any_realm_character = {
						ai = no
					}
				}
    			factor = 0.1
			}
		}
	}

	secret_religions_induct_character = {
		is_in_society = yes
		
		filter = realm
		ai_target_filter = realm
		
		from_potential = {
			society_member_of = secret_religious_cult
			society_rank >= 2
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			OR = { # Performance saving measure
				has_society_currency_tiny_trigger = yes
				ai = no
			}
			OR = {
				ai = no
				is_society_grandmaster = yes
				num_of_society_members < 90
			}
		}
		
		potential = {
			NOT = {
				character = FROM
			}
			is_adult = yes
			FROM = { 
				ROOT = { 
					NOT = {
						secret_religion = PREV
					}
					is_openly_of_prevs_secret_religion_trigger = no
				} 
			}
			FROM = { 
				ROOT = { 
					OR = {
						has_sympathy_for_true_religion_of_prev_trigger = yes
						is_openly_of_prevs_true_religion_group = yes 
					}
				}
			}
		}

		allow = {
			FROM = {
				NOT = {
					has_character_modifier = accused_apostate
				}
				prisoner = no
				is_inaccessible_trigger = no
				NOT = { trait = incapable }
			}
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = secret_religions_induct_character_cd_tt
				OR = {
					NOT = { has_character_modifier = secret_religion_induction_timer }
					has_quest = quest_secret_religious_societies_induct_ruler
				}
			}
			OR = {
				AND = {
					is_ruler = no
					FROM = { has_society_currency_tiny_trigger = yes }
				}
				hidden_tooltip = {
					FROM = {
						has_society_currency_tiny_trigger = yes
						ai = yes
						is_society_grandmaster = yes
					}
				}
				AND = {
					is_ruler = yes
					FROM = { has_society_currency_minor_trigger = yes }
				}
			}
		}

		effect = {
			if = {
				limit = { 
					is_ruler = no  
					hidden_tooltip = {
						FROM = {
							NAND = {
								ai = yes
								is_society_grandmaster = yes
							}
						}
					}
				}
				FROM = { detract_society_currency_tiny_effect = yes }
			}
			if = {
				limit = {
					FROM = {
						ai = yes
						is_society_grandmaster = yes
					}
				}
				FROM = { detract_society_currency_tiny_effect = yes }
			}
			if = {
				limit = {
					is_ruler = yes
					hidden_tooltip = {
						FROM = {
							NAND = {
								ai = yes
								is_society_grandmaster = yes
							}
						}
					}
				}
				FROM = { detract_society_currency_minor_effect = yes }
			}

			hidden_effect = {
				add_character_modifier = {
					name = secret_religion_induction_timer
					years = 10
					hidden = yes
				}
			}

			custom_tooltip = {
				text = secret_religions_induct_character_effect_tt
				FROM = { character_event = { id = MNM.3408 days = 10 } }
			}
			FROM = { 
				if = { 
					limit = {
						is_society_grandmaster = yes
					}
					increase_visibility_minor_effect = yes
				}
				if = {
					limit = {
						NOT = { is_society_grandmaster = yes }
					}
					increase_visibility_effect = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_induct_ruler }
    			is_quest_target_of = FROM
    			factor = 100
			}
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_induct_ruler }
				NOT = {
					is_quest_target_of = FROM
				}
				factor = 0.01 #to save targets for missions
			}
			modifier = {
				FROM = {
					NOT = { 
						is_society_grandmaster = yes
					}
				}
				factor = 0.1
			}
			modifier = {
				ai = no
				factor = 5
			}
			modifier = {
				is_ruler = yes
				factor = 10
			}
			modifier = {
				is_close_relative = FROM
				factor = 10
			}
			modifier = {
				is_lover = FROM
				factor = 10
			}
			modifier = {
				is_friend = FROM
				factor = 10
			}
			modifier = {
				trait = trusting
				factor = 5
			}
			modifier = {
				ai = no
				factor = 5
			}
			modifier = {
				NOT = {
					any_realm_character = {
						ai = no
					}
				}
    			factor = 0.01
			}
		}
	}
	
	secret_religions_evoke_sympathy = {
		is_in_society = yes
		
		filter = realm 
		ai_target_filter = realm

		from_potential = {
			society_member_of = secret_religious_cult
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			OR = { # Performance saving measure
				has_society_currency_tiny_trigger = yes
				ai = no
			}
			OR = {
				ai = no
				is_society_grandmaster = yes
				num_of_society_members < 90
			}
		}

		potential = {
			same_realm = FROM
			is_adult = yes
			NOT = { same_society_as = FROM }
			FROM = { 
				ROOT = { 
					has_sympathy_for_true_religion_of_prev_trigger = no
					is_openly_of_prevs_true_religion_group = no
					shares_prevs_secret_religion_trigger = no
				}
			}
			NOT = { 
				character = FROM
				society = {
					FROM = {
						society = {
							society_type = PREVPREV
						}
					}
				}
			}
		}

		allow = {
			FROM = {
				NOT = {
					has_character_modifier = accused_apostate
				}
				prisoner = no
				is_inaccessible_trigger = no
				NOT = { trait = incapable }
			}
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = secret_religions_evoke_sympathy_cd_tt
				OR = {
					NOT = { has_character_modifier = secret_religion_sympathy_timer }
					AND = {
						FROM = {
							has_quest = quest_secret_religious_societies_sympathy_ruler
							ROOT = { is_quest_target_of = FROM }
						}
					}
				}
			}
			FROM = {
				OR = {
					custom_tooltip = {
						text = evoke_sympathy_of_tt
						has_quest = quest_secret_religious_societies_sympathy_ruler
						ROOT = { is_quest_target_of = FROM }
					}
					has_society_currency_tiny_trigger = yes
				}
			}
		}

		effect = {
			if = {
				limit = {
					NOT = {
						AND = {
							FROM = { has_quest = quest_secret_religious_societies_sympathy_ruler }
							ROOT = { is_quest_target_of = FROM }
						}
					}
				}
				FROM = { detract_society_currency_tiny_effect = yes }
			}

			hidden_effect = {
				add_character_modifier = {
					name = secret_religion_sympathy_timer
					years = 10
					hidden = yes
				}
			}

			custom_tooltip = {
				text = secret_religions_evoke_sympathy_tt
				FROM = { character_event = { id = MNM.3404 days = 7 } }
			}
			FROM = {
				if = {
					limit = {
						NOT = { is_society_grandmaster = yes }
					}
					increase_visibility_minor_effect = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_sympathy_ruler }
    			is_quest_target_of = FROM
    			factor = 100
			}
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_sympathy_ruler }
				NOT = {
					is_quest_target_of = FROM
				}
				factor = 0.01 #to save targets for missions
			}
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_induct_ruler } #to complete this mission, sympathy is needed first
    			is_quest_target_of = FROM
    			factor = 100
			}
			modifier = {
				FROM = { has_quest = quest_secret_religious_societies_induct_ruler }
    			NOT = {
					is_quest_target_of = FROM
				}
    			factor = 0.01
			}
			modifier = {
				FROM = {
					NOT = { 
						is_society_grandmaster = yes
					}
				}
				factor = 0.1
			}
			modifier = {
				is_ruler = yes
				factor = 3
			}
			modifier = {
				trait = zealous
				factor = 0.0001
			}
			modifier = {
				is_close_relative = FROM
				factor = 10
			}
			modifier = {
				is_lover = FROM
				factor = 10
			}
			modifier = {
				is_friend = FROM
				factor = 10
			}
			modifier = {
				trait = kind
				factor = 5
			}
			modifier = {
				trait = trusting
				factor = 5
			}
			modifier = {
				ai = no
				factor = 5
			}
		}
	}
	
	secret_religions_renounce_secret_religion = {
		only_playable = yes
		
		filter = self
		ai_target_filter = self
		
		potential = {
			character = FROM
			has_secret_religion = yes
		}
		
		allow = {
			NOT = { trait = incapable }
		}
		
		effect = {
			if = {
				limit = {
					society_member_of = secret_religious_cult
					is_society_grandmaster = yes
				}
				leave_society = yes
			}
			clear_secret_religion = yes
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secret_religions_personally_adopt_secret_religion = {
		only_playable = yes
		
		filter = self
		ai_target_filter = self
		
		potential = {
			character = FROM
			has_secret_religion = yes
		}
		
		allow = {
			NOT = { trait = incapable }
		}
		
		effect = {
			flip_to_secret_religion_effect = yes
			trigger_switch = {
				on_trigger = religion
				rastafarian = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_rastafarian_community } religion = rastafarian
					}
				}
				voodoo = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_voodoo_community } religion = voodoo
					}
				}
				santeria = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_santeria_community } religion = santeria
					}
				}
				candomble = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_candomble_community } religion = candomble
					}
				}
				espiritista = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_espiritista_community } religion = espiritista
					}
				}
				espiritista_reformed = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_espiritista_reformed_community } religion = espiritista_reformed
					}
				}
				ghost_dance = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_ghost_dance_community } religion = ghost_dance
					}
				}
				raven_tales = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_raven_tales_community } religion = raven_tales
					}
				}
				catholic = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_catholic_community } religion = catholic
					}
				}
				neognostic = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_neognostic_community } religion = neognostic
					}
				}
				sedevacantist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_sedevacantist_community } religion = sedevacantist
					}
				}
				ursuline = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_ursuline_community } religion = ursuline
					}
				}
				angeline = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_angeline_community } religion = angeline
					}
				}
				confederated = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_confederated_community } religion = confederated
					}
				}
				anabaptist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_anabaptist_community } religion = anabaptist
					}
				}
				evangelical = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_evangelical_community } religion = evangelical
					}
				}
				antinomian = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_antinomian_community } religion = antinomian
					}
				}
				charismatic = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_charismatic_community } religion = charismatic
					}
				}
				falling_star = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_falling_star_community } religion = falling_star
					}
				}
				high_church = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_high_church_community } religion = high_church
					}
				}
				anglo_papalist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_anglo_papalist_community } religion = anglo_papalist
					}
				}
				united_church = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_united_church_community } religion = united_church
					}
				}
				sacred_heart = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_sacred_heart_community } religion = sacred_heart
					}
				}
				gracia_divina = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_gracia_divina_community } religion = gracia_divina
					}
				}
				cetic = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_cetic_community } religion = cetic
					}
				}
				gaian = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_gaian_community } religion = gaian
					}
				}
				shinto = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_shinto_community } religion = shinto
					}
				}
				nousthreskeia = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_nousthreskeia_community } religion = nousthreskeia
					}
				}
				mormon = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_mormon_community } religion = mormon
					}
				}
				bickertonite = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_bickertonite_community } religion = bickertonite
					}
				}
				godbeite = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_godbeite_community } religion = godbeite
					}
				}
				strangite = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_strangite_community } religion = strangite
					}
				}
				sol_invicta = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_sol_invicta_community } religion = sol_invicta
					}
				}
				mictlantec = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_mictlantec_community } religion = mictlantec
					}
				}
				uahomche = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_uahomche_community } religion = uahomche
					}
				}
				neomayan = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_neomayan_community } religion = neomayan
					}
				}
				americanist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_americanist_community } religion = americanist
					}
				}
				hamiltonian = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_hamiltonian_community } religion = hamiltonian
					}
				}
				jeffersonian = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_jeffersonian_community } religion = jeffersonian
					}
				}
				libertarian = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_libertarian_community } religion = libertarian
					}
				}
				consumerist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_consumerist_community } religion = consumerist
					}
				}
				atomicist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_atomicist_community } religion = atomicist
					}
				}
				pagan = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_pagan_community } religion = pagan
					}
				}
				pagan = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_pagan_community } religion = pagan
					}
				}
				revelationist_reformed = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_revelationist_reformed_community } religion = revelationist_reformed
					}
				}
				revelationist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_revelationist_community } religion = revelationist
					}
				}
				rust_cultist_reformed = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_rust_cultist_reformed_community } religion = rust_cultist_reformed
					}
				}
				rust_cultist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_rust_cultist_community } religion = rust_cultist
					}
				}
				occultist_reformed = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_occultist_reformed_community } religion = occultist_reformed
					}
				}
				occultist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_occultist_community } religion = occultist
					}
				}
				thelemic_reformed = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_thelemic_reformed_community } religion = thelemic_reformed
					}
				}
				thelemic = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_thelemic_community } religion = thelemic
					}
				}
				norse_pagan_reformed = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_norse_pagan_reformed_community } religion = norse_pagan_reformed
					}
				}
				norse_pagan = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_norse_pagan_community } religion = norse_pagan
					}
				}
				celticist = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_celticist_community } religion = celticist
					}
				}
				brethren = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_brethren_community } religion = brethren
					}
				}
				jewish = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_jewish_community } religion = jewish
					}
				}
				reform = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_reform_community } religion = reform
					}
				}
				hindu = {
					any_demesne_province = {
						limit = { has_province_modifier = secret_hindu_community } religion = hindu
					}
				}
			}
			if = {
				limit = {
					liege = {
						NOT = {
							character = ROOT
						}
					}
				}
				liege = {
					character_event = { id = MNM.3840 }
				}
			}
			hidden_tooltip = {
				set_variable = { which = visibility_value value = 0 }
				remove_character_modifier = highly_suspect
				remove_character_modifier = under_suspicion
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
}

#########################################################################################################
################ Secret society title decisions
#########################################################################################################
title_decisions = {
	secret_religions_prepare_grounds = {
		only_playable = yes
		
		ai_target_filter = realm_owned
		filter = realm_owned
		
		from_potential = {
			society_rank > 2
			society_member_of = secret_religious_cult
		}
		
		potential = {
			tier = COUNT
			holder_scope = {
				OR = {
					character = FROM
					any_liege = { character = FROM }
				}
			}
			OR = {
				AND = {
					FROM = {
						society_member_of = secret_religious_society_rastafarian
					}
					NOT = { location = { religion = rastafarian } }
					NOT = { location = { has_province_modifier = secret_rastafarian_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_voodoo
					}
					NOT = { location = { religion = voodoo } }
					NOT = { location = { has_province_modifier = secret_voodoo_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_santeria
					}
					NOT = { location = { religion = santeria } }
					NOT = { location = { has_province_modifier = secret_santeria_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_candomble
					}
					NOT = { location = { religion = candomble } }
					NOT = { location = { has_province_modifier = secret_candomble_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_espiritista
					}
					NOT = { location = { religion = es } }
					NOT = { location = { has_province_modifier = secret_espiritista_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_espiritista_reformed
					}
					NOT = { location = { religion = espiritista_reformed } }
					NOT = { location = { has_province_modifier = secret_espiritista_reformed_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_ghost_dance
					}
					NOT = { location = { religion = ghost_dance } }
					NOT = { location = { has_province_modifier = secret_ghost_dance_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_raven_tales
					}
					NOT = { location = { religion = raven_tales } }
					NOT = { location = { has_province_modifier = secret_raven_tales_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_catholic
					}
					NOT = { location = { religion = catholic } }
					NOT = { location = { has_province_modifier = secret_catholic_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_neognostic
					}
					NOT = { location = { religion = neognostic } }
					NOT = { location = { has_province_modifier = secret_neognostic_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_sedevacantist
					}
					NOT = { location = { religion = sedevacantist } }
					NOT = { location = { has_province_modifier = secret_sedevacantist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_ursuline
					}
					NOT = { location = { religion = ursuline } }
					NOT = { location = { has_province_modifier = secret_ursuline_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_angeline
					}
					NOT = { location = { religion = angeline } }
					NOT = { location = { has_province_modifier = secret_angeline_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_confederated
					}
					NOT = { location = { religion = confederated } }
					NOT = { location = { has_province_modifier = secret_confederated_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_anabaptist
					}
					NOT = { location = { religion = anabaptist } }
					NOT = { location = { has_province_modifier = secret_anabaptist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_evangelical
					}
					NOT = { location = { religion = evangelical } }
					NOT = { location = { has_province_modifier = secret_evangelical_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_antinomian
					}
					NOT = { location = { religion = antinomian } }
					NOT = { location = { has_province_modifier = secret_antinomian_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_charismatic
					}
					NOT = { location = { religion = charismatic } }
					NOT = { location = { has_province_modifier = secret_charismatic_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_falling_star
					}
					NOT = { location = { religion = falling_star } }
					NOT = { location = { has_province_modifier = secret_falling_star_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_high_church
					}
					NOT = { location = { religion = high_church } }
					NOT = { location = { has_province_modifier = secret_high_church_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_anglo_papalist
					}
					NOT = { location = { religion = anglo_papalist } }
					NOT = { location = { has_province_modifier = secret_anglo_papalist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_united_church
					}
					NOT = { location = { religion = united_church } }
					NOT = { location = { has_province_modifier = secret_united_church_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_sacred_heart
					}
					NOT = { location = { religion = sacred_heart } }
					NOT = { location = { has_province_modifier = secret_sacred_heart_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_gracia_divina
					}
					NOT = { location = { religion = gracia_divina } }
					NOT = { location = { has_province_modifier = secret_gracia_divina_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_cetic
					}
					NOT = { location = { religion = cetic } }
					NOT = { location = { has_province_modifier = secret_cetic_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_gaian
					}
					NOT = { location = { religion = gaian } }
					NOT = { location = { has_province_modifier = secret_gaian_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_shinto
					}
					NOT = { location = { religion = shinto } }
					NOT = { location = { has_province_modifier = secret_shinto_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_nousthreskeia
					}
					NOT = { location = { religion = nousthreskeia } }
					NOT = { location = { has_province_modifier = secret_nousthreskeia_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_mormon
					}
					NOT = { location = { religion = mormon } }
					NOT = { location = { has_province_modifier = secret_mormon_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_bickertonite
					}
					NOT = { location = { religion = bickertonite } }
					NOT = { location = { has_province_modifier = secret_bickertonite_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_godbeite
					}
					NOT = { location = { religion = godbeite } }
					NOT = { location = { has_province_modifier = secret_godbeite_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_strangite
					}
					NOT = { location = { religion = strangite } }
					NOT = { location = { has_province_modifier = secret_strangite_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_sol_invicta
					}
					NOT = { location = { religion = sol_invicta } }
					NOT = { location = { has_province_modifier = secret_sol_invicta_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_mictlantec
					}
					NOT = { location = { religion = mictlantec } }
					NOT = { location = { has_province_modifier = secret_mictlantec_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_uahomche
					}
					NOT = { location = { religion = uahomche } }
					NOT = { location = { has_province_modifier = secret_uahomche_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_neomayan
					}
					NOT = { location = { religion = neomayan } }
					NOT = { location = { has_province_modifier = secret_neomayan_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_americanist
					}
					NOT = { location = { religion = americanist } }
					NOT = { location = { has_province_modifier = secret_americanist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_hamiltonian
					}
					NOT = { location = { religion = hamiltonian } }
					NOT = { location = { has_province_modifier = secret_hamiltonian_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_jeffersonian
					}
					NOT = { location = { religion = jeffersonian } }
					NOT = { location = { has_province_modifier = secret_jeffersonian_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_libertarian
					}
					NOT = { location = { religion = libertarian } }
					NOT = { location = { has_province_modifier = secret_libertarian_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_consumerist
					}
					NOT = { location = { religion = consumerist } }
					NOT = { location = { has_province_modifier = secret_consumerist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_atomicist
					}
					NOT = { location = { religion = atomicist } }
					NOT = { location = { has_province_modifier = secret_atomicist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_pagan
					}
					NOT = { location = { religion = pagan } }
					NOT = { location = { has_province_modifier = secret_pagan_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_revelationist_reformed
					}
					NOT = { location = { religion = revelationist_reformed } }
					NOT = { location = { has_province_modifier = secret_revelationist_reformed_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_revelationist
					}
					NOT = { location = { religion = revelationist } }
					NOT = { location = { has_province_modifier = secret_revelationist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_rust_cultist_reformed
					}
					NOT = { location = { religion = rust_cultist_reformed } }
					NOT = { location = { has_province_modifier = secret_rust_cultist_reformed_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_rust_cultist
					}
					NOT = { location = { religion = rust_cultist } }
					NOT = { location = { has_province_modifier = secret_rust_cultist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_occultist_reformed
					}
					NOT = { location = { religion = occultist_reformed } }
					NOT = { location = { has_province_modifier = secret_occultist_reformed_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_occultist
					}
					NOT = { location = { religion = occultist } }
					NOT = { location = { has_province_modifier = secret_occultist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_thelemic_reformed
					}
					NOT = { location = { religion = thelemic_reformed } }
					NOT = { location = { has_province_modifier = secret_thelemic_reformed_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_thelemic
					}
					NOT = { location = { religion = thelemic } }
					NOT = { location = { has_province_modifier = secret_thelemic_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_norse_pagan_reformed
					}
					NOT = { location = { religion = norse_pagan_reformed } }
					NOT = { location = { has_province_modifier = secret_norse_pagan_reformed_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_norse_pagan
					}
					NOT = { location = { religion = norse_pagan } }
					NOT = { location = { has_province_modifier = secret_norse_pagan_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_celticist
					}
					NOT = { location = { religion = celticist } }
					NOT = { location = { has_province_modifier = secret_celticist_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_brethren
					}
					NOT = { location = { religion = brethren } }
					NOT = { location = { has_province_modifier = secret_brethren_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_jewish
					}
					NOT = { location = { religion = jewish } }
					NOT = { location = { has_province_modifier = secret_jewish_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_reform
					}
					NOT = { location = { religion = reform } }
					NOT = { location = { has_province_modifier = secret_reform_community } }
				}
				AND = {
					FROM = {
						society_member_of = secret_religious_society_hindu
					}
					NOT = { location = { religion = hindu } }
					NOT = { location = { has_province_modifier = secret_hindu_community } }
				}
			}
		}
		
		allow = {
			FROM = {
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				has_society_currency_medium_trigger = yes
			}
			custom_tooltip = {
				text = prepare_grounds_allow_tooltip
				hidden_trigger = {	
					location = {
						ROOT_FROM = { 
							NOT = { has_character_flag = preparing_grounds_in_@PREV }
						}
					}
				}
			}
		}
		
		effect = {
			location = {
				save_event_target_as = target_province
			}
			FROM = {
				society = {
					save_event_target_as = original_society
				}
				if = {
					limit = { 
						ai = no
					}
					detract_society_currency_medium_effect = yes
				}
				custom_tooltip = {
					text = secret_religions_prepare_grounds_effect_tooltip
					character_event = { id = MNM.3850 days = 2 }
				}
			}
			FROM = { 
				if = { 
					limit = {
						is_society_grandmaster = yes
					}
					increase_visibility_minor_effect = yes
				}
				if = {
					limit = {
						NOT = { is_society_grandmaster = yes }
					}
					increase_visibility_effect = yes
				}
				set_character_flag = preparing_grounds_in_@event_target:target_province
				character_event = { id = MNM.3849 days = 1200 }
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
}

#########################################################################################################
################ Secret society normal decisions
#########################################################################################################
decisions = {
	secret_religions_found_secret_religious_society = {
		only_playable = yes
		
		is_high_prio = yes
	
		potential = {
			has_secret_religion = yes
			secret_religious_cult = { # Has no members
				NOT = {
					any_society_member = { always = yes }
				}
			}
			NOT = {
				has_game_rule = {
					name = secret_cults
					value = none
				}
			}
		}
		
		allow = {
			is_adult = yes
			prestige = 250
			NOT = { is_in_society = yes }
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
		}
		
		effect = { #remember to update this should this suddenly become relevant again
			#hidden_effect = { # To track the number of Founded Cults
			#	change_variable = { which = global_founded_cults value = 1 }
			#	if = {
			#		limit = {
			#			secret_religion = rastafarian
			#		}
			#		change_variable = { which = global_rastafarian_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = voodoo
			#		}
			#		change_variable = { which = global_voodoo_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = santeria
			#		}
			#		change_variable = { which = global_santeria_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = candomble
			#		}
			#		change_variable = { which = global_candomble_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = espiritista
			#		}
			#		change_variable = { which = global_espiritista_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = espiritista_reformed
			#		}
			#		change_variable = { which = global_espiritista_reformed_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = americanist
			#		}
			#		change_variable = { which = global_americanist_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = ghost_dance
			#		}
			#		change_variable = { which = global_ghost_dance_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = raven_tales
			#		}
			#		change_variable = { which = global_raven_tales_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = catholic
			#		}
			#		change_variable = { which = global_catholic_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = neognostic
			#		}
			#		change_variable = { which = global_neognostic_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = sedevacantist
			#		}
			#		change_variable = { which = global_sedevacantist_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = ursuline
			#		}
			#		change_variable = { which = global_ursuline_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = angeline
			#		}
			#		change_variable = { which = global_angeline_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = confederated
			#		}
			#		change_variable = { which = global_confederated_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = jewish
			#		}
			#		change_variable = { which = global_jewish_founded_cults value = 1 }
			#	}
			#	if = {
			#		limit = {
			#			secret_religion = reform
			#		}
			#		change_variable = { which = global_reform_founded_cults value = 1 }
			#	}
			#}
			character_event = { id = MNM.3950 }
			prestige = -250
			join_society = secret_religious_cult
			set_society_grandmaster = yes # Set character as Grand Master
			add_society_currency_massive_effect = yes # Give the Grand Master a start-up capital to induct members
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0.1
			
			modifier = {
				factor = 0.03 # Slow down
			}
			modifier = {
				factor = 2
				OR = {
					top_liege = { # If the characters top liege is a player
						ai = no
					}
					top_liege = {
						any_realm_lord = { # If there is a player vassal in the same realm that is not secretly religious
							ai = no
							independent = no
							has_secret_religion_trait_trigger = no
						}
					}
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = zealous
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = content
					trait = trusting
					trait = shy
				}
			}
			modifier = { # Do not create more than one society per realm
				factor = 0
				any_realm_lord = {
					society_member_of = secret_religious_cult
				}
			}
			modifier = {
				factor = 0
				any_player = {
					shares_prevs_secret_religion_trigger = yes
				}
			}
		}
	}
	
	secret_religions_falsely_confess_faith = {
	
		is_high_prio = yes
	
		only_playable = yes
		
		potential = {
			OR = {
				liege = {
					NOT = {
						religion = ROOT
					}
				}
				top_liege = {
					NOT = {
						religion = ROOT
					}
				}
			}
			NOT = { controls_religion = yes }
		}
		allow = {
			piety = 100
			prisoner = no
			NOT = { trait = incapable }
			NOT = { is_inaccessible_trigger = yes }
		}
		effect = {
			character_event = { id = MNM.3951 days = 1 }
			if = {
				limit = { has_secret_religion = yes }
				secret_religion_scope = { save_event_target_as = actual_religion }
				piety = -50
				custom_tooltip = { text = confess_faith_already_has_secret_rel_tt }
			}
			else = {
				religion_scope = { save_event_target_as = actual_religion }
				piety = -100
				tooltip = {
					set_secret_religion = event_target:actual_religion # This has to actually happen after the religion is set
				}
			}
			custom_tooltip = {
				text = confess_faith_decision_tooltip
				hidden_effect = {
					if = {
						limit = {
							liege = {
								NOT = {
									religion = ROOT
								}
							}
						}
						liege = {
							religion_scope = { save_event_target_as = false_religion }
						}
					}
					else_if = {
						limit = {
							top_liege = {
								NOT = {
									religion = ROOT
								}
							}
						}
						top_liege = {
							religion_scope = { save_event_target_as = false_religion }
						}
					}
					ROOT = {
						religion = event_target:false_religion
						set_secret_religion = event_target:actual_religion
					}
				}
			}
			custom_tooltip = {
				text = confess_faith_courtiers_decision_tooltip
				hidden_effect = {
					any_courtier = {
						limit = {
							religion = event_target:actual_religion
							employer = { character = ROOT }
							NOT = { trait = zealous }
							NOT = { has_secret_religion = yes }
						}
						random = {
							chance = 50
							modifier = {
								factor = 1.5
								is_close_relative = yes
							}
							modifier = {
								factor = 1.2
								trait = cynical
							}
							religion = event_target:false_religion
							set_secret_religion = event_target:actual_religion
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
}

title_decisions = {
	secretly_convert_to_province_religion = {
		filter = owned
		ai_target_filter = self
		
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = { location = { religion = FROM } }
			NOT = { location = { religion = { target_type = secret target = FROM } } }
			owner = { character = FROM }
		}
		
		allow = {
			FROM = { 
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			location = { save_event_target_as = location }
			FROM = {
				set_secret_religion = event_target:location
				piety = -250
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_rastafarian_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = rastafarian }
			NOT = { religion = rastafarian }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = rastafarian }
			}
			OR = {
				is_holy_site = rastafarian
				any_de_jure_vassal_title = {
					is_holy_site = rastafarian
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = rastafarian
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_voodoo_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = voodoo }
			NOT = { religion = voodoo }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = voodoo }
			}
			OR = {
				is_holy_site = voodoo
				any_de_jure_vassal_title = {
					is_holy_site = voodoo
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = voodoo
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_santeria_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = santeria }
			NOT = { religion = santeria }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = santeria }
			}
			OR = {
				is_holy_site = santeria
				any_de_jure_vassal_title = {
					is_holy_site = santeria
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = santeria
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_candomble_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = candomble }
			NOT = { religion = candomble }
			NOT = { controls_religion = yes }
			has_global_flag = brazil_arrival
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = candomble }
			}
			OR = {
				is_holy_site = candomble
				any_de_jure_vassal_title = {
					is_holy_site = candomble
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = candomble
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_espiritista_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = espiritista }
			NOT = { religion = espiritista }
			NOT = { controls_religion = yes }
			NOT = { has_global_flag = espiritista_reformation }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = espiritista }
			}
			OR = {
				is_holy_site = espiritista
				any_de_jure_vassal_title = {
					is_holy_site = espiritista
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = espiritista
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_espiritista_reformed_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = espiritista_reformed }
			NOT = { religion = espiritista_reformed }
			NOT = { controls_religion = yes }
			has_global_flag = espiritista_reformation
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = espiritista_reformed }
			}
			OR = {
				is_holy_site = espiritista_reformed
				any_de_jure_vassal_title = {
					is_holy_site = espiritista_reformed
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = espiritista_reformed
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_ghost_dance_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = ghost_dance }
			NOT = { religion = ghost_dance }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = ghost_dance }
			}
			OR = {
				is_holy_site = ghost_dance
				any_de_jure_vassal_title = {
					is_holy_site = ghost_dance
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = ghost_dance
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_raven_tales_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = raven_tales }
			NOT = { religion = raven_tales }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = raven_tales }
			}
			OR = {
				is_holy_site = raven_tales
				any_de_jure_vassal_title = {
					is_holy_site = raven_tales
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = raven_tales
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_catholic_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = catholic }
			NOT = { religion = catholic }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = catholic }
			}
			OR = {
				is_holy_site = catholic
				any_de_jure_vassal_title = {
					is_holy_site = catholic
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = catholic
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_ursuline_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = ursuline }
			NOT = { religion = ursuline }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = ursuline }
			}
			OR = {
				is_holy_site = ursuline
				any_de_jure_vassal_title = {
					is_holy_site = ursuline
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = ursuline
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_confederated_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = confederated }
			NOT = { religion = confederated }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = confederated }
			}
			OR = {
				is_holy_site = confederated
				any_de_jure_vassal_title = {
					is_holy_site = confederated
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = canadian_church_unified
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = confederated
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_anabaptist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = anabaptist }
			NOT = { religion = anabaptist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = anabaptist }
			}
			OR = {
				is_holy_site = anabaptist
				any_de_jure_vassal_title = {
					is_holy_site = anabaptist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = anabaptist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_evangelical_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = evangelical }
			NOT = { religion = evangelical }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = evangelical }
			}
			OR = {
				is_holy_site = evangelical
				any_de_jure_vassal_title = {
					is_holy_site = evangelical
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = evangelical
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_falling_star_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = falling_star }
			NOT = { religion = falling_star }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = falling_star }
			}
			OR = {
				is_holy_site = falling_star
				any_de_jure_vassal_title = {
					is_holy_site = falling_star
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = falling_star
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_high_church_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = high_church }
			NOT = { religion = high_church }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = high_church }
			}
			OR = {
				is_holy_site = high_church
				any_de_jure_vassal_title = {
					is_holy_site = high_church
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = high_church
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_sacred_heart_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = sacred_heart }
			NOT = { religion = sacred_heart }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = sacred_heart }
			}
			OR = {
				is_holy_site = sacred_heart
				any_de_jure_vassal_title = {
					is_holy_site = sacred_heart
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = sacred_heart
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_gracia_divina_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = gracia_divina }
			NOT = { religion = gracia_divina }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = gracia_divina }
			}
			OR = {
				is_holy_site = gracia_divina
				any_de_jure_vassal_title = {
					is_holy_site = gracia_divina
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = gracia_divina
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_cetic_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = cetic }
			NOT = { religion = cetic }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = cetic }
			}
			OR = {
				is_holy_site = cetic
				any_de_jure_vassal_title = {
					is_holy_site = cetic
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = cetic
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_gaian_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = gaian }
			NOT = { religion = gaian }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = gaian }
			}
			OR = {
				is_holy_site = gaian
				any_de_jure_vassal_title = {
					is_holy_site = gaian
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = gaian
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_shinto_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = shinto }
			NOT = { religion = shinto }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = shinto }
			}
			OR = {
				is_holy_site = shinto
				any_de_jure_vassal_title = {
					is_holy_site = shinto
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = colonists_victorious
			NOT = { has_global_flag = edokko_defeated }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = shinto
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_nousthreskeia_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = nousthreskeia }
			NOT = { religion = nousthreskeia }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = nousthreskeia }
			}
			OR = {
				is_holy_site = nousthreskeia
				any_de_jure_vassal_title = {
					is_holy_site = nousthreskeia
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = colonists_victorious
			NOT = { has_global_flag = novorusskiy_defeated }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = nousthreskeia
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_mormon_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = mormon }
			NOT = { religion = mormon }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = mormon }
			}
			OR = {
				is_holy_site = mormon
				any_de_jure_vassal_title = {
					is_holy_site = mormon
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = mormon
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_sol_invicta_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = sol_invicta }
			NOT = { religion = sol_invicta }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = sol_invicta }
			}
			OR = {
				is_holy_site = sol_invicta
				any_de_jure_vassal_title = {
					is_holy_site = sol_invicta
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = sol_invicta
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_mictlantec_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = mictlantec }
			NOT = { religion = mictlantec }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = mictlantec }
			}
			OR = {
				is_holy_site = mictlantec
				any_de_jure_vassal_title = {
					is_holy_site = mictlantec
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = mictlantec
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_uahomche_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = uahomche }
			NOT = { religion = uahomche }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = uahomche }
			}
			OR = {
				is_holy_site = uahomche
				any_de_jure_vassal_title = {
					is_holy_site = uahomche
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = uahomche
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_neomayan_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = neomayan }
			NOT = { religion = neomayan }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = neomayan }
			}
			OR = {
				is_holy_site = neomayan
				any_de_jure_vassal_title = {
					is_holy_site = neomayan
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = neomayan
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_americanist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = americanist }
			NOT = { religion = americanist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = americanist }
			}
			OR = {
				is_holy_site = americanist
				any_de_jure_vassal_title = {
					is_holy_site = americanist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = americanist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_consumerist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = consumerist }
			NOT = { religion = consumerist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = consumerist }
			}
			OR = {
				is_holy_site = consumerist
				any_de_jure_vassal_title = {
					is_holy_site = consumerist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = consumerist_revolt_successful
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = consumerist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_atomicist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = atomicist }
			NOT = { religion = atomicist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = atomicist }
			}
			OR = {
				is_holy_site = atomicist
				any_de_jure_vassal_title = {
					is_holy_site = atomicist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = atomicist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_pagan_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = pagan }
			NOT = { religion = pagan }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			always = no
			tier = COUNT
			NOT = {
				location = { religion = pagan }
			}
			OR = {
				is_holy_site = pagan
				any_de_jure_vassal_title = {
					is_holy_site = pagan
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			always = no
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = pagan
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_revelationist_reformed_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = revelationist_reformed }
			NOT = { religion = revelationist_reformed }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = revelationist_reformed }
			}
			OR = {
				is_holy_site = revelationist_reformed
				any_de_jure_vassal_title = {
					is_holy_site = revelationist_reformed
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = revelationist_reformation
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = revelationist_reformed
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_revelationist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = revelationist }
			NOT = { religion = revelationist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = revelationist }
			}
			OR = {
				is_holy_site = revelationist
				any_de_jure_vassal_title = {
					is_holy_site = revelationist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			NOT = { has_global_flag = revelationist_reformation }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = revelationist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_rust_cultist_reformed_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = rust_cultist_reformed }
			NOT = { religion = rust_cultist_reformed }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = rust_cultist_reformed }
			}
			OR = {
				is_holy_site = rust_cultist_reformed
				any_de_jure_vassal_title = {
					is_holy_site = rust_cultist_reformed
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = rust_cultist_reformation
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = rust_cultist_reformed
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_rust_cultist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = rust_cultist }
			NOT = { religion = rust_cultist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = rust_cultist }
			}
			OR = {
				is_holy_site = rust_cultist
				any_de_jure_vassal_title = {
					is_holy_site = rust_cultist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			NOT = { has_global_flag = rust_cultist_reformation }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = rust_cultist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_occultist_reformed_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = occultist_reformed }
			NOT = { religion = occultist_reformed }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = occultist_reformed }
			}
			OR = {
				is_holy_site = occultist_reformed
				any_de_jure_vassal_title = {
					is_holy_site = occultist_reformed
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = occultist_reformation
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = occultist_reformed
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_occultist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = occultist }
			NOT = { religion = occultist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = occultist }
			}
			OR = {
				is_holy_site = occultist
				any_de_jure_vassal_title = {
					is_holy_site = occultist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			NOT = { has_global_flag = occultist_reformation }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = occultist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_thelemic_reformed_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = thelemic_reformed }
			NOT = { religion = thelemic_reformed }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = thelemic_reformed }
			}
			OR = {
				is_holy_site = thelemic_reformed
				any_de_jure_vassal_title = {
					is_holy_site = thelemic_reformed
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = redcoat_arrival
			has_global_flag = thelemic_reformation
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = thelemic_reformed
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_thelemic_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = thelemic }
			NOT = { religion = thelemic }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = thelemic }
			}
			OR = {
				is_holy_site = thelemic
				any_de_jure_vassal_title = {
					is_holy_site = thelemic
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = redcoat_arrival
			NOT = { has_global_flag = thelemic_reformation }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = thelemic
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_norse_pagan_reformed_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = norse_pagan_reformed }
			NOT = { religion = norse_pagan_reformed }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = norse_pagan_reformed }
			}
			OR = {
				is_holy_site = norse_pagan_reformed
				any_de_jure_vassal_title = {
					is_holy_site = norse_pagan_reformed
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			has_global_flag = norse_reformation
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = norse_pagan_reformed
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_norse_pagan_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = norse_pagan }
			NOT = { religion = norse_pagan }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = norse_pagan }
			}
			OR = {
				is_holy_site = norse_pagan
				any_de_jure_vassal_title = {
					is_holy_site = norse_pagan
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
			NOT = { has_global_flag = norse_reformation }
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = norse_pagan
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_celticist_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = celticist }
			NOT = { religion = celticist }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			always = no
			tier = COUNT
			NOT = {
				location = { religion = celticist }
			}
			OR = {
				is_holy_site = celticist
				any_de_jure_vassal_title = {
					is_holy_site = celticist
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			always = no
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = celticist
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_brethren_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = brethren }
			NOT = { religion = brethren }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = brethren }
			}
			OR = {
				is_holy_site = brethren
				any_de_jure_vassal_title = {
					is_holy_site = brethren
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = brethren
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_jewish_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = jewish }
			NOT = { religion = jewish }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = jewish }
			}
			OR = {
				is_holy_site = jewish
				any_de_jure_vassal_title = {
					is_holy_site = jewish
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = jewish
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	secretly_convert_to_hindu_holy_site = {
		filter = owned
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { secret_religion = hindu }
			NOT = { religion = hindu }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			tier = COUNT
			NOT = {
				location = { religion = hindu }
			}
			OR = {
				is_holy_site = hindu
				any_de_jure_vassal_title = {
					is_holy_site = hindu
				}
			}
			OR = {
				holder_scope = {
					character = FROM
				}
				AND = {
					tier = BARON
					holder_scope = {
						liege = {
							character = FROM
						}
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = {
				piety = -250
				set_secret_religion = hindu
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
}

targeted_decisions = {
	secretly_convert_to_close_relations_religion = {
		#filter
		ai_target_filter = self
	
		only_playable = yes
		
		from_potential = {
			ai = no
			NOT = { trait = incapable }
			NOT = { controls_religion = yes }
		}
		
		potential = {
			OR = {
				AND = {
					spouse = {
						character = FROM
					}
					NOR = { 
						religion = FROM
						religion = { target_type = secret target = FROM }
					}
				}
				AND = {
					consort = {
						character = FROM
					}
					NOR = { 
						religion = FROM
						religion = { target_type = secret target = FROM }
					}
				}
				AND = {
					is_friend = FROM
					NOR = { 
						religion = FROM
						religion = { target_type = secret target = FROM }
					}
				}
			}
		}
		
		allow = {
			FROM = {
				piety = 250
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { society_member_of = secret_religious_cult }
			}
		}
		
		effect = {
			FROM = { set_secret_religion = { target_type = public target = PREV } }
			FROM = { piety = -250 }
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
}